#
# $Id: Makefile~,v 1.2 2002/10/15 10:08:52 kienhuis Exp $
#

ROOT  = ../..

EHRHART =  \
	8hedron.in \
	alex11.in \
	alex1.in \
	c3.in\
	c4.in\
	e0.in\
	e10.in\
	e11.in\
	e12.in\
	e13.in\
	e14.in\
	e15.in\
	e16.in\
	e1.in\
	e2b.in\
	e2.in\
	e3.in\
	e4.in\
	e5.in\
	e6.in\
	e7.in\
	e8.in\
	e9.in\
	g12.in\
	g13.in\
	g14.in\
	g1.in\
	g2.in\
	g4.in\
	g5.in\
	isnm2.in\
	t1.in\
	t2.in\
	t31.in\
	t3.in\
	t4.in\
	tpar.in

TEST=$(EHRHART:%.in=%.tested) 

TESTLONG=$(EHRHART:%.in=%.tested) 

test:
	@failedtest=0; \
	for x in $(EHRHART) ; do \
		echo "Verify file $$x" ; \
		$(ROOT)/bin/testehrhart.exec < $$x > xyz;\
		diff -w xyz `basename $$x .in`.out ; \
		result=$$?; \
		if [ "$$result" -eq "1" ]; then \
			echo "Error: $$x is not the same"; \
			failedtest=`expr $$failedtest + 1`; \
		else \
			echo "$$x passed"; \
	        fi; \
	done ; \
        if [ $$failedtest != 0 ]; then \
		echo "$$failedtest tests failed"; \
	else \
	        echo "Test ehrhart works correctly"; \
        fi

longtest:
	@for x in $(EHRHART) ; do \
		echo "Verify Ehrhart for $$x"; \
		$(ROOT)/bin/verif_ehrhart.exec < $$x ;\
	done ; \

# The default compile rule
.in.tested:
	$(ROOT)/bin/ehrhart.exec < $< > xyz
	diff -w xyz $*.out

# Include the shared compilation rules
include $(ROOT)/vars.mk
include $(ROOT)/default_functions.mk
