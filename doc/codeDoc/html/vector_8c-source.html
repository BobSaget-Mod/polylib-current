<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>vector.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>vector.c</h1><a href="vector_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/* vector.c</font>
00002 <font class="comment">          COPYRIGHT</font>
00003 <font class="comment">          Both this software and its documentation are</font>
00004 <font class="comment"></font>
00005 <font class="comment">              Copyrighted 1993 by IRISA /Universite de Rennes I - France,</font>
00006 <font class="comment">              Copyright 1995,1996 by BYU, Provo, Utah</font>
00007 <font class="comment">                         all rights reserved.</font>
00008 <font class="comment"></font>
00009 <font class="comment">          Permission is granted to copy, use, and distribute</font>
00010 <font class="comment">          for any commercial or noncommercial purpose under the terms</font>
00011 <font class="comment">          of the GNU General Public license, version 2, June 1991</font>
00012 <font class="comment">          (see file : LICENSING).</font>
00013 <font class="comment">*/</font>
00014 
00015 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00016 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00017 <font class="preprocessor">#include &lt;polylib/polylib.h&gt;</font>
00018 
00019 <font class="preprocessor">#ifdef MAC_OS</font>
00020 <font class="preprocessor"></font><font class="preprocessor">  #define abs __abs</font>
00021 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00022 <font class="preprocessor"></font>
00023 <font class="comment">/* </font>
00024 <font class="comment"> * Compute n! </font>
00025 <font class="comment"> */</font>
<a name="l00026"></a><a class="code" href="vector_8c.html#a0">00026</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a0">Factorial</a>(<font class="keywordtype">int</font> n, <a class="code" href="arithmetique_8h.html#a93">Value</a> *fact) {
00027   
00028   <font class="keywordtype">int</font> i;
00029   <a class="code" href="arithmetique_8h.html#a93">Value</a> tmp;
00030   
00031   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
00032   
00033   <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(*fact,1);
00034   <font class="keywordflow">for</font> (i=1;i&lt;=n;i++) {
00035     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(tmp,i);
00036     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(*fact,*fact,tmp);
00037   }
00038   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00039 } <font class="comment">/* Factorial */</font>
00040 
00041 <font class="comment">/* </font>
00042 <font class="comment"> * Compute n!/(p!(n-p)!) </font>
00043 <font class="comment"> */</font>
<a name="l00044"></a><a class="code" href="vector_8c.html#a1">00044</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a1">Binomial</a>(<font class="keywordtype">int</font> n, <font class="keywordtype">int</font> p, <a class="code" href="arithmetique_8h.html#a93">Value</a> *result) {
00045   
00046   <font class="keywordtype">int</font> i;
00047   <a class="code" href="arithmetique_8h.html#a93">Value</a> tmp;
00048   <a class="code" href="arithmetique_8h.html#a93">Value</a> f;
00049   
00050   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);<a class="code" href="arithmetique_8h.html#a10">value_init</a>(f);
00051   
00052   <font class="keywordflow">if</font> (n-p&lt;p)
00053     p=n-p;
00054   <font class="keywordflow">if</font> (p!=0) {
00055     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(*result,(n-p+1));
00056     <font class="keywordflow">for</font> (i=n-p+2;i&lt;=n;i++) {
00057       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(tmp,i);    
00058       <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(*result,*result,tmp);
00059     }
00060     <a class="code" href="vector_8c.html#a0">Factorial</a>(p,&amp;f);
00061     <a class="code" href="arithmetique_8h.html#a51">value_division</a>(*result,*result,f);
00062   }
00063   <font class="keywordflow">else</font> 
00064     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(*result,1);
00065   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(f);<a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00066 } <font class="comment">/* Binomial */</font>
00067   
00068 <font class="comment">/*</font>
00069 <font class="comment"> * Return the number of ways to choose 'b' items from 'a' items, that is, </font>
00070 <font class="comment"> * return a!/(b!(a-b)!)</font>
00071 <font class="comment"> */</font>
<a name="l00072"></a><a class="code" href="vector_8c.html#a2">00072</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a2">CNP</a>(<font class="keywordtype">int</font> a,<font class="keywordtype">int</font> b, <a class="code" href="arithmetique_8h.html#a93">Value</a> *result) {
00073   
00074   <font class="keywordtype">int</font> i;
00075   <a class="code" href="arithmetique_8h.html#a93">Value</a> tmp;
00076   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
00077 
00078   <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(*result,1);
00079   
00080   <font class="comment">/* If number of items is less than the number to be choosen, return 1 */</font>
00081   <font class="keywordflow">if</font>(a &lt;= b) {
00082     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00083     <font class="keywordflow">return</font>;
00084   }  
00085   <font class="keywordflow">for</font>(i=a;i&gt;b;--i) {
00086     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(tmp,i);
00087     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(*result,*result,tmp);
00088   }  
00089   <font class="keywordflow">for</font>(i=1;i&lt;=(a-b);++i) {
00090     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(tmp,i);
00091     <a class="code" href="arithmetique_8h.html#a51">value_division</a>(*result,*result,tmp);
00092   }
00093   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00094 } <font class="comment">/* CNP */</font>
00095 
00096 <font class="comment">/* </font>
00097 <font class="comment"> * Compute GCD of 'a' and 'b' </font>
00098 <font class="comment"> */</font>
<a name="l00099"></a><a class="code" href="vector_8c.html#a3">00099</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a3">Gcd</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> a,<a class="code" href="arithmetique_8h.html#a93">Value</a> b,<a class="code" href="arithmetique_8h.html#a93">Value</a> *result) {
00100 
00101   <a class="code" href="arithmetique_8h.html#a93">Value</a> acopy, bcopy;
00102 
00103   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(acopy);
00104   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(bcopy);
00105   <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(acopy,a);
00106   <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(bcopy,b);
00107   <font class="keywordflow">while</font>(<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(acopy)) { 
00108     <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(*result,bcopy,acopy);      
00109     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(bcopy,acopy);                     
00110     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(acopy,*result);                   
00111   }
00112   <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(*result,bcopy);
00113   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(acopy);
00114   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(bcopy);
00115 } <font class="comment">/* Gcd */</font>
00116 
00117 <font class="comment">/* </font>
00118 <font class="comment"> * Return the smallest component index in 'p' whose value is non-zero </font>
00119 <font class="comment"> */</font>
<a name="l00120"></a><a class="code" href="vector_8c.html#a4">00120</a> <font class="keywordtype">int</font> <a class="code" href="vector_8c.html#a4">First_Non_Zero</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p,<font class="keywordtype">unsigned</font> length) {
00121   
00122   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp;
00123   <font class="keywordtype">int</font> i;
00124   
00125   cp = p;
00126   <font class="keywordflow">for</font> (i=0;i&lt;length;i++) {
00127     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(*cp))
00128       <font class="keywordflow">break</font>;
00129     cp++;
00130   }
00131   <font class="keywordflow">return</font>((i==length) ? -1 : i );
00132 } <font class="comment">/* First_Non_Zero */</font>
00133 
00134 <font class="comment">/* </font>
00135 <font class="comment"> * Allocate memory space for Vector </font>
00136 <font class="comment"> */</font>
<a name="l00137"></a><a class="code" href="vector_8c.html#a5">00137</a> Vector *<a class="code" href="vector_8c.html#a5">Vector_Alloc</a>(<font class="keywordtype">unsigned</font> length) {
00138 
00139   <font class="keywordtype">int</font> i;
00140   Vector *vector;
00141   
00142   vector = (Vector *)malloc(<font class="keyword">sizeof</font>(Vector));
00143   <font class="keywordflow">if</font> (!vector) {
00144     <a class="code" href="errormsg_8c.html#a1">errormsg1</a>(<font class="stringliteral">"Vector_Alloc"</font>, <font class="stringliteral">"outofmem"</font>, <font class="stringliteral">"out of memory space"</font>);
00145     <font class="keywordflow">return</font> 0;
00146   }
00147   vector-&gt;Size=length;
00148   vector-&gt;p=(<a class="code" href="arithmetique_8h.html#a93">Value</a> *)malloc(length * <font class="keyword">sizeof</font>(<a class="code" href="arithmetique_8h.html#a93">Value</a>));
00149   <font class="keywordflow">if</font> (!vector-&gt;p) {
00150     <a class="code" href="errormsg_8c.html#a1">errormsg1</a>(<font class="stringliteral">"Vector_Alloc"</font>, <font class="stringliteral">"outofmem"</font>, <font class="stringliteral">"out of memory space"</font>);
00151     free(vector);
00152     <font class="keywordflow">return</font> 0;
00153   }
00154   <font class="keywordflow">for</font>(i=0;i&lt;length;i++)
00155     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(vector-&gt;p[i]);
00156   <font class="keywordflow">return</font> vector;
00157 } <font class="comment">/* Vector_Alloc */</font>
00158 
00159 <font class="comment">/* </font>
00160 <font class="comment"> * Free the memory space occupied by Vector </font>
00161 <font class="comment"> */</font>
<a name="l00162"></a><a class="code" href="vector_8c.html#a6">00162</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a6">Vector_Free</a>(Vector *vector) {
00163   
00164   <font class="keywordtype">int</font> i;
00165 
00166   <font class="keywordflow">if</font> (!vector) <font class="keywordflow">return</font>;
00167   <font class="keywordflow">for</font>(i=0;i&lt;vector-&gt;Size;i++) 
00168     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(vector-&gt;p[i]);
00169   free(vector-&gt;p);
00170   free(vector);
00171 } <font class="comment">/* Vector_Free */</font>
00172 
00173 <font class="comment">/* </font>
00174 <font class="comment"> * Print the contents of a Vector </font>
00175 <font class="comment"> */</font>
<a name="l00176"></a><a class="code" href="vector_8c.html#a7">00176</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a7">Vector_Print</a>(FILE *Dst,<font class="keywordtype">char</font> *Format,Vector *vector) {
00177   
00178   <font class="keywordtype">int</font> i;
00179   <a class="code" href="arithmetique_8h.html#a93">Value</a> *p;
00180   <font class="keywordtype">unsigned</font> length;
00181   
00182   fprintf(Dst, <font class="stringliteral">"%d\n"</font>, length=vector-&gt;Size);
00183   p = vector-&gt;p;
00184   <font class="keywordflow">for</font> (i=0;i&lt;length;i++) {
00185     <font class="keywordflow">if</font> (Format) {
00186       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(Dst,Format,*p++);
00187     }  
00188     <font class="keywordflow">else</font> {      
00189       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(Dst,P_VALUE_FMT,*p++);
00190     }  
00191   }
00192   fprintf(Dst, <font class="stringliteral">"\n"</font>);
00193 } <font class="comment">/* Vector_Print */</font>
00194 
00195 <font class="comment">/* </font>
00196 <font class="comment"> * Read the contents of a Vector </font>
00197 <font class="comment"> */</font>
<a name="l00198"></a><a class="code" href="vector_8c.html#a8">00198</a> Vector *<a class="code" href="vector_8c.html#a8">Vector_Read</a>() {
00199   
00200   Vector *vector;
00201   <font class="keywordtype">unsigned</font> length;
00202   <font class="keywordtype">int</font> i;
00203   <font class="keywordtype">char</font> str[1024];
00204   <a class="code" href="arithmetique_8h.html#a93">Value</a> *p;
00205   
00206   scanf(<font class="stringliteral">"%d"</font>, &amp;length);
00207   vector = <a class="code" href="vector_8c.html#a5">Vector_Alloc</a>(length);
00208   <font class="keywordflow">if</font> (!vector) {
00209     <a class="code" href="errormsg_8c.html#a1">errormsg1</a>(<font class="stringliteral">"Vector_Read"</font>, <font class="stringliteral">"outofmem"</font>, <font class="stringliteral">"out of memory space"</font>);
00210     <font class="keywordflow">return</font> 0;
00211   }
00212   p = vector-&gt;p;
00213   <font class="keywordflow">for</font> (i=0;i&lt;length;i++) {
00214     scanf(<font class="stringliteral">"%s"</font>,str);
00215     <a class="code" href="arithmetique_8h.html#a15">value_read</a>(*(p++),str);
00216   }  
00217   <font class="keywordflow">return</font> vector;
00218 } <font class="comment">/* Vector_Read */</font>
00219 
00220 <font class="comment">/* </font>
00221 <font class="comment"> * Assign 'n' to each component of Vector 'p' </font>
00222 <font class="comment"> */</font>
<a name="l00223"></a><a class="code" href="vector_8c.html#a9">00223</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a9">Vector_Set</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p,<font class="keywordtype">int</font> n,<font class="keywordtype">unsigned</font> length) {
00224   
00225   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp;
00226   <font class="keywordtype">int</font> i;
00227   
00228   cp = p; 
00229   <font class="keywordflow">for</font> (i=0;i&lt;length;i++) {
00230     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(*cp,n);
00231     cp++;
00232   }
00233   <font class="keywordflow">return</font>;
00234 } <font class="comment">/* Vector_Set */</font>
00235 
00236 <font class="comment">/*</font>
00237 <font class="comment"> * Exchange the components of the vectors 'p1' and 'p2' of length 'length'</font>
00238 <font class="comment"> */</font>
<a name="l00239"></a><a class="code" href="vector_8c.html#a10">00239</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a10">Vector_Exchange</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p1, <a class="code" href="arithmetique_8h.html#a93">Value</a> *p2, <font class="keywordtype">unsigned</font> length) {
00240 
00241   <font class="keywordtype">int</font> i;
00242   
00243   <font class="keywordflow">for</font>(i=0;i&lt;length;i++) {
00244     <a class="code" href="arithmetique_8h.html#a17">value_swap</a>(p1[i],p2[i]);
00245   }  
00246   <font class="keywordflow">return</font>;
00247 }
00248 
00249 <font class="comment">/*</font>
00250 <font class="comment"> * Copy Vector 'p1' to Vector 'p2' </font>
00251 <font class="comment"> */</font>
<a name="l00252"></a><a class="code" href="vector_8c.html#a11">00252</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a11">Vector_Copy</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p1,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p2,<font class="keywordtype">unsigned</font> length) {
00253 
00254   <font class="keywordtype">int</font> i;
00255   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp1, *cp2;
00256 
00257   cp1 = p1;
00258   cp2 = p2;
00259   
00260   <font class="keywordflow">for</font>(i=0;i&lt;length;i++) 
00261     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*cp2++,*cp1++);
00262   
00263   <font class="keywordflow">return</font>;
00264 }
00265   
00266 <font class="comment">/* </font>
00267 <font class="comment"> * Add two vectors 'p1' and 'p2' and store the result in 'p3' </font>
00268 <font class="comment"> */</font>
<a name="l00269"></a><a class="code" href="vector_8c.html#a12">00269</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a12">Vector_Add</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p1,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p2,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p3,<font class="keywordtype">unsigned</font> length) {
00270 
00271   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp1, *cp2, *cp3;
00272   <font class="keywordtype">int</font> i;
00273   
00274   cp1=p1;
00275   cp2=p2;
00276   cp3=p3;
00277   <font class="keywordflow">for</font> (i=0;i&lt;length;i++) {
00278     
00279     <font class="comment">/* *cp3++ = *cp1++ + *cp2++ */</font>
00280     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(*cp3,*cp1,*cp2);
00281     cp1++; cp2++; cp3++;
00282   }
00283 } <font class="comment">/* Vector_Add */</font>
00284 
00285 <font class="comment">/* </font>
00286 <font class="comment"> * Subtract two vectors 'p1' and 'p2' and store the result in 'p3' </font>
00287 <font class="comment"> */</font>
<a name="l00288"></a><a class="code" href="vector_8c.html#a13">00288</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a13">Vector_Sub</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p1,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p2,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p3,<font class="keywordtype">unsigned</font> length) {
00289 
00290   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp1, *cp2, *cp3;       
00291   <font class="keywordtype">int</font> i;
00292   
00293   cp1=p1;
00294   cp2=p2;
00295   cp3=p3;
00296   <font class="keywordflow">for</font> (i=0;i&lt;length;i++) {
00297     
00298     <font class="comment">/* *cp3++= *cp1++ - *cp2++ */</font>
00299     <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(*cp3,*cp1,*cp2);
00300     cp1++; cp2++; cp3++;
00301   }
00302 } <font class="comment">/* Vector_Sub */</font>
00303 
00304 <font class="comment">/* </font>
00305 <font class="comment"> * Compute Bitwise OR of Vectors 'p1' and 'p2' and store in 'p3' </font>
00306 <font class="comment"> */</font>
<a name="l00307"></a><a class="code" href="vector_8c.html#a14">00307</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a14">Vector_Or</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p1,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p2,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p3,<font class="keywordtype">unsigned</font> length) {
00308 
00309   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp1, *cp2, *cp3;
00310   <font class="keywordtype">int</font> i;
00311   
00312   cp1=p1;
00313   cp2=p2;
00314   cp3=p3;
00315   <font class="keywordflow">for</font> (i=0;i&lt;length;i++) {
00316     
00317     <font class="comment">/* *cp3++=*cp1++ | *cp2++ */</font>
00318     <a class="code" href="arithmetique_8h.html#a58">value_orto</a>(*cp3,*cp1,*cp2);
00319     cp1++; cp2++; cp3++;
00320   }
00321 } <font class="comment">/* Vector_Or */</font>
00322 
00323 <font class="comment">/* </font>
00324 <font class="comment"> * Scale Vector 'p1' lambda times and store in 'p2' </font>
00325 <font class="comment"> */</font>
<a name="l00326"></a><a class="code" href="vector_8c.html#a15">00326</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a15">Vector_Scale</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p1,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p2,<a class="code" href="arithmetique_8h.html#a93">Value</a> lambda,<font class="keywordtype">unsigned</font> length) {
00327   
00328   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp1, *cp2;
00329   <font class="keywordtype">int</font> i;
00330   
00331   cp1=p1;
00332   cp2=p2;
00333   <font class="keywordflow">for</font> (i=0;i&lt;length;i++) {
00334     
00335     <font class="comment">/* *cp2++=*cp1++ * lambda */</font>
00336     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(*cp2,*cp1,lambda);
00337     cp1++; cp2++;
00338   }
00339 } <font class="comment">/* Vector_Scale */</font>
00340 
00341 <font class="comment">/* </font>
00342 <font class="comment"> * Antiscale Vector 'p1' by lambda and store in 'p2' </font>
00343 <font class="comment"> */</font>
<a name="l00344"></a><a class="code" href="vector_8c.html#a16">00344</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a16">Vector_AntiScale</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p1,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p2,<a class="code" href="arithmetique_8h.html#a93">Value</a> lambda,<font class="keywordtype">unsigned</font> length) {
00345   
00346   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp1, *cp2;
00347   <font class="keywordtype">int</font> i;
00348   
00349   cp1=p1;
00350   cp2=p2;
00351   <font class="keywordflow">for</font> (i=0;i&lt;length;i++) {
00352     
00353     <font class="comment">/* *cp2++=*cp1++ / lambda; */</font>
00354     <a class="code" href="arithmetique_8h.html#a51">value_division</a>(*cp2,*cp1,lambda);
00355     cp1++; cp2++;
00356   }
00357 } <font class="comment">/* Vector_AntiScale */</font>
00358 
00359 <font class="comment">/* </font>
00360 <font class="comment"> * Return the inner product of the two Vectors 'p1' and 'p2' </font>
00361 <font class="comment"> */</font>
<a name="l00362"></a><a class="code" href="vector_8c.html#a17">00362</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a17">Inner_Product</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p1,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p2,<font class="keywordtype">unsigned</font> length,<a class="code" href="arithmetique_8h.html#a93">Value</a> *ip) {
00363   
00364   <a class="code" href="arithmetique_8h.html#a93">Value</a> tmp;
00365   <font class="keywordtype">int</font> i;
00366 
00367   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
00368 
00369   <font class="comment">//  if(length==0)</font>
00370   <font class="comment">//  return(VALUE_MAX);  </font>
00371   
00372   <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(*ip,*p1,*p2);
00373   p1++; p2++;
00374   <font class="keywordflow">for</font>(i=1;i&lt;length;i++) {
00375     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(tmp,*p1,*p2);
00376     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(*ip,*ip,tmp);
00377     p1++; p2++;
00378   }
00379   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00380 } <font class="comment">/* Inner_Product */</font>
00381 
00382 <font class="comment">/* </font>
00383 <font class="comment"> * Return the maximum of the components of 'p' </font>
00384 <font class="comment"> */</font>
<a name="l00385"></a><a class="code" href="vector_8c.html#a18">00385</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a18">Vector_Max</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p,<font class="keywordtype">unsigned</font> length, <a class="code" href="arithmetique_8h.html#a93">Value</a> *<a class="code" href="verif__ehrhart_8c.html#a7">max</a>) {
00386   
00387   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp;
00388   <font class="keywordtype">int</font> i;
00389 
00390   cp=p;
00391   <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*<a class="code" href="verif__ehrhart_8c.html#a7">max</a>,*cp);
00392   cp++;
00393   <font class="keywordflow">for</font> (i=1;i&lt;length;i++) {
00394     <a class="code" href="arithmetique_8h.html#a57">value_maximum</a>(*<a class="code" href="verif__ehrhart_8c.html#a7">max</a>,*<a class="code" href="verif__ehrhart_8c.html#a7">max</a>,*cp);
00395     cp++;
00396   }
00397 } <font class="comment">/* Vector_Max */</font>
00398 
00399 <font class="comment">/* </font>
00400 <font class="comment"> * Return the minimum of the components of Vector 'p' </font>
00401 <font class="comment"> */</font>
<a name="l00402"></a><a class="code" href="vector_8c.html#a19">00402</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a19">Vector_Min</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p,<font class="keywordtype">unsigned</font> length,<a class="code" href="arithmetique_8h.html#a93">Value</a> *<a class="code" href="verif__ehrhart_8c.html#a6">min</a>) {
00403   
00404   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp;
00405   <font class="keywordtype">int</font> i;
00406 
00407   <font class="comment">//  if(length==0)</font>
00408   <font class="comment">//  return(VALUE_MAX);</font>
00409   cp=p;
00410   <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*<a class="code" href="verif__ehrhart_8c.html#a6">min</a>,*cp);
00411   cp++;
00412   <font class="keywordflow">for</font> (i=1;i&lt;length;i++) {
00413     <a class="code" href="arithmetique_8h.html#a56">value_minimum</a>(*<a class="code" href="verif__ehrhart_8c.html#a6">min</a>,*<a class="code" href="verif__ehrhart_8c.html#a6">min</a>,*cp);
00414     cp++;
00415   }
00416   <font class="keywordflow">return</font>;
00417 } <font class="comment">/* Vector_Min */</font>
00418 
00419 <font class="comment">/* </font>
00420 <font class="comment"> * Given Vectors 'p1' and 'p2', return Vector 'p3' = lambda * p1 + mu * p2. </font>
00421 <font class="comment"> */</font>
<a name="l00422"></a><a class="code" href="vector_8c.html#a20">00422</a> <font class="keywordtype">void</font>  <a class="code" href="vector_8c.html#a20">Vector_Combine</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p1,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p2, <a class="code" href="arithmetique_8h.html#a93">Value</a> *p3,<a class="code" href="arithmetique_8h.html#a93">Value</a> lambda,<a class="code" href="arithmetique_8h.html#a93">Value</a>  mu,<font class="keywordtype">unsigned</font> length) {
00423   
00424   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp1, *cp2, *cp3;
00425   <a class="code" href="arithmetique_8h.html#a93">Value</a> tmp1, tmp2;
00426   <font class="keywordtype">int</font> i;
00427   
00428   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp1); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp2);
00429   cp1=p1;
00430   cp2=p2;
00431   cp3=p3;
00432   
00433   <font class="keywordflow">for</font> (i=0;i&lt;length;i++) {
00434     
00435     <font class="comment">/* tmp1 = lambda * *cp1 */</font>
00436     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(tmp1,lambda,*cp1);
00437     
00438     <font class="comment">/* tmp2 = mu * *cp2 */</font>
00439     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(tmp2,mu,*cp2);
00440     
00441     <font class="comment">/* *cp3 = tmp1 + tmp2 */</font>
00442     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(*cp3,tmp1,tmp2);
00443     cp1++; cp2++; cp3++;
00444   }
00445   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp1);
00446   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp2);
00447   <font class="keywordflow">return</font>;
00448 } <font class="comment">/* Vector_Combine */</font>
00449 
00450 <font class="comment">/* </font>
00451 <font class="comment"> * Return 1 if 'Vec1' equals 'Vec2', otherwise return 0 </font>
00452 <font class="comment"> */</font>
<a name="l00453"></a><a class="code" href="vector_8c.html#a21">00453</a> <font class="keywordtype">int</font> <a class="code" href="vector_8c.html#a21">Vector_Equal</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *Vec1,<a class="code" href="arithmetique_8h.html#a93">Value</a> *Vec2,<font class="keywordtype">unsigned</font> n) {
00454   
00455   <font class="keywordtype">int</font> i;
00456   <a class="code" href="arithmetique_8h.html#a93">Value</a> *p1, *p2;
00457   
00458   p1=Vec1;
00459   p2=Vec2;
00460   <font class="keywordflow">for</font>(i=0;i&lt;n;i++) {
00461   
00462     <font class="comment">/* if (*p1++!=*p2++) break; */</font>
00463     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a23">value_ne</a>(*p1,*p2))
00464       <font class="keywordflow">break</font>;
00465     p1++; p2++;
00466   }
00467   <font class="keywordflow">return</font> (i==n);
00468 } <font class="comment">/* Vector_Equal */</font>
00469 
00470 <font class="comment">/* </font>
00471 <font class="comment"> * Return the component of 'p' with minimum non-zero absolute value. 'index'</font>
00472 <font class="comment"> * points to the component index that has the minimum value. If no such value</font>
00473 <font class="comment"> * and index is found, Value 1 is returned.</font>
00474 <font class="comment"> */</font>
<a name="l00475"></a><a class="code" href="vector_8c.html#a22">00475</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a22">Vector_Min_Not_Zero</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p,<font class="keywordtype">unsigned</font> length,<font class="keywordtype">int</font> *index,<a class="code" href="arithmetique_8h.html#a93">Value</a> *<a class="code" href="verif__ehrhart_8c.html#a6">min</a>) {
00476   
00477   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp, aux;
00478   <font class="keywordtype">int</font> i,j;
00479   
00480   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(aux);
00481   
00482   cp=p;
00483   <font class="keywordflow">for</font>(i=0;i&lt;length;i++) {
00484     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(*cp)) {
00485       <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(*<a class="code" href="verif__ehrhart_8c.html#a6">min</a>,*cp);
00486       *index = i;
00487       <font class="keywordflow">break</font>;
00488     }
00489     ++cp;
00490   }
00491   <font class="keywordflow">if</font> (i == length) {
00492     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(*<a class="code" href="verif__ehrhart_8c.html#a6">min</a>,1);
00493     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(aux);
00494     cp = NULL;
00495     <font class="keywordflow">return</font>;
00496   }
00497   ++cp;
00498   <font class="keywordflow">for</font>(j=i+1;j&lt;length;j++) {
00499     <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(aux,*cp);
00500     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(aux,*<a class="code" href="verif__ehrhart_8c.html#a6">min</a>) &amp;&amp; <a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(aux)) {
00501       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*<a class="code" href="verif__ehrhart_8c.html#a6">min</a>,aux);
00502       *index = j;
00503     }  
00504     cp++;
00505   }
00506   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(aux);
00507   cp = NULL;
00508 } <font class="comment">/* Vector_Min_Not_Zero */</font>
00509 
00510 <font class="comment">/* </font>
00511 <font class="comment"> * Return the GCD of components of Vector 'p' </font>
00512 <font class="comment"> */</font>
<a name="l00513"></a><a class="code" href="vector_8c.html#a23">00513</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a23">Vector_Gcd</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p,<font class="keywordtype">unsigned</font> length,<a class="code" href="arithmetique_8h.html#a93">Value</a> *<a class="code" href="verif__ehrhart_8c.html#a6">min</a>) {
00514   
00515   <a class="code" href="arithmetique_8h.html#a93">Value</a> *q,*cq, *cp;
00516   <font class="keywordtype">int</font> i, Not_Zero, Index_Min=0;
00517   
00518   q  = (<a class="code" href="arithmetique_8h.html#a93">Value</a> *)malloc(length*<font class="keyword">sizeof</font>(<a class="code" href="arithmetique_8h.html#a93">Value</a>));
00519 
00520   <font class="comment">/* Initialize all the 'Value' variables */</font>
00521   <font class="keywordflow">for</font>(i=0;i&lt;length;i++)
00522     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(q[i]);
00523   
00524   <font class="comment">/* 'cp' points to vector 'p' and cq points to vector 'q' that holds the */</font>
00525   <font class="comment">/* absolute value of elements of vector 'p'.                            */</font>
00526   cp=p;
00527   <font class="keywordflow">for</font> (cq = q,i=0;i&lt;length;i++) {
00528     <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(*cq,*cp);    
00529     cq++;
00530     cp++;
00531   }
00532   <font class="keywordflow">do</font> {   
00533     <a class="code" href="vector_8c.html#a22">Vector_Min_Not_Zero</a>(q,length,&amp;Index_Min,<a class="code" href="verif__ehrhart_8c.html#a6">min</a>);
00534     
00535     <font class="comment">/* if (*min != 1) */</font>
00536     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(*<a class="code" href="verif__ehrhart_8c.html#a6">min</a>)) {
00537       
00538       cq=q;
00539       Not_Zero=0;
00540       <font class="keywordflow">for</font> (i=0;i&lt;length;i++,cq++)
00541         <font class="keywordflow">if</font> (i!=Index_Min) {
00542           
00543           <font class="comment">/* Not_Zero |= (*cq %= *min) */</font>
00544           <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(*cq,*cq,*<a class="code" href="verif__ehrhart_8c.html#a6">min</a>);
00545           Not_Zero |= <a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(*cq);
00546         }
00547     } 
00548     <font class="keywordflow">else</font> 
00549       <font class="keywordflow">break</font>;
00550   } <font class="keywordflow">while</font> (Not_Zero);
00551   
00552   <font class="comment">/* Clear all the 'Value' variables */</font>
00553   <font class="keywordflow">for</font>(i=0;i&lt;length;i++)
00554     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(q[i]);
00555   free(q);
00556 } <font class="comment">/* Vector_Gcd */</font>
00557 
00558 <font class="comment">/* </font>
00559 <font class="comment"> * Given vectors 'p1', 'p2', and a pointer to a function returning 'Value type,</font>
00560 <font class="comment"> * compute p3[i] = f(p1[i],p2[i]).  </font>
00561 <font class="comment"> */</font> 
<a name="l00562"></a><a class="code" href="vector_8c.html#a24">00562</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a24">Vector_Map</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p1,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p2,<a class="code" href="arithmetique_8h.html#a93">Value</a> *p3,<font class="keywordtype">unsigned</font> length,<a class="code" href="arithmetique_8h.html#a93">Value</a> *(*f)()) {
00563   
00564   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp1, *cp2, *cp3;
00565   <font class="keywordtype">int</font> i;
00566   
00567   cp1=p1;
00568   cp2=p2;
00569   cp3=p3;
00570   <font class="keywordflow">for</font>(i=0;i&lt;length;i++) {
00571     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*cp3,*(*f)(*cp1, *cp2));
00572     cp1++; cp2++; cp3++;
00573   }
00574   <font class="keywordflow">return</font>;
00575 } <font class="comment">/* Vector_Map */</font>
00576 
00577 <font class="comment">/* </font>
00578 <font class="comment"> * Reduce a vector by dividing it by GCD. There is no restriction on </font>
00579 <font class="comment"> * components of Vector 'p'. Making the last element positive is *not* OK</font>
00580 <font class="comment"> * for equalities. </font>
00581 <font class="comment"> */</font>
<a name="l00582"></a><a class="code" href="vector_8c.html#a25">00582</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a25">Vector_Normalize</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p,<font class="keywordtype">unsigned</font> length) {
00583   
00584   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp, gcd,tmp;
00585   <font class="keywordtype">int</font> i;
00586   
00587   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);<a class="code" href="arithmetique_8h.html#a10">value_init</a>(gcd);
00588 
00589   <a class="code" href="vector_8c.html#a23">Vector_Gcd</a>(p,length,&amp;gcd);
00590   <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(tmp,1);
00591   
00592   <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a24">value_gt</a>(gcd,tmp)) {
00593     cp = p;    
00594     <font class="keywordflow">for</font> (i=0; i&lt;length; i++) { 
00595       
00596       <font class="comment">/* *cp /= gcd */</font>
00597       <a class="code" href="arithmetique_8h.html#a51">value_division</a>(*cp,*cp,gcd);
00598       cp++;
00599     }
00600   }
00601   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00602   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(gcd);
00603   <font class="keywordflow">return</font>;
00604 } <font class="comment">/* Vector_Normalize */</font>
00605 
00606 <font class="comment">/* </font>
00607 <font class="comment"> * Reduce a vector by dividing it by GCD and making sure its pos-th </font>
00608 <font class="comment"> * element is positive.    </font>
00609 <font class="comment"> */</font>
<a name="l00610"></a><a class="code" href="vector_8c.html#a26">00610</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a26">Vector_Normalize_Positive</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p,<font class="keywordtype">int</font> length,<font class="keywordtype">int</font> pos) {
00611   
00612   <a class="code" href="arithmetique_8h.html#a93">Value</a> gcd;
00613   <font class="keywordtype">int</font> i;
00614   
00615   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(gcd);
00616   <a class="code" href="vector_8c.html#a23">Vector_Gcd</a>(p,length,&amp;gcd);
00617   <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(p[pos]))
00618     <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(gcd,gcd);
00619   <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(gcd))
00620     <font class="keywordflow">for</font>(i=0; i&lt;length; i++)
00621       <a class="code" href="arithmetique_8h.html#a51">value_division</a>(p[i],p[i],gcd);
00622   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(gcd);
00623 
00624   <font class="keywordflow">return</font>;
00625 } <font class="comment">/* Vector_Normalize_Positive */</font>
00626 
00627 <font class="comment">/* </font>
00628 <font class="comment"> * Reduce 'p' by operating binary function on its components successively </font>
00629 <font class="comment"> */</font>
<a name="l00630"></a><a class="code" href="vector_8c.html#a27">00630</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a27">Vector_Reduce</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *p,<font class="keywordtype">unsigned</font> length,<font class="keywordtype">void</font>(*f)(<a class="code" href="arithmetique_8h.html#a93">Value</a>,<a class="code" href="arithmetique_8h.html#a93">Value</a> *),<a class="code" href="arithmetique_8h.html#a93">Value</a> *r) {
00631   
00632   <a class="code" href="arithmetique_8h.html#a93">Value</a> *cp;
00633   <font class="keywordtype">int</font> i;
00634   
00635   cp = p;
00636   <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*r,*cp);
00637   <font class="keywordflow">for</font>(i=1;i&lt;length;i++) {
00638     cp++;
00639     (*f)(*cp,r);
00640   }
00641 } <font class="comment">/* Vector_Reduce */</font>
00642 
00643 <font class="comment">/* </font>
00644 <font class="comment"> * Sort the components of a Vector 'vector' using Heap Sort. </font>
00645 <font class="comment"> */</font>
<a name="l00646"></a><a class="code" href="vector_8c.html#a28">00646</a> <font class="keywordtype">void</font> <a class="code" href="vector_8c.html#a28">Vector_Sort</a>(<a class="code" href="arithmetique_8h.html#a93">Value</a> *vector,<font class="keywordtype">unsigned</font> n) {
00647   
00648   <font class="keywordtype">int</font> i, j;
00649   <a class="code" href="arithmetique_8h.html#a93">Value</a> temp;
00650   <a class="code" href="arithmetique_8h.html#a93">Value</a> *current_node=(<a class="code" href="arithmetique_8h.html#a93">Value</a> *)0;
00651   <a class="code" href="arithmetique_8h.html#a93">Value</a> *left_son,*right_son;
00652 
00653   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(temp);
00654 
00655   <font class="keywordflow">for</font> (i=(n-1)/2;i&gt;=0;i--) { 
00656     
00657     <font class="comment">/* Phase 1 : build the heap */</font>
00658     j=i;
00659     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(temp,*(vector+i));
00660     
00661     <font class="comment">/* While not a leaf */</font>
00662     <font class="keywordflow">while</font> (j&lt;=(n-1)/2) {
00663       current_node = vector+j;
00664       left_son = vector+(j&lt;&lt;1)+1;
00665 
00666       <font class="comment">/* If only one son */</font>
00667       <font class="keywordflow">if</font> ((j&lt;&lt;1)+2&gt;=n) {
00668         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(temp,*left_son)) {
00669           <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*current_node,*left_son);
00670           j=(j&lt;&lt;1)+1;
00671         }
00672         <font class="keywordflow">else</font>
00673           <font class="keywordflow">break</font>;
00674       }
00675       <font class="keywordflow">else</font> {  
00676         
00677         <font class="comment">/* If two sons */</font>
00678         right_son=left_son+1;
00679         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(*right_son,*left_son)) {
00680           <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(temp,*left_son)) {
00681             <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*current_node,*left_son);
00682             j=(j&lt;&lt;1)+1;
00683           }
00684           <font class="keywordflow">else</font>
00685             <font class="keywordflow">break</font>;
00686         }
00687         <font class="keywordflow">else</font> {
00688           <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(temp,*right_son)) {
00689             <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*current_node,*right_son );
00690             j=(j&lt;&lt;1)+2;
00691           }
00692           <font class="keywordflow">else</font>
00693             <font class="keywordflow">break</font>;
00694         }
00695       }
00696     }
00697     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*current_node,temp);
00698   }
00699   <font class="keywordflow">for</font>(i=n-1;i&gt;0;i--) { 
00700     
00701     <font class="comment">/* Phase 2 : sort the heap */</font>
00702     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(temp, *(vector+i));
00703     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*(vector+i),*vector);
00704     j=0;
00705     
00706     <font class="comment">/* While not a leaf */</font>
00707     <font class="keywordflow">while</font> (j&lt;i/2) {     
00708       current_node=vector+j;
00709       left_son=vector+(j&lt;&lt;1)+1;
00710       
00711       <font class="comment">/* If only one son */</font>
00712       <font class="keywordflow">if</font> ((j&lt;&lt;1)+2&gt;=i) {                
00713         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(temp,*left_son)) {
00714           <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*current_node,*left_son);
00715           j=(j&lt;&lt;1)+1;
00716         }
00717         <font class="keywordflow">else</font>
00718           <font class="keywordflow">break</font>;
00719       }
00720       <font class="keywordflow">else</font> {
00721         
00722         <font class="comment">/* If two sons */</font>
00723         right_son=left_son+1;
00724         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(*right_son,*left_son)) {
00725           <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(temp,*left_son)) {
00726             <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*current_node,*left_son);
00727             j=(j&lt;&lt;1)+1;
00728           }
00729           <font class="keywordflow">else</font>
00730             <font class="keywordflow">break</font>;
00731         }
00732         <font class="keywordflow">else</font> {
00733           <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(temp,*right_son)) {
00734             <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*current_node,*right_son );
00735             j=(j&lt;&lt;1)+2;
00736           }
00737           <font class="keywordflow">else</font>
00738             <font class="keywordflow">break</font>;
00739         }
00740       }
00741     }
00742     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*current_node,temp);
00743   }
00744   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(temp);
00745   <font class="keywordflow">return</font>;
00746 } <font class="comment">/* Vector_Sort */</font>
00747 
00748 
00749 
00750 
00751 
00752 
00753 
00754 
</pre></div><hr><address align="right"><small>Generated on Fri Nov 8 12:10:07 2002 for Polylib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
