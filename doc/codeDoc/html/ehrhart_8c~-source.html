<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ehrhart.c~ Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11.1 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>ehrhart.c~</h1><a href="ehrhart_8c~.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/***********************************************************************/</font>
00002 <font class="comment">/*                Ehrhart V4.20                                        */</font>
00003 <font class="comment">/*                copyright 1997, Doran Wilde                          */</font>
00004 <font class="comment">/*                copyright 1997-2000, Vincent Loechner                */</font>
00005 <font class="comment">/*       Permission is granted to copy, use, and distribute            */</font>
00006 <font class="comment">/*       for any commercial or noncommercial purpose under the terms   */</font>
00007 <font class="comment">/*       of the GNU General Public license, version 2, June 1991       */</font>
00008 <font class="comment">/*       (see file : LICENSING).                                       */</font>
00009 <font class="comment">/***********************************************************************/</font>
00010 
00011 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00012 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00013 <font class="preprocessor">#include &lt;ctype.h&gt;</font>
00014 <font class="preprocessor">#include &lt;string.h&gt;</font>
00015 <font class="preprocessor">#include &lt;unistd.h&gt;</font>
00016 <font class="preprocessor">#include &lt;<a class="code" href="assert_8h.html">assert.h</a>&gt;</font>
00017 
00018 <font class="preprocessor">#include &lt;polylib/polylib.h&gt;</font>
00019 <font class="comment"></font>
00020 <font class="comment">/** </font>
00021 <font class="comment">    </font>
00022 <font class="comment">define this to print all constraints on the validity domains if not</font>
00023 <font class="comment">defined, only new constraints (not in validity domain given by the</font>
00024 <font class="comment">user) are printed</font>
00025 <font class="comment"></font>
00026 <font class="comment">*/</font>
<a name="l00027"></a><a class="code" href="ehrhart_8c~.html#a0">00027</a> <font class="preprocessor">#define EPRINT_ALL_VALIDITY_CONSTRAINTS</font>
00028 <font class="preprocessor"></font><font class="comment"></font>
00029 <font class="comment">/** </font>
00030 <font class="comment">The following are mainly for debug purposes. You shouldn't need to</font>
00031 <font class="comment">change anything for daily usage...</font>
00032 <font class="comment">*/</font>
00033 <font class="comment"></font>
00034 <font class="comment">/** you may define each macro independently </font>
00035 <font class="comment">&lt;ol&gt;</font>
00036 <font class="comment">&lt;li&gt; #define EDEBUG minimal debug </font>
00037 <font class="comment">&lt;li&gt; #define EDEBUG1 prints enumeration points</font>
00038 <font class="comment">&lt;li&gt; #define EDEBUG11 prints number of points</font>
00039 <font class="comment">&lt;li&gt; #define EDEBUG2 prints domains</font>
00040 <font class="comment">&lt;li&gt; #define EDEBUG21 prints more domains</font>
00041 <font class="comment">&lt;li&gt; #define EDEBUG3 prints systems of equations that are solved</font>
00042 <font class="comment">&lt;li&gt; #define EDEBUG4 prints message for degree reduction</font>
00043 <font class="comment">&lt;li&gt; #define EDEBUG5 prints result before simplification </font>
00044 <font class="comment">&lt;li&gt; #define EDEBUG6 prints domains in Preprocess </font>
00045 <font class="comment">&lt;li&gt; #define EDEBUG61 prints even more in Preprocess</font>
00046 <font class="comment">&lt;li&gt; #define EDEBUG62 prints domains in Preprocess2</font>
00047 <font class="comment">&lt;/ol&gt;</font>
00048 <font class="comment">*/</font>
00049 
00050 <font class="comment">/* #define EDEBUG       */</font>              <font class="comment">/* minimal debug */</font>
00051 <font class="comment">/* #define EDEBUG1      */</font>              <font class="comment">/* prints enumeration points */</font>
00052 <font class="comment">/* #define EDEBUG11     */</font>              <font class="comment">/* prints number of points */</font>
00053 <font class="comment">/* #define EDEBUG2      */</font>              <font class="comment">/* prints domains */</font>
00054 <font class="comment">/* #define EDEBUG21     */</font>              <font class="comment">/* prints more domains */</font>
00055 <font class="comment">/* #define EDEBUG3      */</font>              <font class="comment">/* prints systems of equations that are solved */</font>
00056 <font class="comment">/* #define EDEBUG4      */</font>              <font class="comment">/* prints message for degree reduction */</font>
00057 <font class="comment">/* #define EDEBUG5      */</font>              <font class="comment">/* prints result before simplification */</font>
00058 <font class="comment">/* #define EDEBUG6      */</font>              <font class="comment">/* prints domains in Preprocess */</font>
00059 <font class="comment">/* #define EDEBUG61     */</font>              <font class="comment">/* prints even more in Preprocess */</font>
00060 <font class="comment">/* #define EDEBUG62     */</font>              <font class="comment">/* prints domains in Preprocess2 */</font>
00061 
00062 <font class="comment"></font>
00063 <font class="comment">/**</font>
00064 <font class="comment"> Reduce the degree of resulting polynomials</font>
00065 <font class="comment">*/</font>
<a name="l00066"></a><a class="code" href="ehrhart_8c~.html#a1">00066</a> <font class="preprocessor">#define REDUCE_DEGREE</font>
00067 <font class="preprocessor"></font><font class="comment"></font>
00068 <font class="comment">/** </font>
00069 <font class="comment">define this to print one warning message per domain overflow these</font>
00070 <font class="comment">overflows should no longer happen since version 4.20</font>
00071 <font class="comment">*/</font>
<a name="l00072"></a><a class="code" href="ehrhart_8c~.html#a2">00072</a> <font class="preprocessor">#define ALL_OVERFLOW_WARNINGS</font>
00073 <font class="preprocessor"></font><font class="comment"></font>
00074 <font class="comment">/**</font>
00075 <font class="comment">EPRINT : print results while computing the ehrhart polynomial.  this</font>
00076 <font class="comment">is done by default if you build the executable ehrhart.  (If EMAIN is</font>
00077 <font class="comment">defined).  Don't define EMAIN here, it is defined when necessary in</font>
00078 <font class="comment">the makefile.  </font>
00079 <font class="comment"></font>
00080 <font class="comment">&lt;p&gt;</font>
00081 <font class="comment"></font>
00082 <font class="comment">Notice: you may however define EPRINT without defining EMAIN, but in</font>
00083 <font class="comment">this case, you have to initialize the global variable param_name by</font>
00084 <font class="comment">calling Read_ParamNames before any call to ehrhart.  This is NOT</font>
00085 <font class="comment">recommanded, unless you know what you do.  EPRINT causes more debug</font>
00086 <font class="comment">messages to be printed.</font>
00087 <font class="comment"></font>
00088 <font class="comment">*/</font>
00089 <font class="comment">/* #define EPRINT */</font>
00090 
00091 <font class="comment">/******************* -----------END USER #DEFS-------- *********************/</font>
00092 
<a name="l00093"></a><a class="code" href="ehrhart_8c~.html#a5">00093</a> <font class="keywordtype">int</font> overflow_warning_flag = 1;
00094 
00095 <font class="comment">//#ifdef EMAIN</font>
00096 <font class="comment">/* print enumeration results while computing */</font>
<a name="l00097"></a><a class="code" href="ehrhart_8c~.html#a3">00097</a> <font class="preprocessor">#define EPRINT</font>
00098 <font class="preprocessor"></font><font class="comment">//#endif</font>
00099 <font class="preprocessor">#ifdef EPRINT</font>
<a name="l00100"></a><a class="code" href="ehrhart_8c~.html#a6">00100</a> <font class="preprocessor"></font><font class="keywordtype">char</font> **param_name;      <font class="comment">/* global variable to print parameter names */</font>
00101 <font class="preprocessor">#endif</font>
00102 <font class="preprocessor"></font>
00103 <font class="comment">/*-------------------------------------------------------------------*/</font>
00104 <font class="comment">/* EHRHART POLYNOMIAL SYMBOLIC ALGEBRA SYSTEM                        */</font>
00105 <font class="comment">/*-------------------------------------------------------------------*/</font> <font class="comment"></font>
00106 <font class="comment">/** </font>
00107 <font class="comment"></font>
00108 <font class="comment">EHRHART POLYNOMIAL SYMBOLIC ALGEBRA SYSTEM. The newly allocated enode</font>
00109 <font class="comment">can be freed with a simple free(x)</font>
00110 <font class="comment"></font>
00111 <font class="comment">@param type : enode type</font>
00112 <font class="comment">@param size : degree+1 for polynomial, period for periodic</font>
00113 <font class="comment">@param pos  : 1..nb_param, position of parameter            </font>
00114 <font class="comment">@return a newly allocated enode </font>
00115 <font class="comment"></font>
00116 <font class="comment">*/</font>
<a name="l00117"></a><a class="code" href="ehrhart_8c~.html#a7">00117</a> enode *<a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(enode_type type,<font class="keywordtype">int</font> size,<font class="keywordtype">int</font> pos)<font class="keyword"> </font>{
00118   
00119   enode *res;
00120   <font class="keywordtype">int</font> i;
00121   
00122   <font class="keywordflow">if</font>(size == 0) {
00123     fprintf(stderr, <font class="stringliteral">"Allocating enode of size 0 !\n"</font> );
00124     <font class="keywordflow">return</font> NULL;
00125   }
00126   res = (enode *) malloc(<font class="keyword">sizeof</font>(enode) + (size-1)*<font class="keyword">sizeof</font>(evalue));
00127   res-&gt;type = type;
00128   res-&gt;size = size;
00129   res-&gt;pos = pos;
00130   <font class="keywordflow">for</font>(i=0; i&lt;size; i++) {
00131     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;arr[i].d);
00132     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;arr[i].x.n);
00133     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;arr[i].d,0);
00134     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;arr[i].x.n,0);
00135   }
00136   <font class="keywordflow">return</font> res;
00137 } <font class="comment">/* new_enode */</font>
00138 <font class="comment"></font>
00139 <font class="comment">/**</font>
00140 <font class="comment">releases all memory referenced by e.  (recursive)        </font>
00141 <font class="comment">@param e pointer to an evalue</font>
00142 <font class="comment">*/</font>
<a name="l00143"></a><a class="code" href="ehrhart_8c~.html#a8">00143</a> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a8">free_evalue_refs</a>(evalue *e)<font class="keyword"> </font>{
00144   
00145   enode *p;
00146   <font class="keywordtype">int</font> i;
00147   
00148   <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e-&gt;d))<font class="keyword"> </font>{
00149     
00150     <font class="comment">/* 'e' stores a constant */</font>
00151     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(e-&gt;d);
00152     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(e-&gt;x.n);
00153     <font class="keywordflow">return</font>; 
00154   }  
00155   p = e-&gt;x.p;
00156   <font class="keywordflow">if</font> (!p) <font class="keywordflow">return</font>;       <font class="comment">/* null pointer */</font>
00157   <font class="keywordflow">for</font> (i=0; i&lt;p-&gt;size; i++) {
00158     <a class="code" href="ehrhart_8c~.html#a8">free_evalue_refs</a>(&amp;(p-&gt;arr[i]));
00159   }
00160   free(p);
00161   <font class="keywordflow">return</font>;
00162 } <font class="comment">/* free_evalue_refs */</font>
00163 <font class="comment"></font>
00164 <font class="comment">/**</font>
00165 <font class="comment"></font>
00166 <font class="comment">@param e pointer to an evalue </font>
00167 <font class="comment">@return description</font>
00168 <font class="comment"></font>
00169 <font class="comment">*/</font>
<a name="l00170"></a><a class="code" href="ehrhart_8c~.html#a9">00170</a> enode *<a class="code" href="ehrhart_8c~.html#a9">ecopy</a>(enode *e)<font class="keyword"> </font>{
00171   
00172   enode *res;
00173   <font class="keywordtype">int</font> i;
00174   
00175   res = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(e-&gt;type,e-&gt;size,e-&gt;pos);
00176   <font class="keywordflow">for</font>(i=0;i&lt;e-&gt;size;++i) {
00177     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(res-&gt;arr[i].d,e-&gt;arr[i].d);
00178     <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(res-&gt;arr[i].d))
00179       res-&gt;arr[i].x.p = <a class="code" href="ehrhart_8c~.html#a9">ecopy</a>(e-&gt;arr[i].x.p);
00180     <font class="keywordflow">else</font>
00181       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(res-&gt;arr[i].x.n,e-&gt;arr[i].x.n);
00182   }
00183   <font class="keywordflow">return</font>(res);
00184 } <font class="comment">/* ecopy */</font>
00185 <font class="comment"></font>
00186 <font class="comment">/**</font>
00187 <font class="comment"></font>
00188 <font class="comment">@param DST destination file</font>
00189 <font class="comment">@param e pointer to evalue to be printed</font>
00190 <font class="comment"></font>
00191 <font class="comment">*/</font>
<a name="l00192"></a><a class="code" href="ehrhart_8c~.html#a10">00192</a> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(FILE *DST,evalue *e,<font class="keywordtype">char</font> **pname)<font class="keyword"> </font>{
00193   
00194   <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e-&gt;d))<font class="keyword"> </font>{    
00195     <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(e-&gt;d))<font class="keyword"> </font>{
00196       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(DST,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,e-&gt;x.n);
00197       fprintf(DST,<font class="stringliteral">"/"</font>);
00198       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(DST,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,e-&gt;d);
00199     }  
00200     <font class="keywordflow">else</font> {
00201       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(DST,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,e-&gt;x.n);
00202     }
00203   }  
00204   <font class="keywordflow">else</font>
00205     <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(DST,e-&gt;x.p,pname);
00206   <font class="keywordflow">return</font>;
00207 } <font class="comment">/* print_evalue */</font>
00208 <font class="comment"></font>
00209 <font class="comment">/** prints the enode  to DST  </font>
00210 <font class="comment"></font>
00211 <font class="comment">@param DST destination file </font>
00212 <font class="comment">@param p pointer to enode  to be printed </font>
00213 <font class="comment">@param pname array of strings, name of the parameters</font>
00214 <font class="comment"></font>
00215 <font class="comment">*/</font>
<a name="l00216"></a><a class="code" href="ehrhart_8c~.html#a11">00216</a> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(FILE *DST,enode *p,<font class="keywordtype">char</font> **pname)<font class="keyword"> </font>{
00217   
00218   <font class="keywordtype">int</font> i;
00219   
00220   <font class="keywordflow">if</font> (!p) {
00221     fprintf(DST, <font class="stringliteral">"NULL"</font>);
00222     <font class="keywordflow">return</font>;
00223   }
00224   <font class="keywordflow">if</font> (p-&gt;type == evector) {
00225     fprintf(DST, <font class="stringliteral">"{ "</font>);
00226     <font class="keywordflow">for</font> (i=0; i&lt;p-&gt;size; i++) {
00227       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(DST, &amp;p-&gt;arr[i], pname);
00228       <font class="keywordflow">if</font> (i!=(p-&gt;size-1))
00229         fprintf(DST, <font class="stringliteral">", "</font>);
00230     }
00231     fprintf(DST, <font class="stringliteral">" }\n"</font>);
00232   }
00233   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (p-&gt;type == polynomial) {
00234     fprintf(DST, <font class="stringliteral">"( "</font>);
00235     <font class="keywordflow">for</font> (i=p-&gt;size-1; i&gt;=0; i--) {
00236       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(DST, &amp;p-&gt;arr[i], pname);
00237       <font class="keywordflow">if</font> (i==1) fprintf(DST, <font class="stringliteral">" * %s + "</font>, pname[p-&gt;pos-1]);
00238       <font class="keywordflow">else</font> <font class="keywordflow">if</font> (i&gt;1) 
00239         fprintf(DST, <font class="stringliteral">" * %s^%d + "</font>, pname[p-&gt;pos-1], i);
00240     }
00241     fprintf(DST, <font class="stringliteral">" )\n"</font>);
00242   }
00243   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (p-&gt;type == periodic) {
00244     fprintf(DST, <font class="stringliteral">"[ "</font>);
00245     <font class="keywordflow">for</font> (i=0; i&lt;p-&gt;size; i++) {
00246       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(DST, &amp;p-&gt;arr[i], pname);
00247       <font class="keywordflow">if</font> (i!=(p-&gt;size-1)) fprintf(DST, <font class="stringliteral">", "</font>);
00248     }
00249     fprintf(DST,<font class="stringliteral">" ]_%s"</font>, pname[p-&gt;pos-1]);
00250   }
00251   <font class="keywordflow">return</font>;
00252 } <font class="comment">/* print_enode */</font> 
00253 <font class="comment"></font>
00254 <font class="comment">/**</font>
00255 <font class="comment"></font>
00256 <font class="comment">@param  e1 pointers to evalues</font>
00257 <font class="comment">@param  e2 pointers to evalues</font>
00258 <font class="comment">@return 1 (true) if they are equal, 0 (false) if not       </font>
00259 <font class="comment"></font>
00260 <font class="comment">*/</font>
<a name="l00261"></a><a class="code" href="ehrhart_8c~.html#a12">00261</a> <font class="keyword">static</font> <font class="keywordtype">int</font> <a class="code" href="ehrhart_8c~.html#a12">eequal</a>(evalue *e1,evalue *e2)<font class="keyword"> </font>{ 
00262  
00263     <font class="keywordtype">int</font> i;
00264     enode *p1, *p2;
00265   
00266     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a23">value_ne</a>(e1-&gt;d,e2-&gt;d))
00267         <font class="keywordflow">return</font> 0;
00268   
00269     <font class="comment">/* e1-&gt;d == e2-&gt;d */</font>
00270     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e1-&gt;d))<font class="keyword"> </font>{    
00271         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a23">value_ne</a>(e1-&gt;x.n,e2-&gt;x.n))
00272             <font class="keywordflow">return</font> 0;
00273     
00274         <font class="comment">/* e1-&gt;d == e2-&gt;d != 0  AND e1-&gt;n == e2-&gt;n */</font>
00275         <font class="keywordflow">return</font> 1;
00276     }
00277   
00278     <font class="comment">/* e1-&gt;d == e2-&gt;d == 0 */</font>
00279     p1 = e1-&gt;x.p;
00280     p2 = e2-&gt;x.p;
00281     <font class="keywordflow">if</font> (p1-&gt;type != p2-&gt;type) <font class="keywordflow">return</font> 0;
00282     <font class="keywordflow">if</font> (p1-&gt;size != p2-&gt;size) <font class="keywordflow">return</font> 0;
00283     <font class="keywordflow">if</font> (p1-&gt;pos  != p2-&gt;pos) <font class="keywordflow">return</font> 0;
00284     <font class="keywordflow">for</font> (i=0; i&lt;p1-&gt;size; i++)
00285         <font class="keywordflow">if</font> (!<a class="code" href="ehrhart_8c~.html#a12">eequal</a>(&amp;p1-&gt;arr[i], &amp;p2-&gt;arr[i]) ) 
00286             <font class="keywordflow">return</font> 0;
00287     <font class="keywordflow">return</font> 1;
00288 } <font class="comment">/* eequal */</font>
00289 <font class="comment"></font>
00290 <font class="comment">/** </font>
00291 <font class="comment"></font>
00292 <font class="comment">@param e pointer to an evalue</font>
00293 <font class="comment"></font>
00294 <font class="comment">*/</font>
<a name="l00295"></a><a class="code" href="ehrhart_8c~.html#a13">00295</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a13">reduce_evalue</a> (evalue *e)<font class="keyword"> </font>{
00296   
00297     enode *p;
00298     <font class="keywordtype">int</font> i, j, k;
00299   
00300     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e-&gt;d))
00301         <font class="keywordflow">return</font>; <font class="comment">/* a rational number, its already reduced */</font>
00302     <font class="keywordflow">if</font>(!(p = e-&gt;x.p))
00303         <font class="keywordflow">return</font>; <font class="comment">/* hum... an overflow probably occured */</font>
00304   
00305     <font class="comment">/* First reduce the components of p */</font>
00306     <font class="keywordflow">for</font> (i=0; i&lt;p-&gt;size; i++)
00307         <a class="code" href="ehrhart_8c~.html#a13">reduce_evalue</a>(&amp;p-&gt;arr[i]);
00308 
00309     <font class="keywordflow">if</font> (p-&gt;type==periodic) {
00310     
00311         <font class="comment">/* Try to reduce the period */</font>
00312         <font class="keywordflow">for</font> (i=1; i&lt;=(p-&gt;size)/2; i++) {
00313             <font class="keywordflow">if</font> ((p-&gt;size % i)==0) {
00314         
00315                 <font class="comment">/* Can we reduce the size to i ? */</font>
00316                 <font class="keywordflow">for</font> (j=0; j&lt;i; j++)
00317                     <font class="keywordflow">for</font> (k=j+i; k&lt;e-&gt;x.p-&gt;size; k+=i)
00318                         <font class="keywordflow">if</font> (!<a class="code" href="ehrhart_8c~.html#a12">eequal</a>(&amp;p-&gt;arr[j], &amp;p-&gt;arr[k])) <font class="keywordflow">goto</font> you_lose;
00319 
00320                 <font class="comment">/* OK, lets do it */</font>
00321                 <font class="keywordflow">for</font> (j=i; j&lt;p-&gt;size; j++) <a class="code" href="ehrhart_8c~.html#a8">free_evalue_refs</a>(&amp;p-&gt;arr[j]);
00322                 p-&gt;size = i;
00323                 <font class="keywordflow">break</font>;
00324 
00325             you_lose:   <font class="comment">/* OK, lets not do it */</font>
00326                 <font class="keywordflow">continue</font>;
00327             }
00328         }
00329 
00330         <font class="comment">/* Try to reduce its strength */</font>
00331         <font class="keywordflow">if</font> (p-&gt;size == 1) {
00332             memcpy(e,&amp;p-&gt;arr[0],<font class="keyword">sizeof</font>(evalue));
00333             free(p);
00334         }
00335     }
00336     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (p-&gt;type==polynomial) {
00337           
00338         <font class="comment">/* Try to reduce the degree */</font>
00339         <font class="keywordflow">for</font> (i=p-&gt;size-1;i&gt;=0;i--) {
00340             <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a69">value_one_p</a>(p-&gt;arr[i].d) &amp;&amp; value_zero_p(p-&gt;arr[i].x.n))
00341         
00342                 <font class="comment">/* Zero coefficient */</font>
00343                 <font class="keywordflow">continue</font>;
00344             <font class="keywordflow">else</font>
00345                 <font class="keywordflow">break</font>;
00346         }
00347         <font class="keywordflow">if</font> (i==-1) p-&gt;size = 1;
00348         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (i+1&lt;p-&gt;size) p-&gt;size = i+1;
00349 
00350         <font class="comment">/* Try to reduce its strength */</font>
00351         <font class="keywordflow">if</font> (p-&gt;size == 1) {
00352             memcpy(e,&amp;p-&gt;arr[0],<font class="keyword">sizeof</font>(evalue));
00353             free(p);
00354         }
00355     }
00356 } <font class="comment">/* reduce_evalue */</font>
00357 
00358 <font class="comment"></font>
00359 <font class="comment">/**</font>
00360 <font class="comment"></font>
00361 <font class="comment">multiplies two evalues and puts the result in res</font>
00362 <font class="comment"></font>
00363 <font class="comment">@param e1 pointer to an evalue</font>
00364 <font class="comment">@param e2 pointer to a constant evalue</font>
00365 <font class="comment">@param res  pointer to result evalue = e1 * e2</font>
00366 <font class="comment"></font>
00367 <font class="comment">*/</font>
<a name="l00368"></a><a class="code" href="ehrhart_8c~.html#a14">00368</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a14">emul</a> (evalue *e1,evalue *e2,evalue *res)<font class="keyword"> </font>{
00369   
00370     enode *p;
00371     <font class="keywordtype">int</font> i;
00372     Value g;
00373 
00374     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(e2-&gt;d))<font class="keyword"> </font>{
00375         fprintf(stderr, <font class="stringliteral">"emul: ?expecting constant value\n"</font>);
00376         <font class="keywordflow">return</font>;
00377     }  
00378     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(g);
00379     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e1-&gt;d))<font class="keyword"> </font>{
00380     
00381         <font class="comment">/* Product of two rational numbers */</font>
00382         <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(res-&gt;d,e1-&gt;d,e2-&gt;d);
00383         <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(res-&gt;x.n,e1-&gt;x.n,e2-&gt;x.n );
00384         <a class="code" href="vector_8c.html#a3">Gcd</a>(res-&gt;x.n, res-&gt;d,&amp;g);
00385         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(g))<font class="keyword"> </font>{
00386             <a class="code" href="arithmetique_8h.html#a51">value_division</a>(res-&gt;d,res-&gt;d,g);
00387             <a class="code" href="arithmetique_8h.html#a51">value_division</a>(res-&gt;x.n,res-&gt;x.n,g);
00388         }
00389     }
00390     <font class="keywordflow">else</font> { <font class="comment">/* e1 is an expression */</font>    
00391         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;d,0);
00392         p = e1-&gt;x.p;
00393         res-&gt;x.p = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(p-&gt;type, p-&gt;size, p-&gt;pos);
00394         <font class="keywordflow">for</font> (i=0; i&lt;p-&gt;size; i++) {
00395             <a class="code" href="ehrhart_8c~.html#a14">emul</a>(&amp;p-&gt;arr[i], e2, &amp;(res-&gt;x.p-&gt;arr[i]) ); 
00396         }
00397     }
00398     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g);
00399     <font class="keywordflow">return</font>;
00400 } <font class="comment">/* emul */</font>
00401 <font class="comment"></font>
00402 <font class="comment">/**</font>
00403 <font class="comment">adds one evalue to evalue 'res. result = res + e1 </font>
00404 <font class="comment"></font>
00405 <font class="comment">@param e1 an evalue </font>
00406 <font class="comment">@param res </font>
00407 <font class="comment"></font>
00408 <font class="comment">*/</font>
<a name="l00409"></a><a class="code" href="ehrhart_8c~.html#a15">00409</a> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(evalue *e1,evalue *res)<font class="keyword"> </font>{
00410 
00411   <font class="keywordtype">int</font> i;
00412   Value g,m1,m2;
00413  
00414   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(g);
00415   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(m1);
00416   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(m2);
00417   
00418   <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e1-&gt;d) &amp;&amp; value_notzero_p(res-&gt;d))<font class="keyword"> </font>{
00419     
00420     <font class="comment">/* Add two rational numbers*/</font>
00421     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(m1,e1-&gt;x.n,res-&gt;d);
00422     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(m2,res-&gt;x.n,e1-&gt;d);
00423     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(res-&gt;x.n,m1,m2);
00424     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(res-&gt;d,e1-&gt;d,res-&gt;d);  
00425     <a class="code" href="vector_8c.html#a3">Gcd</a>(res-&gt;x.n,res-&gt;d,&amp;g);
00426     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(g))<font class="keyword"> </font>{  
00427       <a class="code" href="arithmetique_8h.html#a51">value_division</a>(res-&gt;d,res-&gt;d,g);
00428       <a class="code" href="arithmetique_8h.html#a51">value_division</a>(res-&gt;x.n,res-&gt;x.n,g);
00429     }
00430     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00431     <font class="keywordflow">return</font>;
00432   }
00433   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e1-&gt;d) &amp;&amp; value_zero_p(res-&gt;d))<font class="keyword"> </font>{
00434     <font class="keywordflow">if</font> (res-&gt;x.p-&gt;type==polynomial) {
00435       
00436       <font class="comment">/* Add the constant to the constant term */</font>
00437       <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(e1, &amp;res-&gt;x.p-&gt;arr[0]);
00438       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00439       <font class="keywordflow">return</font>;
00440     }
00441     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (res-&gt;x.p-&gt;type==periodic) {
00442       
00443       <font class="comment">/* Add the constant to all elements of periodic number */</font>
00444       <font class="keywordflow">for</font> (i=0; i&lt;res-&gt;x.p-&gt;size; i++) { 
00445         <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(e1, &amp;res-&gt;x.p-&gt;arr[i]);
00446       }
00447       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00448       <font class="keywordflow">return</font>;
00449     }
00450     <font class="keywordflow">else</font> {
00451       fprintf(stderr, <font class="stringliteral">"eadd: cannot add const with vector\n"</font>);
00452       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00453       <font class="keywordflow">return</font>;
00454     }
00455   }
00456   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(e1-&gt;d) &amp;&amp; value_notzero_p(res-&gt;d))<font class="keyword"> </font>{
00457     fprintf(stderr,<font class="stringliteral">"eadd: cannot add evalue to const\n"</font>);
00458     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00459     <font class="keywordflow">return</font>;
00460   }
00461   <font class="keywordflow">else</font> {    <font class="comment">/* ((e1-&gt;d==0) &amp;&amp; (res-&gt;d==0)) */</font>  
00462     <font class="keywordflow">if</font> ((e1-&gt;x.p-&gt;type != res-&gt;x.p-&gt;type) ||
00463         (e1-&gt;x.p-&gt;pos  != res-&gt;x.p-&gt;pos )) {
00464       fprintf(stderr, <font class="stringliteral">"eadd: ?cannot add, incompatible types\n"</font>);
00465       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00466       <font class="keywordflow">return</font>;
00467     }
00468     <font class="keywordflow">if</font> (e1-&gt;x.p-&gt;size == res-&gt;x.p-&gt;size) {
00469       <font class="keywordflow">for</font> (i=0; i&lt;res-&gt;x.p-&gt;size; i++) {
00470         <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(&amp;e1-&gt;x.p-&gt;arr[i], &amp;res-&gt;x.p-&gt;arr[i]);
00471       }
00472       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00473       <font class="keywordflow">return</font>;
00474     }
00475     
00476     <font class="comment">/* Sizes are different */</font>
00477     <font class="keywordflow">if</font> (res-&gt;x.p-&gt;type==polynomial) { 
00478       
00479       <font class="comment">/* VIN100: if e1-size &gt; res-size you have to copy e1 in a   */</font>
00480       <font class="comment">/* new enode and add res to that new node. If you do not do */</font>
00481       <font class="comment">/* that, you lose the the upper weight part of e1 !         */</font>
00482       
00483       <font class="keywordflow">if</font>(e1-&gt;x.p-&gt;size &gt; res-&gt;x.p-&gt;size) {
00484         enode *tmp;
00485         tmp = <a class="code" href="ehrhart_8c~.html#a9">ecopy</a>(e1-&gt;x.p);
00486         <font class="keywordflow">for</font>(i=0;i&lt;res-&gt;x.p-&gt;size;++i) {
00487           <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(&amp;res-&gt;x.p-&gt;arr[i], &amp;tmp-&gt;arr[i]);
00488           <a class="code" href="ehrhart_8c~.html#a8">free_evalue_refs</a>(&amp;res-&gt;x.p-&gt;arr[i]);
00489         }
00490         res-&gt;x.p = tmp;
00491       }
00492       <font class="keywordflow">else</font> {
00493         <font class="keywordflow">for</font> (i=0; i&lt;e1-&gt;x.p-&gt;size ; i++) {
00494           <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(&amp;e1-&gt;x.p-&gt;arr[i], &amp;res-&gt;x.p-&gt;arr[i]);
00495         }
00496         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00497         <font class="keywordflow">return</font>;
00498       }
00499     }
00500     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (res-&gt;x.p-&gt;type==periodic) {
00501       fprintf(stderr, <font class="stringliteral">"eadd: ?addition of different sized periodic nos\n"</font>);
00502       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00503       <font class="keywordflow">return</font>;
00504     }
00505     <font class="keywordflow">else</font> { <font class="comment">/* evector */</font>
00506       fprintf(stderr, <font class="stringliteral">"eadd: ?cannot add vectors of different length\n"</font>);
00507       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00508       <font class="keywordflow">return</font>;
00509     }
00510   }
00511   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00512   <font class="keywordflow">return</font>;
00513 } <font class="comment">/* eadd */</font>
00514 <font class="comment"></font>
00515 <font class="comment">/** </font>
00516 <font class="comment"></font>
00517 <font class="comment">computes the inner product of two vectors. Result = result (evalue) =</font>
00518 <font class="comment">v1.v2 (dot product)</font>
00519 <font class="comment"></font>
00520 <font class="comment">@param  v1 an enode (vector)</font>
00521 <font class="comment">@param  v2 an enode (vector of constants)</font>
00522 <font class="comment">@param res result (evalue)</font>
00523 <font class="comment"></font>
00524 <font class="comment">*/</font>
<a name="l00525"></a><a class="code" href="ehrhart_8c~.html#a16">00525</a> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a16">edot</a>(enode *v1,enode *v2,evalue *res)<font class="keyword"> </font>{
00526   
00527     <font class="keywordtype">int</font> i;
00528     evalue tmp;
00529   
00530     <font class="keywordflow">if</font> ((v1-&gt;type != evector) || (v2-&gt;type != evector)) {
00531         fprintf(stderr, <font class="stringliteral">"edot: ?expecting vectors\n"</font>);
00532         <font class="keywordflow">return</font>;
00533     }
00534     <font class="keywordflow">if</font> (v1-&gt;size != v2-&gt;size) {
00535         fprintf(stderr, <font class="stringliteral">"edot: ? vector lengths do not agree\n"</font>);
00536         <font class="keywordflow">return</font>;
00537     }
00538     <font class="keywordflow">if</font> (v1-&gt;size&lt;=0) {
00539         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;d,1); <font class="comment">/* set result to 0/1 */</font>
00540         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;x.n,0);
00541         <font class="keywordflow">return</font>;
00542     }
00543   
00544     <font class="comment">/* vector v2 is expected to have only rational numbers in */</font>
00545     <font class="comment">/* the array.  No pointers. */</font>  
00546     <a class="code" href="ehrhart_8c~.html#a14">emul</a>(&amp;v1-&gt;arr[0],&amp;v2-&gt;arr[0],res);
00547     <font class="keywordflow">for</font> (i=1; i&lt;v1-&gt;size; i++) {
00548         <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp.d);
00549         <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp.x.n);
00550      
00551         <font class="comment">/* res = res + v1[i]*v2[i] */</font>
00552         <a class="code" href="ehrhart_8c~.html#a14">emul</a>(&amp;v1-&gt;arr[i],&amp;v2-&gt;arr[i],&amp;tmp);
00553         <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(&amp;tmp,res);
00554         <a class="code" href="ehrhart_8c~.html#a8">free_evalue_refs</a>(&amp;tmp);
00555     }
00556     <font class="keywordflow">return</font>;
00557 } <font class="comment">/* edot */</font>
00558 <font class="comment"></font>
00559 <font class="comment">/**</font>
00560 <font class="comment"></font>
00561 <font class="comment">local recursive function used in the following ref contains the new</font>
00562 <font class="comment">position for each old index position</font>
00563 <font class="comment"></font>
00564 <font class="comment">@param e pointer to an evalue</font>
00565 <font class="comment">@param ref transformation Matrix</font>
00566 <font class="comment"></font>
00567 <font class="comment">*/</font>
<a name="l00568"></a><a class="code" href="ehrhart_8c~.html#a17">00568</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a17">aep_evalue</a>(evalue *e, <font class="keywordtype">int</font> *ref)<font class="keyword"> </font>{
00569   
00570     enode *p;
00571     <font class="keywordtype">int</font> i;
00572   
00573     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e-&gt;d))
00574         <font class="keywordflow">return</font>;         <font class="comment">/* a rational number, its already reduced */</font>
00575     <font class="keywordflow">if</font>(!(p = e-&gt;x.p))
00576         <font class="keywordflow">return</font>;         <font class="comment">/* hum... an overflow probably occured */</font>
00577   
00578     <font class="comment">/* First check the components of p */</font>
00579     <font class="keywordflow">for</font> (i=0;i&lt;p-&gt;size;i++)
00580         <a class="code" href="ehrhart_8c~.html#a17">aep_evalue</a>(&amp;p-&gt;arr[i],ref);
00581   
00582     <font class="comment">/* Then p itself */</font>
00583     p-&gt;pos = ref[p-&gt;pos-1]+1;
00584     <font class="keywordflow">return</font>;
00585 } <font class="comment">/* aep_evalue */</font>
00586 <font class="comment"></font>
00587 <font class="comment">/** Comments */</font>
<a name="l00588"></a><a class="code" href="ehrhart_8c~.html#a18">00588</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a18">addeliminatedparams_evalue</a>(evalue *e,Matrix *CT)<font class="keyword"> </font>{
00589         
00590     enode *p;
00591     <font class="keywordtype">int</font> i, j;
00592     <font class="keywordtype">int</font> *ref;
00593 
00594     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e-&gt;d))
00595         <font class="keywordflow">return</font>;          <font class="comment">/* a rational number, its already reduced */</font>
00596     <font class="keywordflow">if</font>(!(p = e-&gt;x.p))
00597         <font class="keywordflow">return</font>;          <font class="comment">/* hum... an overflow probably occured */</font>
00598   
00599     <font class="comment">/* Compute ref */</font>
00600     ref = (<font class="keywordtype">int</font> *)malloc(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*(CT-&gt;NbRows-1));
00601     <font class="keywordflow">for</font>(i=0;i&lt;CT-&gt;NbRows-1;i++)
00602         <font class="keywordflow">for</font>(j=0;j&lt;CT-&gt;NbColumns;j++)
00603             <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(CT-&gt;p[i][j]))<font class="keyword"> </font>{
00604                 ref[i] = j;
00605                 <font class="keywordflow">break</font>;
00606             }
00607   
00608     <font class="comment">/* Transform the references in e, using ref */</font>
00609     <a class="code" href="ehrhart_8c~.html#a17">aep_evalue</a>(e,ref);
00610     free( ref );
00611     <font class="keywordflow">return</font>;
00612 } <font class="comment">/* addeliminatedparams_evalue */</font>
00613 <font class="comment"></font>
00614 <font class="comment">/** </font>
00615 <font class="comment"></font>
00616 <font class="comment">This procedure finds an integer point contained in polyhedron D /</font>
00617 <font class="comment">first checks for positive values, then for negative values returns</font>
00618 <font class="comment">TRUE on success. Result is in min.  returns FALSE if no integer point</font>
00619 <font class="comment">is found</font>
00620 <font class="comment"></font>
00621 <font class="comment">&lt;p&gt;</font>
00622 <font class="comment"></font>
00623 <font class="comment">This is the maximum number of iterations for a given parameter to find</font>
00624 <font class="comment">a integer point inside the context. Kind of weird. cherche_min should</font>
00625 <font class="comment"></font>
00626 <font class="comment">&lt;p&gt;</font>
00627 <font class="comment"></font>
00628 <font class="comment">@param min</font>
00629 <font class="comment">@param D</font>
00630 <font class="comment">@param pos</font>
00631 <font class="comment"></font>
00632 <font class="comment">*/</font>
00633  <font class="comment">//FIXME: needs to be rewritten !</font>
<a name="l00634"></a><a class="code" href="ehrhart_8c~.html#a4">00634</a> <font class="preprocessor">#define MAXITER 100</font>
<a name="l00635"></a><a class="code" href="ehrhart_8c~.html#a19">00635</a> <font class="preprocessor"></font><font class="keywordtype">int</font> <a class="code" href="ehrhart_8c~.html#a19">cherche_min</a>(Value *min,Polyhedron *D,<font class="keywordtype">int</font> pos)<font class="keyword"> </font>{
00636         
00637     Value binf, bsup;   <font class="comment">/* upper &amp; lower bound */</font>
00638     Value i;
00639     <font class="keywordtype">int</font> flag, maxiter;
00640   
00641     <font class="keywordflow">if</font>(!D)
00642         <font class="keywordflow">return</font>(1);
00643     <font class="keywordflow">if</font>(pos &gt; D-&gt;Dimension)
00644         <font class="keywordflow">return</font>(1);
00645   
00646     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(binf); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(bsup);
00647     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(i);
00648   
00649 <font class="preprocessor">#ifdef EDEBUG61</font>
00650 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"Entering Cherche min --&gt; \n"</font>);
00651     fprintf(stderr,<font class="stringliteral">"LowerUpperBounds :\n"</font>);
00652     fprintf(stderr,<font class="stringliteral">"pos = %d\n"</font>,pos);
00653     fprintf(stderr,<font class="stringliteral">"current min = ("</font>);
00654     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,min[0]);
00655     {<font class="keywordtype">int</font> j;
00656     <font class="keywordflow">for</font>(j=1;j&lt;=D-&gt;Dimension ; j++) {
00657         fprintf(stderr,<font class="stringliteral">", "</font>);
00658         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,min[j]);
00659     }  
00660     }
00661     fprintf(stderr,<font class="stringliteral">")\n"</font>);
00662 <font class="preprocessor">#endif</font>
00663 <font class="preprocessor"></font>        
00664     flag = <a class="code" href="polyhedron_8c.html#a49">lower_upper_bounds</a>(pos,D,min,&amp;binf,&amp;bsup);
00665   
00666 <font class="preprocessor">#ifdef EDEBUG61</font>
00667 <font class="preprocessor"></font>    fprintf(stderr, <font class="stringliteral">"flag = %d\n"</font>, flag);
00668     fprintf(stderr,<font class="stringliteral">"binf = "</font>);
00669     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,binf);
00670     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00671     fprintf(stderr,<font class="stringliteral">"bsup = "</font>);
00672     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,bsup);
00673     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00674 <font class="preprocessor">#endif</font>
00675 <font class="preprocessor"></font>
00676     <font class="keywordflow">if</font>(flag&amp;LB_INFINITY)
00677         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(binf,0);
00678   
00679     <font class="comment">/* Loop from 0 (or binf if positive) to bsup */</font>
00680     <font class="keywordflow">for</font>(maxiter=0,(((flag&amp;LB_INFINITY) || <a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(binf)) ? 
00681             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(i,0) : <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(i,binf));
00682         ((flag&amp;UB_INFINITY) || <a class="code" href="arithmetique_8h.html#a27">value_le</a>(i,bsup)) &amp;&amp; maxiter&lt;MAXITER ;
00683         <a class="code" href="arithmetique_8h.html#a45">value_increment</a>(i,i),maxiter++)<font class="keyword"> </font>{
00684     
00685         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(min[pos],i);
00686         <font class="keywordflow">if</font>(<a class="code" href="ehrhart_8c~.html#a19">cherche_min</a>(min,D-&gt;next,pos+1))<font class="keyword"> </font>{
00687             <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(binf); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(bsup);
00688             <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(i);
00689             <font class="keywordflow">return</font>(1);
00690         }  
00691     }
00692   
00693     <font class="comment">/* Descending loop from -1 (or bsup if negative) to binf */</font>
00694     <font class="keywordflow">if</font>((flag&amp;LB_INFINITY) || <a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(binf))
00695         <font class="keywordflow">for</font>(maxiter=0,(((flag&amp;UB_INFINITY) || <a class="code" href="arithmetique_8h.html#a63">value_pos_p</a>(bsup))?
00696                 <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(i,-1)
00697                 :<a class="code" href="arithmetique_8h.html#a11">value_assign</a>(i,bsup));
00698             ((flag&amp;LB_INFINITY) || <a class="code" href="arithmetique_8h.html#a25">value_ge</a>(i,binf)) &amp;&amp; maxiter&lt;MAXITER  ;
00699             <a class="code" href="arithmetique_8h.html#a50">value_decrement</a>(i,i),maxiter++)<font class="keyword"> </font>{
00700 
00701             <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(min[pos],i);
00702             <font class="keywordflow">if</font>(<a class="code" href="ehrhart_8c~.html#a19">cherche_min</a>(min,D-&gt;next,pos+1))<font class="keyword"> </font>{
00703                 <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(binf); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(bsup);
00704                 <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(i);
00705                 <font class="keywordflow">return</font>(1);
00706             }   
00707         }
00708     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(binf); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(bsup);
00709     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(i);
00710 
00711     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(min[pos],0);
00712     <font class="keywordflow">return</font>(0);       <font class="comment">/* not found :-( */</font>
00713 } <font class="comment">/* cherche_min */</font>
00714 <font class="comment"></font>
00715 <font class="comment">/** </font>
00716 <font class="comment"></font>
00717 <font class="comment">This procedure finds the smallest parallelepiped of size</font>
00718 <font class="comment">'&lt;i&gt;size[i]&lt;/i&gt;' for every dimension i, contained in polyhedron D If</font>
00719 <font class="comment">this is not possible, an empty polyhedron is returned</font>
00720 <font class="comment"></font>
00721 <font class="comment">&lt;p&gt;</font>
00722 <font class="comment"></font>
00723 <font class="comment">&lt;pre&gt;</font>
00724 <font class="comment">written by vin100, 2000, for version 4.19</font>
00725 <font class="comment">modified 2002, version 5.10</font>
00726 <font class="comment">&lt;/pre&gt;</font>
00727 <font class="comment"></font>
00728 <font class="comment">&lt;p&gt;</font>
00729 <font class="comment"></font>
00730 <font class="comment">It first finds the coordinates of the lexicographically smallest edge</font>
00731 <font class="comment">of the hypercube, obtained by transforming the constraints of D (by</font>
00732 <font class="comment">adding 'size' as many times as there are negative coeficients in each</font>
00733 <font class="comment">constraint), and finding the lexicographical min of this</font>
00734 <font class="comment">polyhedron. Then it builds the hypercube and returns it.</font>
00735 <font class="comment"></font>
00736 <font class="comment">&lt;p&gt;</font>
00737 <font class="comment">@param D</font>
00738 <font class="comment">@param size</font>
00739 <font class="comment">@param MAXRAYS</font>
00740 <font class="comment"></font>
00741 <font class="comment">*/</font>
00742 
<a name="l00743"></a><a class="code" href="ehrhart_8c~.html#a20">00743</a> Polyhedron *<a class="code" href="ehrhart_8c~.html#a20">Polyhedron_Preprocess</a>(Polyhedron *D,Value *size,<font class="keywordtype">unsigned</font> <a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>)<font class="keyword"></font>
00744 <font class="keyword"></font>{
00745     Matrix *M;
00746     <font class="keywordtype">int</font> i, j, d;
00747     Polyhedron *T, *S, *H, *C;
00748     Value *min,tmp;
00749   
00750     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
00751     d = D-&gt;Dimension;
00752     M = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>, D-&gt;Dimension+2);
00753     M-&gt;NbRows = D-&gt;NbConstraints;
00754   
00755     <font class="comment">/* Original constraints */</font>
00756     <font class="keywordflow">for</font>(i=0;i&lt;D-&gt;NbConstraints;i++)
00757         <a class="code" href="vector_8c.html#a11">Vector_Copy</a>(D-&gt;Constraint[i],M-&gt;p[i],(d+2));
00758 
00759 <font class="preprocessor">#ifdef EDEBUG6</font>
00760 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"M for PreProcess : "</font>);
00761     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,M);
00762     fprintf(stderr,<font class="stringliteral">"\nsize == "</font>);
00763     <font class="keywordflow">for</font>( i=0 ; i&lt;d ; i++ )
00764         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,size[i]);
00765     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00766 <font class="preprocessor">#endif</font>
00767 <font class="preprocessor"></font>
00768     <font class="comment">/* Additionnal constraints */</font>
00769     <font class="keywordflow">for</font>(i=0;i&lt;D-&gt;NbConstraints;i++) {
00770         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(D-&gt;Constraint[i][0]))<font class="keyword"> </font>{
00771             fprintf(stderr,<font class="stringliteral">"Polyhedron_Preprocess: "</font>);
00772             fprintf(stderr,<font class="stringliteral">"an equality was found where I did expect an inequality.\n"</font>);
00773             fprintf(stderr,<font class="stringliteral">"Trying to continue...\n"</font>);
00774             <font class="keywordflow">continue</font>;
00775         }
00776         <a class="code" href="vector_8c.html#a11">Vector_Copy</a>(D-&gt;Constraint[i],M-&gt;p[M-&gt;NbRows],(d+2));
00777         <font class="keywordflow">for</font>(j=1;j&lt;=d;j++)
00778             <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(D-&gt;Constraint[i][j]))<font class="keyword"> </font>{
00779                 <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(tmp,D-&gt;Constraint[i][j],size[j-1]);
00780                 <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(M-&gt;p[M-&gt;NbRows][d+1],M-&gt;p[M-&gt;NbRows][d+1],tmp);
00781             }
00782     
00783         <font class="comment">/* If anything changed, add this new constraint */</font>
00784         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a23">value_ne</a>(M-&gt;p[M-&gt;NbRows][d+1],D-&gt;Constraint[i][d+1]))
00785             M-&gt;NbRows ++ ;
00786     }
00787   
00788 <font class="preprocessor">#ifdef EDEBUG6</font>
00789 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"M used to find min : "</font>);
00790     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,M);
00791 <font class="preprocessor">#endif</font>
00792 <font class="preprocessor"></font>  
00793     T = <a class="code" href="polyhedron_8c.html#a24">Constraints2Polyhedron</a>(M,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
00794     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(M);
00795     <font class="keywordflow">if</font> (!T || emptyQ(T))<font class="keyword"> </font>{
00796         <font class="keywordflow">if</font>(T)
00797             <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(T);
00798         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00799         <font class="keywordflow">return</font>(NULL);
00800     }
00801   
00802     <font class="comment">/* Ok, now find the lexicographical min of T */</font>
00803     min = (Value *) malloc(<font class="keyword">sizeof</font>(Value) * (d+2));
00804     <font class="keywordflow">for</font>(i=0;i&lt;=d;i++) {
00805         <a class="code" href="arithmetique_8h.html#a10">value_init</a>(min[i]);
00806         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(min[i],0);
00807     }  
00808     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(min[i]);
00809     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(min[i],1);
00810     C = <a class="code" href="polyhedron_8c.html#a23">Universe_Polyhedron</a>(0);
00811     S = <a class="code" href="polyhedron_8c.html#a48">Polyhedron_Scan</a>(T,C,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
00812     <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(C);
00813     <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(T);
00814 
00815 <font class="preprocessor">#ifdef EDEBUG6</font>
00816 <font class="preprocessor"></font>    <font class="keywordflow">for</font>(i=0;i&lt;=(d+1);i++) {
00817         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,min[i]);
00818         fprintf(stderr,<font class="stringliteral">" ,"</font>);
00819     }
00820     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00821     <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,S);
00822     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00823 <font class="preprocessor">#endif</font>
00824 <font class="preprocessor"></font>    
00825     <font class="keywordflow">if</font> (!<a class="code" href="ehrhart_8c~.html#a19">cherche_min</a>(min,S,1))<font class="keyword"></font>
00826 <font class="keyword">        </font>{
00827             <font class="keywordflow">for</font>(i=0;i&lt;=(d+1);i++)
00828                 <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(min[i]);
00829             <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00830             <font class="keywordflow">return</font>(NULL);
00831         }
00832     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(S);
00833   
00834 <font class="preprocessor">#ifdef EDEBUG6</font>
00835 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"min = ( "</font>);
00836     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,min[1]);
00837     <font class="keywordflow">for</font>(i=2;i&lt;=d;i++) {
00838         fprintf(stderr,<font class="stringliteral">", "</font>);
00839         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,min[i]);
00840     }  
00841     fprintf(stderr,<font class="stringliteral">")\n"</font>);
00842 <font class="preprocessor">#endif</font>
00843 <font class="preprocessor"></font>  
00844     <font class="comment">/* Min is the point from which we can construct the hypercube */</font>
00845     M = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(d*2,d+2);
00846     <font class="keywordflow">for</font>(i=0;i&lt;d;i++) {
00847     
00848         <font class="comment">/* Creates inequality  1 0..0 1 0..0 -min[i+1] */</font>
00849         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i][0],1);
00850         <font class="keywordflow">for</font>(j=1;j&lt;=d;j++)
00851             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i][j],0);
00852         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i][i+1],1);
00853         <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(M-&gt;p[2*i][d+1],min[i+1]);
00854     
00855         <font class="comment">/* Creates inequality  1 0..0 -1 0..0 min[i+1]+size -1 */</font>
00856         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i+1][0],1);
00857         <font class="keywordflow">for</font>(j=1;j&lt;=d;j++)
00858             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i+1][j],0);
00859         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i+1][i+1],-1);
00860         <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(M-&gt;p[2*i+1][d+1],min[i+1],size[i]);
00861         <a class="code" href="arithmetique_8h.html#a49">value_sub_int</a>(M-&gt;p[2*i+1][d+1],M-&gt;p[2*i+1][d+1],1);
00862     }
00863   
00864 <font class="preprocessor">#ifdef EDEBUG6</font>
00865 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"PolyhedronPreprocess: constraints H = "</font>);
00866     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,M);
00867 <font class="preprocessor">#endif</font>
00868 <font class="preprocessor"></font>  
00869     H = <a class="code" href="polyhedron_8c.html#a24">Constraints2Polyhedron</a>(M,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
00870   
00871 <font class="preprocessor">#ifdef EDEBUG6</font>
00872 <font class="preprocessor"></font>    <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,H);
00873     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00874 <font class="preprocessor">#endif</font>
00875 <font class="preprocessor"></font>  
00876     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(M);
00877     <font class="keywordflow">for</font>(i=0;i&lt;=(d+1);i++)
00878         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(min[i]);
00879     free(min);
00880     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00881     <font class="keywordflow">return</font>(H);
00882 } <font class="comment">/* Polyhedron_Preprocess */</font>
00883 <font class="comment"></font>
00884 <font class="comment">/** This procedure finds an hypercube of size 'size', containing</font>
00885 <font class="comment">polyhedron D increases size and lcm if necessary (and not "too big")</font>
00886 <font class="comment">If this is not possible, an empty polyhedron is returned</font>
00887 <font class="comment"></font>
00888 <font class="comment">&lt;p&gt;</font>
00889 <font class="comment"></font>
00890 <font class="comment">&lt;pre&gt; written by vin100, 2001, for version 4.19&lt;/pre&gt;</font>
00891 <font class="comment"></font>
00892 <font class="comment">@param D</font>
00893 <font class="comment">@param size</font>
00894 <font class="comment">@param lcm</font>
00895 <font class="comment">@param MAXRAYS</font>
00896 <font class="comment"></font>
00897 <font class="comment">*/</font>
<a name="l00898"></a><a class="code" href="ehrhart_8c~.html#a21">00898</a> Polyhedron *<a class="code" href="ehrhart_8c~.html#a21">Polyhedron_Preprocess2</a>(Polyhedron *D,Value *size,Value *lcm,<font class="keywordtype">unsigned</font> <a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>)<font class="keyword"> </font>{
00899   
00900     Matrix *c;
00901     Polyhedron *H;
00902     <font class="keywordtype">int</font> i,j,r;
00903     Value <a class="code" href="polyparam_8c.html#a2">n</a>;      <font class="comment">/* smallest/biggest value */</font>
00904     Value s;    <font class="comment">/* size in this dimension */</font>
00905     Value tmp1,tmp2;
00906 
00907 <font class="preprocessor">#ifdef EDEBUG62</font>
00908 <font class="preprocessor"></font>    <font class="keywordtype">int</font> np;
00909 <font class="preprocessor">#endif</font>
00910 <font class="preprocessor"></font>
00911     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(<a class="code" href="polyparam_8c.html#a2">n</a>); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(s);
00912     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp1); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp2);
00913     c = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(D-&gt;Dimension*2,D-&gt;Dimension+2);
00914   
00915 <font class="preprocessor">#ifdef EDEBUG62</font>
00916 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"\nPreProcess2 : starting\n"</font>);
00917     fprintf(stderr,<font class="stringliteral">"lcm = "</font>);
00918     <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
00919         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm[np]);
00920     fprintf(stderr,<font class="stringliteral">", size = "</font>);
00921     <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
00922         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,size[np]);
00923     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00924 <font class="preprocessor">#endif</font>
00925 <font class="preprocessor"></font>  
00926     <font class="keywordflow">for</font>(i=0;i&lt;D-&gt;Dimension;i++) {
00927     
00928         <font class="comment">/* Create constraint 1 0..0 1 0..0 -min */</font>
00929         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i][0],1);
00930         <font class="keywordflow">for</font>(j=0;j&lt;D-&gt;Dimension;j++)
00931             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i][1+j],0);
00932         <a class="code" href="arithmetique_8h.html#a51">value_division</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,D-&gt;Ray[0][i+1],D-&gt;Ray[0][D-&gt;Dimension+1]);
00933         <font class="keywordflow">for</font>(r=1;r&lt;D-&gt;NbRays;r++) {
00934             <a class="code" href="arithmetique_8h.html#a51">value_division</a>(tmp1,D-&gt;Ray[r][i+1],D-&gt;Ray[r][D-&gt;Dimension+1]);
00935             <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a24">value_gt</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,tmp1))<font class="keyword"> </font>{
00936         
00937                 <font class="comment">/* New min */</font>
00938                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,D-&gt;Ray[r][i+1],D-&gt;Ray[r][D-&gt;Dimension+1]);
00939             }
00940         }
00941         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i][i+1],1);
00942         <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(c-&gt;p[2*i][D-&gt;Dimension+1],<a class="code" href="polyparam_8c.html#a2">n</a>);
00943     
00944         <font class="comment">/* Create constraint 1 0..0 -1 0..0 max */</font>
00945         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i+1][0],1);
00946         <font class="keywordflow">for</font>(j=0;j&lt;D-&gt;Dimension;j++)
00947             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i+1][1+j],0);
00948     
00949         <font class="comment">/* n = (num+den-1)/den */</font>
00950         <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp1,D-&gt;Ray[0][i+1],D-&gt;Ray[0][D-&gt;Dimension+1]);
00951         <a class="code" href="arithmetique_8h.html#a49">value_sub_int</a>(tmp1,tmp1,1);
00952         <a class="code" href="arithmetique_8h.html#a51">value_division</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,tmp1,D-&gt;Ray[0][D-&gt;Dimension+1]);
00953         <font class="keywordflow">for</font>(r=1;r&lt;D-&gt;NbRays;r++) {
00954             <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp1,D-&gt;Ray[r][i+1],D-&gt;Ray[r][D-&gt;Dimension+1]);
00955             <a class="code" href="arithmetique_8h.html#a49">value_sub_int</a>(tmp1,tmp1,1);
00956             <a class="code" href="arithmetique_8h.html#a51">value_division</a>(tmp1,tmp1,D-&gt;Ray[r][D-&gt;Dimension+1]);
00957             <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,tmp1))<font class="keyword"> </font>{
00958         
00959                 <font class="comment">/* New max */</font>
00960                 <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp1,D-&gt;Ray[r][i+1],D-&gt;Ray[r][D-&gt;Dimension+1]);
00961                 <a class="code" href="arithmetique_8h.html#a49">value_sub_int</a>(tmp1,tmp1,1);
00962                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,tmp1,D-&gt;Ray[r][D-&gt;Dimension+1]);
00963             }
00964         }
00965         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i+1][i+1],-1);
00966         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(c-&gt;p[2*i+1][D-&gt;Dimension+1],<a class="code" href="polyparam_8c.html#a2">n</a>);
00967         <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(s,c-&gt;p[2*i+1][D-&gt;Dimension+1],c-&gt;p[2*i][D-&gt;Dimension+1]);
00968     
00969         <font class="comment">/* Now test if the dimension of the cube is greater than the size */</font>
00970         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a24">value_gt</a>(s,size[i]))<font class="keyword"> </font>{
00971       
00972 <font class="preprocessor">#ifdef EDEBUG62</font>
00973 <font class="preprocessor"></font>            fprintf(stderr,<font class="stringliteral">"size on dimension %d\n"</font>,i);
00974             fprintf(stderr,<font class="stringliteral">"lcm = "</font>);
00975             <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
00976                 <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm[np]);
00977             fprintf(stderr,<font class="stringliteral">", size = "</font>);
00978             <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
00979                 <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,size[np]);
00980             fprintf(stderr,<font class="stringliteral">"\n"</font>);
00981             fprintf(stderr,<font class="stringliteral">"required size (s) = "</font>);
00982             <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,s);
00983             fprintf(stderr,<font class="stringliteral">"\n"</font>);
00984 <font class="preprocessor">#endif</font>
00985 <font class="preprocessor"></font>      
00986             <font class="comment">/* If the needed size is "small enough"(&lt;=20 or less than twice *size) */</font>
00987             <font class="comment">/* then increase *size, and artificially increase lcm too !*/</font>
00988             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(tmp1,20);
00989             <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp2,size[i],size[i]);
00990             <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a27">value_le</a>(s,tmp1)
00991                     || <a class="code" href="arithmetique_8h.html#a27">value_le</a>(s,tmp2))<font class="keyword"> </font>{
00992 
00993                 <font class="keywordflow">if</font>( <a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(lcm[i]) )
00994                     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(lcm[i],1);
00995                 <font class="comment">/* lcm divides size... */</font>
00996                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(tmp1,size[i],lcm[i]);
00997         
00998                 <font class="comment">/* lcm = ceil(s/h) */</font>
00999                 <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp2,s,tmp1);
01000                 <a class="code" href="arithmetique_8h.html#a44">value_add_int</a>(tmp2,tmp2,1);
01001                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(lcm[i],tmp2,tmp1);
01002         
01003                 <font class="comment">/* new size = lcm*h */</font>
01004                 <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(size[i],lcm[i],tmp1);
01005         
01006 <font class="preprocessor">#ifdef EDEBUG62</font>
01007 <font class="preprocessor"></font>                fprintf(stderr,<font class="stringliteral">"new size = "</font>);
01008                 <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
01009                     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,size[np]);
01010                 fprintf(stderr,<font class="stringliteral">", new lcm = "</font>);
01011                 <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
01012                     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm[np]);
01013                 fprintf(stderr,<font class="stringliteral">"\n"</font>);
01014 <font class="preprocessor">#endif</font>
01015 <font class="preprocessor"></font>
01016             }
01017             <font class="keywordflow">else</font> {
01018         
01019 <font class="preprocessor">#ifdef EDEBUG62</font>
01020 <font class="preprocessor"></font>                fprintf(stderr,<font class="stringliteral">"Failed on dimension %d.\n"</font>,i);
01021 <font class="preprocessor">#endif</font>
01022 <font class="preprocessor"></font>                <font class="keywordflow">break</font>;
01023             }
01024         }
01025     }
01026     <font class="keywordflow">if</font>(i!=D-&gt;Dimension) {
01027         <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(c);
01028         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(<a class="code" href="polyparam_8c.html#a2">n</a>); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(s);
01029         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp2);
01030         <font class="keywordflow">return</font>(NULL);
01031     }
01032     <font class="keywordflow">for</font>(i=0;i&lt;D-&gt;Dimension;i++) {
01033         <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(c-&gt;p[2*i+1][D-&gt;Dimension+1],size[i], 
01034                 c-&gt;p[2*i][D-&gt;Dimension+1]);
01035     }
01036   
01037 <font class="preprocessor">#ifdef EDEBUG62</font>
01038 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"PreProcess2 : c ="</font>);
01039     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,c);
01040 <font class="preprocessor">#endif</font>
01041 <font class="preprocessor"></font>
01042     H = <a class="code" href="polyhedron_8c.html#a24">Constraints2Polyhedron</a>(c,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01043     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(c);
01044     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(<a class="code" href="polyparam_8c.html#a2">n</a>); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(s);
01045     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp2);
01046     <font class="keywordflow">return</font>(H);
01047 } <font class="comment">/* Polyhedron_Preprocess2 */</font>
01048 <font class="comment"></font>
01049 <font class="comment">/**  </font>
01050 <font class="comment"></font>
01051 <font class="comment">This procedure adds additional constraints to D so that as each</font>
01052 <font class="comment">parameter is scanned, it will have a minimum of 'size' points If this</font>
01053 <font class="comment">is not possible, an empty polyhedron is returned</font>
01054 <font class="comment"></font>
01055 <font class="comment">@param D</font>
01056 <font class="comment">@param size</font>
01057 <font class="comment">@param MAXRAYS</font>
01058 <font class="comment"></font>
01059 <font class="comment">*/</font>
<a name="l01060"></a><a class="code" href="ehrhart_8c~.html#a22">01060</a> Polyhedron *<a class="code" href="ehrhart_8c~.html#a22">old_Polyhedron_Preprocess</a>(Polyhedron *D,Value size,<font class="keywordtype">unsigned</font> <a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>)<font class="keyword"> </font>{
01061   
01062     <font class="keywordtype">int</font> p, p1, ub, lb;
01063     Value a, a1, b, b1, g, aa;
01064     Value abs_a, abs_b, size_copy;
01065     <font class="keywordtype">int</font> dim, con, <font class="keyword">new</font>, needed;
01066     Value **C;
01067     Matrix *M;
01068     Polyhedron *D1;
01069   
01070     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(a); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(a1); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(b);
01071     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(b1); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(g); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(aa);
01072     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(abs_a); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(abs_b); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(size_copy);
01073   
01074     dim = D-&gt;Dimension;
01075     con = D-&gt;NbConstraints;
01076     M = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>,dim+2);
01077     <font class="keyword">new</font> = 0;
01078     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(size_copy,size);
01079     C = D-&gt;Constraint;
01080     <font class="keywordflow">for</font> (p=1; p&lt;=dim; p++) {
01081         <font class="keywordflow">for</font> (ub=0; ub&lt;con; ub++) {
01082             <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(a,C[ub][p]);
01083             <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a65">value_posz_p</a>(a))        <font class="comment">/* a &gt;= 0 */</font>
01084                 <font class="keywordflow">continue</font>;               <font class="comment">/* not an upper bound */</font>
01085             <font class="keywordflow">for</font> (lb=0;lb&lt;con;lb++) {
01086                 <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(b,C[lb][p]);
01087                 <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a66">value_negz_p</a>(b))
01088                     <font class="keywordflow">continue</font>;   <font class="comment">/* not a lower bound */</font>
01089         
01090                 <font class="comment">/* Check if a new constraint is needed for this (ub,lb) pair */</font>
01091                 <font class="comment">/* a constraint is only needed if a previously scanned */</font>
01092                 <font class="comment">/* parameter (1..p-1) constrains this parameter (p) */</font>
01093                 needed=0;
01094                 <font class="keywordflow">for</font> (p1=1; p1&lt;p; p1++) {
01095                     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(C[ub][p1]) || <a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(C[lb][p1]))<font class="keyword"> </font>{
01096                         needed=1; 
01097                         <font class="keywordflow">break</font>;
01098                     }
01099                 }
01100                 <font class="keywordflow">if</font> (!needed) <font class="keywordflow">continue</font>;  
01101                 <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(abs_a,a);
01102                 <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(abs_b,b);
01103 
01104                 <font class="comment">/* Create new constraint: b*UB-a*LB &gt;= a*b*size */</font>
01105                 <a class="code" href="vector_8c.html#a3">Gcd</a>(abs_a,abs_b,&amp;g);
01106                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(a1,a,g);
01107                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(b1,b,g);
01108                 <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[<font class="keyword">new</font>][0],1);
01109                 <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(abs_a,a1);           <font class="comment">/* abs_a = -a1 */</font>
01110                 <a class="code" href="vector_8c.html#a20">Vector_Combine</a>(&amp;(C[ub][1]),&amp;(C[lb][1]),&amp;(M-&gt;p[<font class="keyword">new</font>][1]),
01111                         b1,abs_a,dim+1);
01112                 <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(aa,a1,b1);
01113                 <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(abs_a,aa,size_copy);
01114                 <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(M-&gt;p[<font class="keyword">new</font>][dim+1],M-&gt;p[<font class="keyword">new</font>][dim+1],abs_a);
01115                 <a class="code" href="vector_8c.html#a25">Vector_Normalize</a>(&amp;(M-&gt;p[<font class="keyword">new</font>][1]),(dim+1));
01116                 <font class="keyword">new</font>++;
01117             }
01118         }
01119     }
01120     D1 = <a class="code" href="polyhedron_8c.html#a28">AddConstraints</a>(M-&gt;p_Init,<font class="keyword">new</font>,D,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01121     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(M);
01122   
01123     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(a); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(a1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(b);
01124     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(b1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(aa);
01125     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(abs_a); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(abs_b); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(size_copy);
01126     <font class="keywordflow">return</font> D1;
01127 } <font class="comment">/* old_Polyhedron_Preprocess */</font>
01128 <font class="comment"></font>
01129 <font class="comment">/** </font>
01130 <font class="comment"></font>
01131 <font class="comment">PROCEDURES TO COMPUTE ENUMERATION. recursive procedure, recurse for</font>
01132 <font class="comment">each imbriquation</font>
01133 <font class="comment"></font>
01134 <font class="comment">@param pos index position of current loop index (1..hdim-1)</font>
01135 <font class="comment">@param P loop domain</font>
01136 <font class="comment">@param context context values for fixed indices </font>
01137 <font class="comment">@return the number of integer points in this</font>
01138 <font class="comment">polyhedron </font>
01139 <font class="comment"></font>
01140 <font class="comment">*/</font>
<a name="l01141"></a><a class="code" href="ehrhart_8c~.html#a23">01141</a> <font class="keywordtype">int</font> <a class="code" href="ehrhart_8c~.html#a23">count_points</a> (<font class="keywordtype">int</font> pos,Polyhedron *P,Value *context)<font class="keyword"> </font>{
01142    
01143     Value LB, UB, k;
01144     <font class="keywordtype">int</font> CNT,result;
01145 
01146     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(LB); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(UB); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(k);
01147     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(LB,0);
01148     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(UB,0);
01149 
01150     <font class="keywordflow">if</font> (<a class="code" href="polyhedron_8c.html#a49">lower_upper_bounds</a>(pos,P,context,&amp;LB,&amp;UB) !=0)<font class="keyword"> </font>{
01151     
01152         <font class="comment">/* Problem if UB or LB is INFINITY */</font>
01153         fprintf(stderr, <font class="stringliteral">"count_points: ? infinite domain\n"</font>);
01154         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(LB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(UB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k);
01155         <font class="keywordflow">return</font> -1;
01156     }
01157   
01158 <font class="preprocessor">#ifdef EDEBUG1</font>
01159 <font class="preprocessor"></font>    <font class="keywordflow">if</font> (!P-&gt;next) {
01160         <font class="keywordtype">int</font> i;
01161         <font class="keywordflow">for</font> (<a class="code" href="arithmetique_8h.html#a11">value_assign</a>(k,LB); <a class="code" href="arithmetique_8h.html#a27">value_le</a>(k,UB); <a class="code" href="arithmetique_8h.html#a45">value_increment</a>(k,k))<font class="keyword"> </font>{
01162             fprintf(stderr, <font class="stringliteral">"("</font>);
01163             <font class="keywordflow">for</font> (i=1; i&lt;pos; i++) {
01164                 <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,context[i]);
01165                 fprintf(stderr,<font class="stringliteral">","</font>);
01166             }
01167             <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,k);
01168             fprintf(stderr,<font class="stringliteral">")\n"</font>);
01169         }
01170     }
01171 <font class="preprocessor">#endif</font>
01172 <font class="preprocessor"></font>  
01173     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(context[pos],0);
01174     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(UB,LB))<font class="keyword"> </font>{
01175         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(LB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(UB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k);
01176         <font class="keywordflow">return</font> 0;  
01177     }  
01178     <font class="keywordflow">if</font> (!P-&gt;next) {
01179         <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(k,UB,LB);
01180         <a class="code" href="arithmetique_8h.html#a44">value_add_int</a>(k,k,1);
01181         result = <a class="code" href="arithmetique_8h.html#a7">VALUE_TO_INT</a>(k);
01182         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(LB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(UB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k);
01183         <font class="keywordflow">return</font> (result);
01184     } 
01185 
01186     <font class="comment">/*-----------------------------------------------------------------*/</font>
01187     <font class="comment">/* Optimization idea                                               */</font>
01188     <font class="comment">/*   If inner loops are not a function of k (the current index)    */</font>
01189     <font class="comment">/*   i.e. if P-&gt;Constraint[i][pos]==0 for all P following this and */</font>
01190     <font class="comment">/*        for all i,                                               */</font>
01191     <font class="comment">/*   Then CNT = (UB-LB+1)*count_points(pos+1, P-&gt;next, context)    */</font>
01192     <font class="comment">/*   (skip the for loop)                                           */</font>
01193     <font class="comment">/*-----------------------------------------------------------------*/</font>
01194   
01195     CNT = 0;
01196     <font class="keywordflow">for</font> (<a class="code" href="arithmetique_8h.html#a11">value_assign</a>(k,LB);<a class="code" href="arithmetique_8h.html#a27">value_le</a>(k,UB);<a class="code" href="arithmetique_8h.html#a45">value_increment</a>(k,k))<font class="keyword"> </font>{
01197         <font class="keywordtype">int</font> c;
01198     
01199         <font class="comment">/* Insert k in context */</font>
01200         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(context[pos],k);
01201         c = <a class="code" href="ehrhart_8c~.html#a23">count_points</a>(pos+1,P-&gt;next,context);
01202         <font class="keywordflow">if</font>(c!=-1)
01203             CNT = CNT + c;
01204         <font class="keywordflow">else</font> {
01205             CNT=0;
01206             <font class="keywordflow">break</font>;
01207         }
01208     }
01209   
01210 <font class="preprocessor">#ifdef EDEBUG11</font>
01211 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"%d\n"</font>,CNT);
01212 <font class="preprocessor">#endif</font>
01213 <font class="preprocessor"></font>  
01214     <font class="comment">/* Reset context */</font>
01215     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(context[pos],0);
01216     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(LB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(UB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k);
01217     <font class="keywordflow">return</font> CNT;
01218 } <font class="comment">/* count_points */</font>
01219 
01220 <font class="comment">/*------------------------------------------------------------*/</font>
01221 <font class="comment">/* enode *P_Enum(L, LQ, context, pos, nb_param, dim, lcm)     */</font>
01222 <font class="comment">/*     L : list of polyhedra for the loop nest                */</font>
01223 <font class="comment">/*     LQ : list of polyhedra for the parameter loop nest     */</font>
01224 <font class="comment">/*     pos : 1..nb_param, position of the parameter           */</font>
01225 <font class="comment">/*     nb_param : number of parameters total                  */</font>
01226 <font class="comment">/*     dim : total dimension of the polyhedron, param incl.   */</font>
01227 <font class="comment">/*     lcm : denominator array [0..dim-1] of the polyhedron   */</font>
01228 <font class="comment">/* Returns an enode tree representing the pseudo polynomial   */</font>
01229 <font class="comment">/*   expression for the enumeration of the polyhedron.        */</font>
01230 <font class="comment">/* A recursive procedure.                                     */</font>
01231 <font class="comment">/*------------------------------------------------------------*/</font>
<a name="l01232"></a><a class="code" href="ehrhart_8c~.html#a24">01232</a> <font class="keyword">static</font> enode *<a class="code" href="ehrhart_8c~.html#a24">P_Enum</a>(Polyhedron *L,Polyhedron *LQ,Value *context,<font class="keywordtype">int</font> pos,<font class="keywordtype">int</font> nb_param,<font class="keywordtype">int</font> dim,Value *lcm)<font class="keyword"> </font>{
01233 
01234   enode *res,*B,*C;
01235   <font class="keywordtype">int</font> hdim,i,j,rank,flag;
01236   Value <a class="code" href="polyparam_8c.html#a2">n</a>,g,nLB,nUB,nlcm,noff,nexp,k1,nm,hdv,k,lcm_copy;
01237   Value tmp;
01238   Matrix *A;
01239 
01240 <font class="preprocessor">#ifdef EDEBUG</font>
01241 <font class="preprocessor"></font>  fprintf(stderr,<font class="stringliteral">"-------------------- begin P_Enum -------------------\n"</font>);
01242   fprintf(stderr,<font class="stringliteral">"Calling P_Enum with pos = %d\n"</font>,pos);
01243 <font class="preprocessor">#endif</font>
01244 <font class="preprocessor"></font>  
01245   <font class="comment">/* Xavier Redon modification: handle the case when there is no parameter */</font>
01246   <font class="keywordflow">if</font>(nb_param==0) {
01247     res=<a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(polynomial,1,0);
01248     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;arr[0].d,1);
01249     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;arr[0].x.n,(count_points(1,L,context)));
01250     <font class="keywordflow">return</font> res;
01251   }
01252   
01253   <font class="comment">/* Initialize all the 'Value' variables */</font>
01254   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(<a class="code" href="polyparam_8c.html#a2">n</a>); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(g); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(nLB);
01255   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(nUB); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(nlcm); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(noff);
01256   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(nexp); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(k1); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(nm);
01257   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(hdv); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(k); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
01258   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(lcm_copy);
01259 
01260   <font class="keywordflow">if</font>( <a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(lcm[pos-1]) )<font class="keyword"></font>
01261 <font class="keyword">  </font>{
01262                 hdim = 1;
01263                 <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>( lcm_copy, 1 );
01264   }
01265   <font class="keywordflow">else</font>
01266   {
01267           <font class="comment">/* hdim is the degree of the polynomial + 1 */</font>
01268                 hdim = dim-nb_param+1;          <font class="comment">/* homogenous dim w/o parameters */</font>
01269                 <a class="code" href="arithmetique_8h.html#a11">value_assign</a>( lcm_copy, lcm[pos-1] );
01270   }  
01271 
01272   <font class="comment">/* code to limit generation of equations to valid parameters only */</font>
01273   <font class="comment">/*----------------------------------------------------------------*/</font>
01274   flag = <a class="code" href="polyhedron_8c.html#a49">lower_upper_bounds</a>(pos,LQ,&amp;context[dim-nb_param],&amp;nLB,&amp;nUB);
01275   <font class="keywordflow">if</font> (flag &amp; LB_INFINITY) {
01276     <font class="keywordflow">if</font> (!(flag &amp; UB_INFINITY)) {
01277       
01278       <font class="comment">/* Only an upper limit: set lower limit */</font>
01279       <font class="comment">/* Compute nLB such that (nUB-nLB+1) &gt;= (hdim*lcm) */</font>
01280       <a class="code" href="arithmetique_8h.html#a49">value_sub_int</a>(nLB,nUB,1);
01281       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(hdv,hdim);
01282       <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(tmp,hdv,lcm_copy);
01283       <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(nLB,nLB,tmp);
01284       <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a63">value_pos_p</a>(nLB))
01285         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(nLB,0);
01286     }
01287     <font class="keywordflow">else</font> {
01288       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(nLB,0);
01289       
01290       <font class="comment">/* No upper nor lower limit: set lower limit to 0 */</font>
01291       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(hdv,hdim);
01292       <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(nUB,hdv,lcm_copy);
01293       <a class="code" href="arithmetique_8h.html#a44">value_add_int</a>(nUB,nUB,1);
01294     }
01295   }
01296 
01297   <font class="comment">/* if (nUB-nLB+1) &lt; (hdim*lcm) then we have more unknowns than equations */</font>
01298   <font class="comment">/* We can: 1. Find more equations by changing the context parameters, or */</font>
01299   <font class="comment">/* 2. Assign extra unknowns values in such a way as to simplify result.  */</font>
01300   <font class="comment">/* Think about ways to scan parameter space to get as much info out of it*/</font>
01301   <font class="comment">/* as possible.                                                          */</font>
01302   
01303 <font class="preprocessor">#ifdef REDUCE_DEGREE</font>
01304 <font class="preprocessor"></font>  <font class="keywordflow">if</font> (pos==1 &amp;&amp; (flag &amp; UB_INFINITY)==0) {
01305     <font class="comment">/* only for finite upper bound on first parameter */</font>
01306     <font class="comment">/* NOTE: only first parameter because subsequent parameters may</font>
01307 <font class="comment">       be artificially limited by the choice of the first parameter */</font>
01308    
01309 <font class="preprocessor">#ifdef EDEBUG</font>
01310 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"*************** n **********\n"</font>);
01311     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01312     fprintf(stderr,<font class="stringliteral">"\n"</font>);
01313 <font class="preprocessor">#endif</font>
01314 <font class="preprocessor"></font>
01315     <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,nUB,nLB);
01316     <a class="code" href="arithmetique_8h.html#a45">value_increment</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01317     
01318 <font class="preprocessor">#ifdef EDEBUG </font>
01319 <font class="preprocessor"></font>    <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01320     fprintf(stderr,<font class="stringliteral">"\n*************** n ************\n"</font>);
01321 <font class="preprocessor">#endif </font>
01322 <font class="preprocessor"></font>
01323     <font class="comment">/* Total number of samples&gt;0 */</font>
01324     <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(<a class="code" href="polyparam_8c.html#a2">n</a>))
01325       i=0;
01326     <font class="keywordflow">else</font> {
01327       <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(tmp,<a class="code" href="polyparam_8c.html#a2">n</a>,lcm_copy);
01328       <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(tmp))<font class="keyword"> </font>{
01329                   <a class="code" href="arithmetique_8h.html#a51">value_division</a>(tmp,<a class="code" href="polyparam_8c.html#a2">n</a>,lcm_copy);
01330                   <a class="code" href="arithmetique_8h.html#a45">value_increment</a>(tmp,tmp);
01331                   i = <a class="code" href="arithmetique_8h.html#a7">VALUE_TO_INT</a>(tmp);
01332       }
01333       <font class="keywordflow">else</font> {
01334                   <a class="code" href="arithmetique_8h.html#a51">value_division</a>(tmp,<a class="code" href="polyparam_8c.html#a2">n</a>,lcm_copy);
01335                   i =   <a class="code" href="arithmetique_8h.html#a7">VALUE_TO_INT</a>(tmp);      <font class="comment">/* ceiling of n/lcm */</font>
01336       }
01337     }
01338 
01339 <font class="preprocessor">#ifdef EDEBUG </font>
01340 <font class="preprocessor"></font>    <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01341     fprintf(stderr,<font class="stringliteral">"\n*************** n ************\n"</font>);
01342 <font class="preprocessor">#endif </font>
01343 <font class="preprocessor"></font>    
01344     <font class="comment">/* Reduce degree of polynomial based on number of sample points */</font>
01345     <font class="keywordflow">if</font> (i &lt; hdim){
01346       hdim=i;
01347       
01348 <font class="preprocessor">#ifdef EDEBUG4</font>
01349 <font class="preprocessor"></font>      fprintf(stdout,<font class="stringliteral">"Parameter #%d: LB="</font>,pos);
01350       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,nLB);
01351       fprintf(stdout,<font class="stringliteral">" UB="</font>);
01352       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,nUB);
01353       fprintf(stdout,<font class="stringliteral">" lcm="</font>);
01354       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm_copy);
01355       fprintf(stdout,<font class="stringliteral">" degree reduced to %d\n"</font>,hdim-1);
01356 <font class="preprocessor">#endif</font>
01357 <font class="preprocessor"></font>      
01358     }
01359   }
01360 <font class="preprocessor">#endif </font><font class="comment">/* REDUCE_DEGREE */</font>
01361   
01362   <font class="comment">/* hdim is now set */</font>  
01363   <font class="comment">/* allocate result structure */</font>
01364   res = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(polynomial,hdim,pos);
01365   <font class="keywordflow">for</font> (i=0;i&lt;hdim;i++) {
01366     <font class="keywordtype">int</font> l;
01367     l = <a class="code" href="arithmetique_8h.html#a7">VALUE_TO_INT</a>(lcm_copy);
01368     res-&gt;arr[i].x.p = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(periodic,l,pos);
01369   }
01370   
01371   <font class="comment">/* Utility arrays */</font>
01372   A = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(hdim, 2*hdim+1);                     <font class="comment">/* used for Gauss */</font>
01373   B = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(evector, hdim, 0);
01374   C = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(evector, hdim, 0);
01375   
01376   <font class="comment">/*----------------------------------------------------------------*/</font>
01377   <font class="comment">/*                                                                */</font>
01378   <font class="comment">/*                                0&lt;-----+---k---------&gt;          */</font>
01379   <font class="comment">/* |---------noff-----------------&gt;-nlcm-&gt;-------lcm----&gt;         */</font>
01380   <font class="comment">/* |--- . . . -----|--------------|------+-------|------+-------|-*/</font>
01381   <font class="comment">/* 0          (q-1)*lcm         q*lcm    |  (q+1)*lcm   |         */</font>
01382   <font class="comment">/*                                      nLB          nLB+lcm      */</font>
01383   <font class="comment">/*                                                                */</font>
01384   <font class="comment">/*----------------------------------------------------------------*/</font>
01385   <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(nLB))<font class="keyword"> </font>{
01386     <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(nlcm,nLB,lcm_copy);
01387     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(nlcm,nlcm,lcm_copy);
01388   }
01389   <font class="keywordflow">else</font> {
01390     <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(nlcm,nLB,lcm_copy);
01391   }
01392   
01393   <font class="comment">/* noff is a multiple of lcm */</font>
01394   <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(noff,nLB,nlcm);
01395   <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp,lcm_copy,nlcm);
01396   <font class="keywordflow">for</font> (<a class="code" href="arithmetique_8h.html#a11">value_assign</a>(k,nlcm);<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(k,tmp);<a class="code" href="arithmetique_8h.html#a45">value_increment</a>(k,k))<font class="keyword"> </font>{
01397  
01398 <font class="preprocessor">#ifdef EDEBUG</font>
01399 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"Finding "</font>);
01400     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,k);
01401     fprintf(stderr,<font class="stringliteral">"-th elements of periodic coefficients\n"</font>);
01402 <font class="preprocessor">#endif</font>
01403 <font class="preprocessor"></font>
01404     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(hdv,hdim);
01405     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(nm,hdv,lcm_copy);
01406     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(nm,nm,nLB);
01407     i=0;
01408     <font class="keywordflow">for</font> (<a class="code" href="arithmetique_8h.html#a43">value_addto</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,k,noff); <a class="code" href="arithmetique_8h.html#a26">value_lt</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,nm); <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>,lcm_copy),i++)<font class="keyword"> </font>{
01409       
01410       <font class="comment">/* n == i*lcm + k + noff;   */</font>
01411       <font class="comment">/* nlcm &lt;= k &lt; nlcm+lcm     */</font>
01412       <font class="comment">/* n mod lcm == k1 */</font>
01413       
01414 <font class="preprocessor">#ifdef ALL_OVERFLOW_WARNINGS</font>
01415 <font class="preprocessor"></font>      <font class="keywordflow">if</font> (((flag &amp; UB_INFINITY)==0) &amp;&amp; <a class="code" href="arithmetique_8h.html#a24">value_gt</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,nUB))<font class="keyword"> </font>{
01416         fprintf(stdout,<font class="stringliteral">"Domain Overflow: Parameter #%d:"</font>,pos);
01417         fprintf(stdout,<font class="stringliteral">"nLB="</font>);
01418         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,nLB);
01419         fprintf(stdout,<font class="stringliteral">" n="</font>);
01420         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01421         fprintf(stdout,<font class="stringliteral">" nUB="</font>);
01422         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,nUB);
01423         fprintf(stdout,<font class="stringliteral">"\n"</font>);
01424       }
01425 <font class="preprocessor">#else</font>
01426 <font class="preprocessor"></font>      <font class="keywordflow">if</font> (overflow_warning_flag &amp;&amp; ((flag &amp; UB_INFINITY)==0) &amp;&amp;
01427           <a class="code" href="arithmetique_8h.html#a24">value_gt</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,nUB))<font class="keyword"> </font>{
01428         fprintf(stdout,<font class="stringliteral">"\nWARNING: Parameter Domain Overflow."</font>);
01429         fprintf(stdout,<font class="stringliteral">" Result may be incorrect on this domain.\n"</font>);
01430         overflow_warning_flag = 0;
01431       }
01432 <font class="preprocessor">#endif</font>
01433 <font class="preprocessor"></font>      
01434       <font class="comment">/* Set parameter to n */</font>
01435       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(context[dim-nb_param+pos],<a class="code" href="polyparam_8c.html#a2">n</a>);
01436       
01437 <font class="preprocessor">#ifdef EDEBUG1</font>
01438 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01439 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"%s = "</font>,param_name[pos-1]);
01440       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01441       fprintf(stderr,<font class="stringliteral">" (hdim=%d, lcm[%d]="</font>,hdim,pos-1);
01442       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm_copy);
01443       fprintf(stderr,<font class="stringliteral">")\n"</font>);
01444 <font class="preprocessor">#else</font>
01445 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"P%d = "</font>,pos);
01446       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01447       fprintf(stderr,<font class="stringliteral">" (hdim=%d, lcm[%d]="</font>,hdim,pos-1);
01448       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm_copy);
01449       fprintf(stderr,<font class="stringliteral">")\n"</font>);      
01450 <font class="preprocessor">#endif</font>
01451 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
01452 <font class="preprocessor"></font>      
01453       <font class="comment">/* Setup B vector */</font>
01454       <font class="keywordflow">if</font> (pos==nb_param) {
01455         
01456 <font class="preprocessor">#ifdef EDEBUG   </font>
01457 <font class="preprocessor"></font>        fprintf(stderr,<font class="stringliteral">"Yes\n"</font>);
01458 <font class="preprocessor">#endif </font>
01459 <font class="preprocessor"></font>        
01460         <font class="comment">/* call count */</font>
01461         <font class="comment">/* count can only be called when the context is fully specified */</font>
01462         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(B-&gt;arr[i].d,1);
01463         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(B-&gt;arr[i].x.n,(count_points(1,L,context)));
01464         
01465 <font class="preprocessor">#ifdef EDEBUG3</font>
01466 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (j=1; j&lt;pos; j++) fputs(<font class="stringliteral">"   "</font>,stdout);
01467         fprintf(stdout, <font class="stringliteral">"E("</font>);
01468         <font class="keywordflow">for</font> (j=1; j&lt;nb_param; j++) {
01469           <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,context[dim-nb_param+j]);
01470           fprintf(stdout,<font class="stringliteral">","</font>);
01471         }  
01472         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01473         fprintf(stdout,<font class="stringliteral">") = "</font>);
01474         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,B-&gt;arr[i].x.n);
01475         fprintf(stdout,<font class="stringliteral">" ="</font>);
01476 <font class="preprocessor">#endif</font>
01477 <font class="preprocessor"></font>        
01478       }
01479       <font class="keywordflow">else</font> {    <font class="comment">/* count is a function of other parameters */</font>
01480         <font class="comment">/* call P_Enum recursively */</font>
01481         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(B-&gt;arr[i].d,0);
01482         B-&gt;arr[i].x.p = <a class="code" href="ehrhart_8c~.html#a24">P_Enum</a>(L,LQ-&gt;next,context,pos+1,nb_param,dim,lcm);
01483         
01484 <font class="preprocessor">#ifdef EDEBUG3</font>
01485 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01486 <font class="preprocessor"></font>        
01487         <font class="keywordflow">for</font> (j=1; j&lt;pos; j++)
01488           fputs(<font class="stringliteral">"   "</font>, stdout);
01489         fprintf(stdout, <font class="stringliteral">"E("</font>);
01490         <font class="keywordflow">for</font> (j=1; j&lt;=pos; j++) {
01491           <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,context[dim-nb_param+j]);
01492           fprintf(stdout,<font class="stringliteral">","</font>);
01493         }         
01494         <font class="keywordflow">for</font> (j=pos+1; j&lt;nb_param; j++)
01495           fprintf(stdout,<font class="stringliteral">"%s,"</font>,param_name[j]);
01496         fprintf(stdout,<font class="stringliteral">"%s) = "</font>,param_name[j]);
01497         <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(stdout,B-&gt;arr[i].x.p,param_name);
01498         fprintf(stdout,<font class="stringliteral">" ="</font>);
01499 <font class="preprocessor">#endif</font>
01500 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
01501 <font class="preprocessor"></font>        
01502       }
01503       
01504       <font class="comment">/* Create i-th equation*/</font>
01505       <font class="comment">/* K_0 + K_1 * n**1 + ... + K_dim * n**dim | Identity Matrix */</font>
01506       
01507       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(A-&gt;p[i][0],0);  <font class="comment">/* status bit = equality */</font>
01508       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(nexp,1);
01509       <font class="keywordflow">for</font> (j=1;j&lt;=hdim;j++) {
01510         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(A-&gt;p[i][j],nexp);
01511         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(A-&gt;p[i][j+hdim],0);
01512         
01513 <font class="preprocessor">#ifdef EDEBUG3</font>
01514 <font class="preprocessor"></font>        fprintf(stdout,<font class="stringliteral">" + "</font>);
01515         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,nexp);
01516         fprintf(stdout,<font class="stringliteral">" c%d"</font>,j);
01517 <font class="preprocessor">#endif  </font>
01518 <font class="preprocessor"></font>        <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(nexp,nexp,<a class="code" href="polyparam_8c.html#a2">n</a>);
01519       }
01520       
01521 <font class="preprocessor">#ifdef EDEBUG3</font>
01522 <font class="preprocessor"></font>      fprintf(stdout, <font class="stringliteral">"\n"</font>);
01523 <font class="preprocessor">#endif</font>
01524 <font class="preprocessor"></font>      
01525       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(A-&gt;p[i][i+1+hdim],1);      
01526     }
01527     
01528     <font class="comment">/* Assertion check */</font>
01529     <font class="keywordflow">if</font> (i!=hdim)
01530       fprintf(stderr, <font class="stringliteral">"P_Enum: ?expecting i==hdim\n"</font>);
01531     
01532 <font class="preprocessor">#ifdef EDEBUG</font>
01533 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01534 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"B (enode) =\n"</font>);
01535     <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(stderr,B,param_name);
01536 <font class="preprocessor">#endif</font>
01537 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"A (Before Gauss) =\n"</font>);
01538     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,A);
01539 <font class="preprocessor">#endif</font>
01540 <font class="preprocessor"></font>    
01541     <font class="comment">/* Solve hdim (=dim+1) equations with hdim unknowns, result in CNT */</font>
01542     rank = <a class="code" href="polyhedron_8c.html#a15">Gauss</a>(A,hdim,2*hdim);
01543     
01544 <font class="preprocessor">#ifdef EDEBUG</font>
01545 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"A (After Gauss) =\n"</font>);
01546     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,A);
01547 <font class="preprocessor">#endif</font>
01548 <font class="preprocessor"></font>    
01549     <font class="comment">/* Assertion check */</font>
01550     <font class="keywordflow">if</font> (rank!=hdim) {
01551       fprintf(stderr, <font class="stringliteral">"P_Enum: ?expecting rank==hdim\n"</font>);
01552     }
01553     
01554     <font class="comment">/* if (rank &lt; hdim) then set the last hdim-rank coefficients to ? */</font>
01555     <font class="comment">/* if (rank == 0) then set all coefficients to 0 */</font>    
01556     <font class="comment">/* copy result as k1-th element of periodic numbers */</font>
01557     <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(k,lcm_copy))
01558       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(k1,k);
01559     <font class="keywordflow">else</font>
01560       <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(k1,k,lcm_copy);
01561     
01562     <font class="keywordflow">for</font> (i=0; i&lt;rank; i++) {
01563       
01564       <font class="comment">/* Set up coefficient vector C from i-th row of inverted matrix */</font>
01565       <font class="keywordflow">for</font> (j=0; j&lt;rank; j++) {
01566         <a class="code" href="vector_8c.html#a3">Gcd</a>(A-&gt;p[i][i+1],A-&gt;p[i][j+1+hdim],&amp;g);
01567         <a class="code" href="arithmetique_8h.html#a51">value_division</a>(C-&gt;arr[j].d,A-&gt;p[i][i+1],g);
01568         <a class="code" href="arithmetique_8h.html#a51">value_division</a>(C-&gt;arr[j].x.n,A-&gt;p[i][j+1+hdim],g);
01569       }
01570       
01571 <font class="preprocessor">#ifdef EDEBUG</font>
01572 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01573 <font class="preprocessor"></font>      fprintf(stderr, <font class="stringliteral">"C (enode) =\n"</font>);
01574       <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(stderr, C, param_name);
01575 <font class="preprocessor">#endif</font>
01576 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
01577 <font class="preprocessor"></font>      
01578       <font class="comment">/* The i-th enode is the lcm-periodic coefficient of term n**i */</font>
01579       <a class="code" href="ehrhart_8c~.html#a16">edot</a>(B,C,&amp;(res-&gt;arr[i].x.p-&gt;arr[VALUE_TO_INT(k1)]));
01580       
01581 <font class="preprocessor">#ifdef EDEBUG</font>
01582 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01583 <font class="preprocessor"></font>      fprintf(stderr, <font class="stringliteral">"B.C (evalue)=\n"</font>);
01584       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(stderr,&amp;(res-&gt;arr[i].x.p-&gt;arr[VALUE_TO_INT(k1)]),param_name );
01585       fprintf(stderr,<font class="stringliteral">"\n"</font>);
01586 <font class="preprocessor">#endif</font>
01587 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
01588 <font class="preprocessor"></font>      
01589     }
01590     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp,lcm_copy,nlcm);
01591   }
01592   
01593 <font class="preprocessor">#ifdef EDEBUG</font>
01594 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01595 <font class="preprocessor"></font>  fprintf(stderr,<font class="stringliteral">"res (enode) =\n"</font>);
01596   <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(stderr,res,param_name);
01597   
01598 <font class="preprocessor">#endif</font>
01599 <font class="preprocessor"></font>  fprintf(stderr, <font class="stringliteral">"-------------------- end P_Enum -----------------------\n"</font>);
01600 <font class="preprocessor">#endif</font>
01601 <font class="preprocessor"></font>  
01602   <font class="comment">/* Reset context */</font>
01603   <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(context[dim-nb_param+pos],0);
01604   
01605   <font class="comment">/* Release memory */</font>
01606   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(A);
01607   free(B);
01608   free(C);
01609   
01610   <font class="comment">/* Clear all the 'Value' variables */</font>
01611   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(<a class="code" href="polyparam_8c.html#a2">n</a>); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(nLB);
01612   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(nUB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(nlcm); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(noff);
01613   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(nexp); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(nm);
01614   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(hdv); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
01615   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(lcm_copy);
01616   <font class="keywordflow">return</font> res;
01617 } <font class="comment">/* P_Enum */</font>
01618 
01619 <font class="comment">/*----------------------------------------------------------------*/</font>
01620 <font class="comment">/* Scan_Vertices(PP, Q, CT)                                       */</font>
01621 <font class="comment">/*    PP : ParamPolyhedron                                        */</font>
01622 <font class="comment">/*    Q : Domain                                                  */</font>
01623 <font class="comment">/*    CT : Context transformation matrix                          */</font>
01624 <font class="comment">/*----------------------------------------------------------------*/</font>
<a name="l01625"></a><a class="code" href="ehrhart_8c~.html#a25">01625</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a25">Scan_Vertices</a>(Param_Polyhedron *PP,Param_Domain *Q,Matrix *CT,
01626    Value *lcm, <font class="keywordtype">int</font> nbp )<font class="keyword"></font>
01627 <font class="keyword"></font>{
01628   Param_Vertices *V;
01629   <font class="keywordtype">int</font> i, j, ix, l, np;
01630   <font class="keywordtype">unsigned</font> bx;
01631   Value k,m1;
01632 
01633   <font class="comment">/* Compute the denominator of P */</font>
01634   <font class="comment">/* lcm = Least Common Multiple of the denominators of the vertices of P */</font>
01635   <font class="comment">/* and print the vertices */</font>  
01636 
01637   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(k); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(m1);
01638   <font class="keywordflow">for</font>( np=0 ; np&lt;nbp ; np++ )
01639     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>( lcm[np], 0 );
01640 
01641 <font class="preprocessor">#ifdef EPRINT</font>
01642 <font class="preprocessor"></font>  fprintf(stdout,<font class="stringliteral">"Vertices:\n"</font>);
01643 <font class="preprocessor">#endif</font>
01644 <font class="preprocessor"></font>
01645   <font class="keywordflow">for</font>(i=0,ix=0,bx=MSB,V=PP-&gt;V; V &amp;&amp; i&lt;PP-&gt;nbV; i++,V=V-&gt;next) {
01646     <font class="keywordflow">if</font> (Q-&gt;F[ix] &amp; bx) {
01647 <font class="preprocessor">#ifdef EPRINT</font>
01648 <font class="preprocessor"></font>      <font class="keywordflow">if</font>(CT) {
01649         Matrix *v;
01650         v = <a class="code" href="polyparam_8c.html#a38">VertexCT</a>(V-&gt;Vertex,CT);
01651         <a class="code" href="polyparam_8c.html#a37">Print_Vertex</a>(stdout,v,param_name);
01652         <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(v);
01653       }
01654       <font class="keywordflow">else</font>
01655         <a class="code" href="polyparam_8c.html#a37">Print_Vertex</a>(stdout,V-&gt;Vertex,param_name);
01656       fprintf(stdout,<font class="stringliteral">"\n"</font>);
01657 <font class="preprocessor">#endif</font>
01658 <font class="preprocessor"></font>
01659       <font class="keywordflow">for</font>(j=0;j&lt;V-&gt;Vertex-&gt;NbRows;j++) {
01660                         <font class="comment">/* A matrix */</font>
01661                         <font class="keywordflow">for</font>( l=0 ; l&lt;V-&gt;Vertex-&gt;NbColumns-2 ; l++ )
01662                         {
01663                                 <font class="keywordflow">if</font>( <a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(V-&gt;Vertex-&gt;p[j][l]) )<font class="keyword"></font>
01664 <font class="keyword">                                </font>{
01665                                         <a class="code" href="vector_8c.html#a3">Gcd</a>(V-&gt;Vertex-&gt;p[j][V-&gt;Vertex-&gt;NbColumns-1],V-&gt;Vertex-&gt;p[j][l], &amp;m1);
01666                                         <a class="code" href="arithmetique_8h.html#a51">value_division</a>(k,V-&gt;Vertex-&gt;p[j][V-&gt;Vertex-&gt;NbColumns-1],m1);
01667                                         <font class="keywordflow">if</font>( <a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(lcm[l]) )<font class="keyword"></font>
01668 <font class="keyword">                                        </font>{
01669                                                 <font class="comment">/* lcm[l] = lcm[l] * k / gcd(k,lcm[l]) */</font>
01670                                                 <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(k) &amp;&amp; <a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(k))<font class="keyword"></font>
01671 <font class="keyword">                                                </font>{
01672                                                   <a class="code" href="vector_8c.html#a3">Gcd</a>(lcm[l],k,&amp;m1);
01673                                                   <a class="code" href="arithmetique_8h.html#a51">value_division</a>(k,k,m1);
01674                                                   <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(lcm[l],lcm[l],k);
01675                                                 }
01676                                         }
01677                                         <font class="keywordflow">else</font>
01678                                         {
01679                                                 <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(lcm[l],k);
01680                                         }
01681                                 }
01682                         }
01683       }
01684     }
01685     NEXT(ix,bx);
01686   }
01687   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1);
01688 } <font class="comment">/* Scan_Vertices */</font>
01689 <font class="comment"></font>
01690 <font class="comment">/**</font>
01691 <font class="comment"></font>
01692 <font class="comment">Procedure to count points in a non-parameterized polytope.</font>
01693 <font class="comment"></font>
01694 <font class="comment">@param P       Polyhedron to count</font>
01695 <font class="comment">@param C       Parameter Context domain</font>
01696 <font class="comment">@param CT      Matrix to transform context to original</font>
01697 <font class="comment">@parma CEq     additionnal equalities in context</font>
01698 <font class="comment">@param MAXRAYS workspace size</font>
01699 <font class="comment"></font>
01700 <font class="comment">*/</font>
<a name="l01701"></a><a class="code" href="ehrhart_8c~.html#a26">01701</a> Enumeration *<a class="code" href="ehrhart_8c~.html#a26">Enumerate_NoParameters</a>(Polyhedron *P,Polyhedron *C,Matrix *CT,Polyhedron *CEq,<font class="keywordtype">unsigned</font> <a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>)<font class="keyword"> </font>{
01702   
01703     Polyhedron *L;
01704     Enumeration *res;
01705     Value *context,tmp;
01706     <font class="keywordtype">int</font> j;
01707     <font class="keywordtype">int</font> hdim = P-&gt;Dimension + 1;
01708   
01709 <font class="preprocessor">#ifdef EPRINT</font>
01710 <font class="preprocessor"></font>    <font class="keywordtype">int</font> r,i;
01711 <font class="preprocessor">#endif</font>
01712 <font class="preprocessor"></font>  
01713     <font class="comment">/* Create a context vector size dim+2 */</font>
01714     context = (Value *) malloc((hdim+1)*<font class="keyword">sizeof</font>(Value));
01715     <font class="keywordflow">for</font> (j=0;j&lt;= hdim;j++) 
01716         <a class="code" href="arithmetique_8h.html#a10">value_init</a>(context[j]);
01717     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
01718   
01719     res = (Enumeration *)malloc(<font class="keyword">sizeof</font>(Enumeration));
01720     res-&gt;next = NULL;
01721     res-&gt;ValidityDomain = <a class="code" href="polyhedron_8c.html#a23">Universe_Polyhedron</a>(0);  <font class="comment">/* no parameters */</font>
01722     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;EP.d);
01723     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;EP.d,0);  
01724     L = <a class="code" href="polyhedron_8c.html#a48">Polyhedron_Scan</a>(P,res-&gt;ValidityDomain,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01725   
01726 <font class="preprocessor">#ifdef EDEBUG2</font>
01727 <font class="preprocessor"></font>    fprintf(stderr, <font class="stringliteral">"L = \n"</font>);
01728     <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr, P_VALUE_FMT, L);
01729 <font class="preprocessor">#endif</font>
01730 <font class="preprocessor"></font>  
01731     <font class="keywordflow">if</font>(CT) {
01732         Polyhedron *Dt;
01733     
01734         <font class="comment">/* Add parameters to validity domain */</font>
01735         Dt = <a class="code" href="polyhedron_8c.html#a50">Polyhedron_Preimage</a>(res-&gt;ValidityDomain,CT,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01736         <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(res-&gt;ValidityDomain);
01737         res-&gt;ValidityDomain = <a class="code" href="polyhedron_8c.html#a32">DomainIntersection</a>(Dt,CEq,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01738         <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(Dt);
01739     }
01740   
01741 <font class="preprocessor">#ifdef EPRINT </font>
01742 <font class="preprocessor"></font>    fprintf(stdout,<font class="stringliteral">"---------------------------------------\n"</font>);
01743     fprintf(stdout,<font class="stringliteral">"Domain:\n"</font>);
01744     <a class="code" href="polyparam_8c.html#a39">Print_Domain</a>(stdout,res-&gt;ValidityDomain, param_name);
01745   
01746     <font class="comment">/* Print the vertices */</font>
01747     printf(<font class="stringliteral">"Vertices:\n"</font>);
01748     <font class="keywordflow">for</font>(r=0;r&lt;P-&gt;NbRays;++r) {
01749         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(P-&gt;Ray[r][0]))
01750             printf(<font class="stringliteral">"(line) "</font>);
01751         printf(<font class="stringliteral">"["</font>);
01752         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,P_VALUE_FMT,P-&gt;Ray[r][1]);
01753         <font class="keywordflow">for</font>(i=1;i&lt;P-&gt;Dimension;i++) {
01754             printf(<font class="stringliteral">", "</font>);
01755             <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,P_VALUE_FMT,P-&gt;Ray[r][i+1]);
01756         }  
01757         printf(<font class="stringliteral">"]"</font>);
01758         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(P-&gt;Ray[r][i+1]))<font class="keyword"> </font>{
01759             printf(<font class="stringliteral">"/"</font>);
01760             <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,P_VALUE_FMT, P-&gt;Ray[r][i+1]);
01761         }
01762         printf(<font class="stringliteral">"\n"</font>);
01763     }
01764 <font class="preprocessor">#endif    </font>
01765 <font class="preprocessor"></font>    <a class="code" href="arithmetic__errors_8h.html#a4">CATCH</a>(overflow_error)<font class="keyword"> </font>{
01766         fprintf(stderr,<font class="stringliteral">"Enumerate: arithmetic overflow error.\n"</font>);
01767         fprintf(stderr,<font class="stringliteral">"You should rebuild PolyLib using GNU-MP or increasing the size of integers.\n"</font>);
01768         overflow_warning_flag = 0;
01769         <a class="code" href="assert_8h.html#a1">assert</a>(overflow_warning_flag);
01770     }
01771     <a class="code" href="arithmetic__errors_8h.html#a6">TRY</a> {
01772     
01773         <a class="code" href="vector_8c.html#a9">Vector_Set</a>(context,0,(hdim+1));
01774     
01775         <font class="comment">/* Set context[hdim] = 1  (the constant) */</font>
01776         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(context[hdim],1);
01777         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(tmp,1);
01778         res-&gt;EP.x.p = <a class="code" href="ehrhart_8c~.html#a24">P_Enum</a>(L,NULL,context,1,0,hdim-1,&amp;tmp);
01779         <a class="code" href="arithmetic__errors_8h.html#a5">UNCATCH</a>(overflow_error);
01780     }
01781   
01782     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(L);
01783   
01784     <font class="comment">/*  **USELESS, there are no references to parameters in res**</font>
01785 <font class="comment">        if( CT )</font>
01786 <font class="comment">        addeliminatedparams_evalue(&amp;res-&gt;EP, CT);</font>
01787 <font class="comment">    */</font>
01788   
01789 <font class="preprocessor">#ifdef EPRINT</font>
01790 <font class="preprocessor"></font>    fprintf(stdout,<font class="stringliteral">"\nEhrhart Polynomial:\n"</font>);
01791     <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(stdout,&amp;res-&gt;EP,param_name);
01792     fprintf(stdout, <font class="stringliteral">"\n"</font>);
01793 <font class="preprocessor">#endif</font>
01794 <font class="preprocessor"></font>  
01795     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
01796     <font class="keywordflow">for</font> (j=0;j&lt;= hdim;j++) 
01797         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(context[j]);  
01798     <font class="keywordflow">return</font>(res);
01799 } <font class="comment">/* Enumerate_NoParameters */</font>
01800 <font class="comment"></font>
01801 <font class="comment">/**  Procedure to count points in a parameterized polytope.</font>
01802 <font class="comment"></font>
01803 <font class="comment">@param P Polyhedron to enumerate</font>
01804 <font class="comment">@param C Context Domain</font>
01805 <font class="comment">@param MAXRAYS size of workspace</font>
01806 <font class="comment">@return a list of validity domains + evalues EP</font>
01807 <font class="comment"></font>
01808 <font class="comment">*/</font>
<a name="l01809"></a><a class="code" href="ehrhart_8c~.html#a27">01809</a> Enumeration *<a class="code" href="ehrhart_8c~.html#a27">Polyhedron_Enumerate</a>(Polyhedron *<a class="code" href="polyparam_8c.html#a9">Pi</a>,Polyhedron *C,<font class="keywordtype">unsigned</font> <a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>)<font class="keyword"></font>
01810 <font class="keyword"></font>{
01811   Polyhedron *L, *CQ, *CQ2, *LQ, *U, *CEq, *rVD, *P;
01812   Matrix *CT;
01813   Param_Polyhedron *PP;
01814   Param_Domain   *Q;
01815   <font class="keywordtype">int</font> i,hdim, dim, nb_param, np;
01816   Value *lcm, *m1, hdv;
01817   Value *context;
01818   Enumeration *en, *res;
01819 
01820   res = NULL;
01821   P = <a class="code" href="polyparam_8c.html#a9">Pi</a>;
01822 
01823 <font class="preprocessor">#ifdef EDEBUG2</font>
01824 <font class="preprocessor"></font>  fprintf(stderr,<font class="stringliteral">"C = \n"</font>);
01825   <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,C);
01826   fprintf(stderr,<font class="stringliteral">"P = \n"</font>);
01827   <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,P);
01828 <font class="preprocessor">#endif</font>
01829 <font class="preprocessor"></font>
01830   hdim          = P-&gt;Dimension + 1;
01831   dim           = P-&gt;Dimension;
01832   nb_param      = C-&gt;Dimension;
01833 
01834   <font class="comment">/* Don't call Polyhedron2Param_Domain if there are no parameters */</font>
01835   <font class="keywordflow">if</font>(nb_param == 0) {
01836     
01837     <font class="keywordflow">return</font>(<a class="code" href="ehrhart_8c~.html#a26">Enumerate_NoParameters</a>(P,C,NULL,NULL,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>));  
01838   }
01839   PP = <a class="code" href="polyparam_8c.html#a42">Polyhedron2Param_SimplifiedDomain</a>(&amp;P,C,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>,&amp;CEq,&amp;CT);
01840   <font class="keywordflow">if</font>(!PP) {
01841 <font class="preprocessor">#ifdef EPRINT</font>
01842 <font class="preprocessor"></font>    fprintf(stdout, <font class="stringliteral">"\nEhrhart Polynomial:\nNULL\n"</font>);
01843 <font class="preprocessor">#endif</font>
01844 <font class="preprocessor"></font>
01845     <font class="keywordflow">return</font>(NULL);
01846   }
01847   
01848   <font class="comment">/* CT : transformation matrix to eliminate useless ("false") parameters */</font>
01849   <font class="keywordflow">if</font>(CT) {
01850     nb_param -= CT-&gt;NbColumns-CT-&gt;NbRows;
01851     dim  -= CT-&gt;NbColumns-CT-&gt;NbRows;
01852     hdim -= CT-&gt;NbColumns-CT-&gt;NbRows;
01853     
01854     <font class="comment">/* Don't call Polyhedron2Param_Domain if there are no parameters */</font>
01855     <font class="keywordflow">if</font>(nb_param == 0)
01856     {
01857             res = <a class="code" href="ehrhart_8c~.html#a26">Enumerate_NoParameters</a>(P,C,CT,CEq,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01858             <font class="keywordflow">if</font>( P != <a class="code" href="polyparam_8c.html#a9">Pi</a> )
01859                     <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>( P );
01860             <font class="keywordflow">return</font>( res );
01861     }  
01862   }
01863 
01864   <font class="comment">/* get memory for Values */</font>
01865   lcm = (Value *)malloc( nb_param * <font class="keyword">sizeof</font>(Value));
01866   m1  = (Value *)malloc( nb_param * <font class="keyword">sizeof</font>(Value));
01867   <font class="comment">/* Initialize all the 'Value' variables */</font>
01868   <font class="keywordflow">for</font>( np=0 ; np&lt;nb_param ; np++ )
01869   {
01870     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(lcm[np]); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(m1[np]);
01871   }
01872   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(hdv);
01873 
01874   <font class="keywordflow">for</font>(Q=PP-&gt;D;Q;Q=Q-&gt;next) {
01875     <font class="keywordflow">if</font>(CT) {
01876       Polyhedron *Dt;
01877       CQ = Q-&gt;Domain;      
01878       Dt = <a class="code" href="polyhedron_8c.html#a50">Polyhedron_Preimage</a>(Q-&gt;Domain,CT,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01879       rVD = <a class="code" href="polyhedron_8c.html#a32">DomainIntersection</a>(Dt,CEq,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01880       
01881       <font class="comment">/* if rVD is empty or too small in geometric dimension */</font>
01882       <font class="keywordflow">if</font>(!rVD || emptyQ(rVD) ||
01883          (rVD-&gt;Dimension-rVD-&gt;NbEq &lt; Dt-&gt;Dimension-Dt-&gt;NbEq-CEq-&gt;NbEq))<font class="keyword"> </font>{
01884         <font class="keywordflow">if</font>(rVD)
01885           <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(rVD);
01886         <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(Dt);
01887         <font class="keywordflow">continue</font>;               <font class="comment">/* empty validity domain */</font>
01888       }
01889       <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(Dt);
01890     }
01891     <font class="keywordflow">else</font>
01892       rVD = CQ = Q-&gt;Domain;    
01893     en = (Enumeration *)malloc(<font class="keyword">sizeof</font>(Enumeration));
01894     en-&gt;next = res;
01895     res = en;
01896     res-&gt;ValidityDomain = rVD;
01897     
01898 <font class="preprocessor">#ifdef EPRINT</font>
01899 <font class="preprocessor"></font>    fprintf(stdout,<font class="stringliteral">"---------------------------------------\n"</font>);
01900     fprintf(stdout,<font class="stringliteral">"Domain:\n"</font>);
01901     
01902 <font class="preprocessor">#ifdef EPRINT_ALL_VALIDITY_CONSTRAINTS</font>
01903 <font class="preprocessor"></font>    <a class="code" href="polyparam_8c.html#a39">Print_Domain</a>(stdout,res-&gt;ValidityDomain,param_name);
01904 <font class="preprocessor">#else    </font>
01905 <font class="preprocessor"></font>    {
01906       Polyhedron *VD;
01907       VD = <a class="code" href="polyhedron_8c.html#a42">DomainSimplify</a>(res-&gt;ValidityDomain,C,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01908       <a class="code" href="polyparam_8c.html#a39">Print_Domain</a>(stdout,VD,param_name);
01909       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(VD);
01910     }
01911 <font class="preprocessor">#endif </font><font class="comment">/* EPRINT_ALL_VALIDITY_CONSTRAINTS */</font>
01912 <font class="preprocessor">#endif </font><font class="comment">/* EPRINT */</font>
01913     
01914     overflow_warning_flag = 1;
01915     
01916     <font class="comment">/* Scan the vertices and compute lcm */</font>
01917     <a class="code" href="ehrhart_8c~.html#a25">Scan_Vertices</a>(PP,Q,CT,lcm,nb_param);
01918     
01919 <font class="preprocessor">#ifdef EDEBUG2</font>
01920 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"Denominator = "</font>);
01921     <font class="keywordflow">for</font>( np=0;np&lt;nb_param;np++)
01922       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,lcm[np]);
01923     fprintf(stderr,<font class="stringliteral">" and hdim == %d \n"</font>,hdim);
01924 <font class="preprocessor">#endif</font>
01925 <font class="preprocessor"></font>    
01926 <font class="preprocessor">#ifdef EDEBUG2</font>
01927 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"CQ = \n"</font>);
01928     <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,CQ);
01929 <font class="preprocessor">#endif</font>
01930 <font class="preprocessor"></font>
01931     <font class="comment">/* Before scanning, add constraints to ensure at least hdim*lcm */</font>
01932     <font class="comment">/* points in every dimension */</font>
01933     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(hdv,hdim-nb_param);
01934 
01935     <font class="keywordflow">for</font>( np=0;np&lt;nb_param;np++)
01936     {
01937                 <font class="keywordflow">if</font>( <a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(lcm[np]) )
01938                         <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(m1[np],hdv,lcm[np]);
01939                 <font class="keywordflow">else</font>
01940                         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(m1[np],1);
01941     }
01942 
01943 <font class="preprocessor">#ifdef EDEBUG2 </font>
01944 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"m1 == "</font>);
01945     <font class="keywordflow">for</font>( np=0;np&lt;nb_param;np++)
01946       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,m1[np]);
01947     fprintf(stderr,<font class="stringliteral">"\n"</font>);
01948 <font class="preprocessor">#endif </font>
01949 <font class="preprocessor"></font>
01950     <a class="code" href="arithmetic__errors_8h.html#a4">CATCH</a>(overflow_error)<font class="keyword"> </font>{
01951       fprintf(stderr,<font class="stringliteral">"Enumerate: arithmetic overflow error.\n"</font>);
01952       CQ2 = NULL;
01953     }
01954     <a class="code" href="arithmetic__errors_8h.html#a6">TRY</a> {      
01955       CQ2 = <a class="code" href="ehrhart_8c~.html#a20">Polyhedron_Preprocess</a>(CQ,m1,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01956 
01957 <font class="preprocessor">#ifdef EDEBUG2</font>
01958 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"After preprocess, CQ2 = "</font>);
01959       <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,CQ2);
01960 <font class="preprocessor">#endif</font>
01961 <font class="preprocessor"></font>      
01962       <a class="code" href="arithmetic__errors_8h.html#a5">UNCATCH</a>(overflow_error);
01963     }
01964     
01965     <font class="comment">/* Vin100, Feb 2001 */</font>
01966     <font class="comment">/* in case of degenerate, try to find a domain _containing_ CQ */</font>
01967     <font class="keywordflow">if</font> ((!CQ2 || emptyQ(CQ2)) &amp;&amp; CQ-&gt;NbBid==0) {
01968       <font class="keywordtype">int</font> r;
01969       
01970 <font class="preprocessor">#ifdef EDEBUG2</font>
01971 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"Trying to call Polyhedron_Preprocess2 : CQ = \n"</font>);
01972       <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,CQ);
01973 <font class="preprocessor">#endif</font>
01974 <font class="preprocessor"></font>      
01975       <font class="comment">/* Check if CQ is bounded */</font>
01976       <font class="keywordflow">for</font>(r=0;r&lt;CQ-&gt;NbRays;r++) {
01977         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(CQ-&gt;Ray[r][0]) ||
01978            value_zero_p(CQ-&gt;Ray[r][CQ-&gt;Dimension+1]))
01979           <font class="keywordflow">break</font>;
01980       }
01981       <font class="keywordflow">if</font>(r==CQ-&gt;NbRays) {
01982         
01983         <font class="comment">/* ok, CQ is bounded */</font>
01984         <font class="comment">/* now find if CQ is contained in a hypercube of size m1 */</font>
01985         CQ2 = <a class="code" href="ehrhart_8c~.html#a21">Polyhedron_Preprocess2</a>(CQ,m1,lcm,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01986       }
01987     }
01988     <font class="keywordflow">if</font> (!CQ2 || emptyQ(CQ2))<font class="keyword"> </font>{
01989 <font class="preprocessor">#ifdef EDEBUG2</font>
01990 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"Degenerate.\n"</font>);
01991 <font class="preprocessor">#endif</font>
01992 <font class="preprocessor"></font>      fprintf(stdout,<font class="stringliteral">"Degenerate Domain. Can not continue.\n"</font>);
01993       <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;EP.d);
01994       <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;EP.x.n);
01995       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;EP.d,1);
01996       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;EP.x.n,-1);
01997     }
01998     <font class="keywordflow">else</font> {
01999       
02000 <font class="preprocessor">#ifdef EDEBUG2</font>
02001 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"CQ2 = \n"</font>);
02002       <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,CQ2);
02003       <font class="keywordflow">if</font>( ! <a class="code" href="polyhedron_8c.html#a29">PolyhedronIncludes</a>(CQ, CQ2) )
02004         fprintf( stderr,<font class="stringliteral">"CQ does not include CQ2 !\n"</font>);
02005       <font class="keywordflow">else</font>
02006         fprintf( stderr,<font class="stringliteral">"CQ includes CQ2.\n"</font>);
02007       <font class="keywordflow">if</font>( ! <a class="code" href="polyhedron_8c.html#a29">PolyhedronIncludes</a>(res-&gt;ValidityDomain, CQ2) )
02008         fprintf( stderr,<font class="stringliteral">"CQ2 is *not* included in validity domain !\n"</font>);
02009       <font class="keywordflow">else</font>
02010         fprintf( stderr,<font class="stringliteral">"CQ2 is included in validity domain.\n"</font>);
02011 <font class="preprocessor">#endif</font>
02012 <font class="preprocessor"></font>      
02013       <font class="comment">/* L is used in counting the number of points in the base cases */</font>
02014       L = <a class="code" href="polyhedron_8c.html#a48">Polyhedron_Scan</a>(P,CQ,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
02015       U = <a class="code" href="polyhedron_8c.html#a23">Universe_Polyhedron</a>(0);
02016       
02017       <font class="comment">/* LQ is used to scan the parameter space */</font>
02018       LQ = <a class="code" href="polyhedron_8c.html#a48">Polyhedron_Scan</a>(CQ2,U,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>); <font class="comment">/* bounds on parameters */</font>
02019       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(U);
02020       <font class="keywordflow">if</font>(CT)    <font class="comment">/* we did compute another Q-&gt;Domain */</font>
02021         <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(CQ);
02022       
02023       <font class="comment">/* Else, CQ was Q-&gt;Domain (used in res) */</font>
02024       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(CQ2);
02025       
02026 <font class="preprocessor">#ifdef EDEBUG2</font>
02027 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"L = \n"</font>);
02028       <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,L);
02029       fprintf(stderr,<font class="stringliteral">"LQ = \n"</font>);
02030       <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,LQ);
02031 <font class="preprocessor">#endif</font>
02032 <font class="preprocessor"></font><font class="preprocessor">#ifdef EDEBUG3</font>
02033 <font class="preprocessor"></font>      fprintf(stdout,<font class="stringliteral">"\nSystem of Equations:\n"</font>);
02034 <font class="preprocessor">#endif</font>
02035 <font class="preprocessor"></font>      
02036       <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;EP.d);
02037       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;EP.d,0);
02038       
02039       <font class="comment">/* Create a context vector size dim+2 */</font>
02040       context = (Value *) malloc ((hdim+1)*<font class="keyword">sizeof</font>(Value));  
02041       <font class="keywordflow">for</font>(i=0;i&lt;=(hdim);i++)
02042         <a class="code" href="arithmetique_8h.html#a10">value_init</a>(context[i]);
02043       <a class="code" href="vector_8c.html#a9">Vector_Set</a>(context,0,(hdim+1));
02044       
02045       <font class="comment">/* Set context[hdim] = 1  (the constant) */</font>
02046       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(context[hdim],1);
02047       
02048       <a class="code" href="arithmetic__errors_8h.html#a4">CATCH</a>(overflow_error)<font class="keyword"> </font>{
02049                         fprintf(stderr,<font class="stringliteral">"Enumerate: arithmetic overflow error.\n"</font>);
02050                         fprintf(stderr,<font class="stringliteral">"You should rebuild PolyLib using GNU-MP or increasing the size of integers.\n"</font>);
02051                         overflow_warning_flag = 0;
02052                         <a class="code" href="assert_8h.html#a1">assert</a>(overflow_warning_flag);
02053         
02054       }
02055       <a class="code" href="arithmetic__errors_8h.html#a6">TRY</a> {
02056                         res-&gt;EP.x.p = <a class="code" href="ehrhart_8c~.html#a24">P_Enum</a>(L,LQ,context,1,nb_param,dim,lcm);
02057                         <a class="code" href="arithmetic__errors_8h.html#a5">UNCATCH</a>(overflow_error);        
02058       }
02059       
02060       <font class="keywordflow">for</font>(i=0;i&lt;=(hdim);i++)
02061         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(context[i]);
02062       free(context);
02063       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(L);
02064       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(LQ);
02065       
02066 <font class="preprocessor">#ifdef EDEBUG5</font>
02067 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
02068 <font class="preprocessor"></font>      fprintf(stdout,<font class="stringliteral">"\nEhrhart Polynomial (before simplification):\n"</font>);
02069       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(stdout,&amp;res-&gt;EP,param_name);
02070 <font class="preprocessor">#endif</font>
02071 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
02072 <font class="preprocessor"></font>      
02073       <font class="comment">/* Try to simplify the result */</font>
02074       <a class="code" href="ehrhart_8c~.html#a13">reduce_evalue</a>(&amp;res-&gt;EP);
02075       
02076       <font class="comment">/* Put back the original parameters into result */</font>
02077       <font class="comment">/* (equalities have been eliminated)            */</font>
02078       <font class="keywordflow">if</font>(CT) 
02079           <a class="code" href="ehrhart_8c~.html#a18">addeliminatedparams_evalue</a>(&amp;res-&gt;EP,CT);
02080       
02081 <font class="preprocessor">#ifdef EPRINT</font>
02082 <font class="preprocessor"></font>      fprintf(stdout,<font class="stringliteral">"\nEhrhart Polynomial:\n"</font>);
02083       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(stdout,&amp;res-&gt;EP, param_name);
02084       fprintf(stdout,<font class="stringliteral">"\n"</font>);
02085       <font class="comment">/* sometimes the final \n lacks (when a single constant is printed) */</font>
02086 <font class="preprocessor">#endif  </font>
02087 <font class="preprocessor"></font>      
02088     }
02089   }
02090 
02091   <font class="keywordflow">if</font>( P != <a class="code" href="polyparam_8c.html#a9">Pi</a> )
02092         <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>( P );
02093   <font class="comment">/* Clear all the 'Value' variables */</font>
02094   <font class="keywordflow">for</font>( np=0; np&lt;nb_param ; np++ )
02095   {
02096     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(lcm[np]); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1[np]);
02097   }
02098   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(hdv);
02099 
02100   <font class="keywordflow">return</font> res;
02101 } <font class="comment">/* Polyhedron_Enumerate */</font> 
02102 
</pre></div><hr><address><small>Generated on Fri Oct 4 15:05:56 2002 for Polylib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.11.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
