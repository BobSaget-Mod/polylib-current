<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>testehrhart.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>testehrhart.c</h1><a href="testehrhart_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/***********************************************************************/</font>
00002 <font class="comment">/*                Ehrhart V4.20                                        */</font>
00003 <font class="comment">/*                copyright 1997, Doran Wilde                          */</font>
00004 <font class="comment">/*                copyright 1997-2000, Vincent Loechner                */</font>
00005 <font class="comment">/*       Permission is granted to copy, use, and distribute            */</font>
00006 <font class="comment">/*       for any commercial or noncommercial purpose under the terms   */</font>
00007 <font class="comment">/*       of the GNU General Public license, version 2, June 1991       */</font>
00008 <font class="comment">/*       (see file : LICENSING).                                       */</font>
00009 <font class="comment">/***********************************************************************/</font>
00010 
00011 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00012 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00013 <font class="preprocessor">#include &lt;ctype.h&gt;</font>
00014 <font class="preprocessor">#include &lt;string.h&gt;</font>
00015 <font class="preprocessor">#include &lt;unistd.h&gt;</font>
00016 <font class="preprocessor">#include &lt;<a class="code" href="assert_8h.html">assert.h</a>&gt;</font>
00017 
00018 <font class="preprocessor">#include &lt;polylib/polylib.h&gt;</font>
00019 <font class="comment"></font>
00020 <font class="comment">/** </font>
00021 <font class="comment">    </font>
00022 <font class="comment">define this to print all constraints on the validity domains if not</font>
00023 <font class="comment">defined, only new constraints (not in validity domain given by the</font>
00024 <font class="comment">user) are printed</font>
00025 <font class="comment"></font>
00026 <font class="comment">*/</font>
<a name="l00027"></a><a class="code" href="testehrhart_8c.html#a0">00027</a> <font class="preprocessor">#define EPRINT_ALL_VALIDITY_CONSTRAINTS</font>
00028 <font class="preprocessor"></font><font class="comment"></font>
00029 <font class="comment">/** </font>
00030 <font class="comment"></font>
00031 <font class="comment">The following are mainly for debug purposes. You shouldn't need to</font>
00032 <font class="comment">change anything for daily usage...</font>
00033 <font class="comment"></font>
00034 <font class="comment">*/</font>
00035 <font class="comment"></font>
00036 <font class="comment">/** you may define each macro independently </font>
00037 <font class="comment">&lt;ol&gt;</font>
00038 <font class="comment">&lt;li&gt; #define EDEBUG minimal debug </font>
00039 <font class="comment">&lt;li&gt; #define EDEBUG1 prints enumeration points</font>
00040 <font class="comment">&lt;li&gt; #define EDEBUG11 prints number of points</font>
00041 <font class="comment">&lt;li&gt; #define EDEBUG2 prints domains</font>
00042 <font class="comment">&lt;li&gt; #define EDEBUG21 prints more domains</font>
00043 <font class="comment">&lt;li&gt; #define EDEBUG3 prints systems of equations that are solved</font>
00044 <font class="comment">&lt;li&gt; #define EDEBUG4 prints message for degree reduction</font>
00045 <font class="comment">&lt;li&gt; #define EDEBUG5 prints result before simplification </font>
00046 <font class="comment">&lt;li&gt; #define EDEBUG6 prints domains in Preprocess </font>
00047 <font class="comment">&lt;li&gt; #define EDEBUG61 prints even more in Preprocess</font>
00048 <font class="comment">&lt;li&gt; #define EDEBUG62 prints domains in Preprocess2</font>
00049 <font class="comment">&lt;/ol&gt;</font>
00050 <font class="comment">*/</font>
00051 
00052 <font class="comment">/* #define EDEBUG       */</font>              <font class="comment">/* minimal debug */</font>
00053 <font class="comment">/* #define EDEBUG1      */</font>              <font class="comment">/* prints enumeration points */</font>
00054 <font class="comment">/* #define EDEBUG11     */</font>              <font class="comment">/* prints number of points */</font>
00055 <font class="comment">/* #define EDEBUG2      */</font>              <font class="comment">/* prints domains */</font>
00056 <font class="comment">/* #define EDEBUG21     */</font>              <font class="comment">/* prints more domains */</font>
00057 <font class="comment">/* #define EDEBUG3      */</font>              <font class="comment">/* prints systems of equations that are solved */</font>
00058 <font class="comment">/* #define EDEBUG4      */</font>              <font class="comment">/* prints message for degree reduction */</font>
00059 <font class="comment">/* #define EDEBUG5      */</font>              <font class="comment">/* prints result before simplification */</font>
00060 <font class="comment">/* #define EDEBUG6      */</font>              <font class="comment">/* prints domains in Preprocess */</font>
00061 <font class="comment">/* #define EDEBUG61     */</font>              <font class="comment">/* prints even more in Preprocess */</font>
00062 <font class="comment">/* #define EDEBUG62     */</font>              <font class="comment">/* prints domains in Preprocess2 */</font>
00063 
00064 <font class="comment"></font>
00065 <font class="comment">/**</font>
00066 <font class="comment"></font>
00067 <font class="comment"> Reduce the degree of resulting polynomials</font>
00068 <font class="comment"></font>
00069 <font class="comment">*/</font>
<a name="l00070"></a><a class="code" href="testehrhart_8c.html#a1">00070</a> <font class="preprocessor">#define REDUCE_DEGREE</font>
00071 <font class="preprocessor"></font><font class="comment"></font>
00072 <font class="comment">/** </font>
00073 <font class="comment"></font>
00074 <font class="comment">define this to print one warning message per domain overflow these</font>
00075 <font class="comment">overflows should no longer happen since version 4.20</font>
00076 <font class="comment"></font>
00077 <font class="comment">*/</font>
<a name="l00078"></a><a class="code" href="testehrhart_8c.html#a2">00078</a> <font class="preprocessor">#define ALL_OVERFLOW_WARNINGS</font>
00079 <font class="preprocessor"></font><font class="comment"></font>
00080 <font class="comment">/**</font>
00081 <font class="comment"></font>
00082 <font class="comment">EPRINT : print results while computing the ehrhart polynomial.  this</font>
00083 <font class="comment">is done by default if you build the executable ehrhart.  (If EMAIN is</font>
00084 <font class="comment">defined).  Don't define EMAIN here, it is defined when necessary in</font>
00085 <font class="comment">the makefile.  </font>
00086 <font class="comment"></font>
00087 <font class="comment">&lt;p&gt;</font>
00088 <font class="comment"></font>
00089 <font class="comment">Notice: you may however define EPRINT without defining EMAIN, but in</font>
00090 <font class="comment">this case, you have to initialize the global variable param_name by</font>
00091 <font class="comment">calling Read_ParamNames before any call to ehrhart.  This is NOT</font>
00092 <font class="comment">recommanded, unless you know what you do.  EPRINT causes more debug</font>
00093 <font class="comment">messages to be printed.</font>
00094 <font class="comment"></font>
00095 <font class="comment">*/</font>
00096 <font class="comment">/* #define EPRINT */</font>
00097 
<a name="l00098"></a><a class="code" href="testehrhart_8c.html#a3">00098</a> <font class="keywordtype">int</font> <a class="code" href="c2p_8c.html#a1">main</a>() {
00099   
00100     <font class="keywordtype">int</font> i;
00101     <font class="keywordtype">char</font> str[1024];
00102     Matrix *C1, *P1;
00103     Polyhedron *C, *P;
00104     Enumeration *en, *ee;
00105     <font class="keywordtype">char</font> **param_name;
00106   
00107 <font class="preprocessor">#ifdef EP_EVALUATION</font>
00108 <font class="preprocessor"></font>    <a class="code" href="arithmetique_8h.html#a93">Value</a> *p, *tmp;
00109     <font class="keywordtype">int</font> k;
00110 <font class="preprocessor">#endif</font>
00111 <font class="preprocessor"></font>
00112     P1 = <a class="code" href="matrix_8c.html#a4">Matrix_Read</a>();
00113     C1 = <a class="code" href="matrix_8c.html#a4">Matrix_Read</a>();
00114     <font class="keywordflow">if</font>(C1-&gt;NbColumns &lt; 2) {
00115         fprintf( stderr, <font class="stringliteral">"Not enough parameters !\n"</font> );
00116         exit(0);
00117     }
00118     P = <a class="code" href="polyhedron_8c.html#a24">Constraints2Polyhedron</a>(P1,1024);
00119     C = <a class="code" href="polyhedron_8c.html#a24">Constraints2Polyhedron</a>(C1,1024);
00120     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(C1);
00121     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(P1);
00122   
00123     <font class="comment">/* Read the name of the parameters */</font>
00124     param_name = <a class="code" href="param_8c.html#a0">Read_ParamNames</a>(stdin,C-&gt;Dimension);
00125     en = Polyhedron_Enumerate(P,C,1024,param_name);
00126 
00127 <font class="preprocessor">#ifdef EP_EVALUATION</font>
00128 <font class="preprocessor"></font>    <font class="keywordflow">if</font>( isatty(0) &amp;&amp; C-&gt;Dimension != 0)
00129         {  <font class="comment">/* no tty input or no polyhedron -&gt; no evaluation. */</font>
00130             printf(<font class="stringliteral">"Evaluation of the Ehrhart polynomial :\n"</font>);
00131             p = (<a class="code" href="arithmetique_8h.html#a93">Value</a> *)malloc(<font class="keyword">sizeof</font>(<a class="code" href="arithmetique_8h.html#a93">Value</a>) * (C-&gt;Dimension));
00132             <font class="keywordflow">for</font>(i=0;i&lt;C-&gt;Dimension;i++) 
00133                 <a class="code" href="arithmetique_8h.html#a10">value_init</a>(p[i]);
00134             FOREVER {
00135                 fflush(stdin);
00136                 printf(<font class="stringliteral">"Enter %d parameters : "</font>,C-&gt;Dimension);
00137                 <font class="keywordflow">for</font>(k=0;k&lt;C-&gt;Dimension;++k) {
00138                     scanf(<font class="stringliteral">"%s"</font>,str);
00139                     <a class="code" href="arithmetique_8h.html#a15">value_read</a>(p[k],str);
00140                 }
00141                 fprintf(stdout,<font class="stringliteral">"EP( "</font>);
00142                 <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,p[0]);
00143                 <font class="keywordflow">for</font>(k=1;k&lt;C-&gt;Dimension;++k) {
00144                     fprintf(stdout,<font class="stringliteral">","</font>);
00145                     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,p[k]);
00146                 }  
00147                 fprintf(stdout,<font class="stringliteral">" ) = "</font>);
00148                 <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,*(tmp=compute_poly(en,p)));
00149                 free(tmp);
00150                 fprintf(stdout,<font class="stringliteral">"\n"</font>);  
00151             }
00152         }
00153 <font class="preprocessor">#endif </font><font class="comment">/* EP_EVALUATION */</font>
00154   
00155     <font class="keywordflow">while</font>( en )
00156         {
00157             free_evalue_refs( &amp;(en-&gt;EP) );
00158             <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>( en-&gt;ValidityDomain );
00159             ee = en -&gt;next;
00160             free( en );
00161             en = ee;
00162         }
00163     <font class="keywordflow">for</font>( i=0 ; i&lt;C-&gt;Dimension ; i++ )
00164         free( param_name[i] );
00165     free(param_name);
00166     <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>( P );
00167     <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>( C );
00168 
00169     <font class="keywordflow">return</font> 0;
00170 }
00171 
</pre></div><hr><address align="right"><small>Generated on Fri Nov 8 12:10:07 2002 for Polylib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
