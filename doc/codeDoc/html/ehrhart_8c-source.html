<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ehrhart.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11.1 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>ehrhart.c</h1><a href="ehrhart_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/***********************************************************************/</font>
00002 <font class="comment">/*                Ehrhart V4.20                                        */</font>
00003 <font class="comment">/*                copyright 1997, Doran Wilde                          */</font>
00004 <font class="comment">/*                copyright 1997-2000, Vincent Loechner                */</font>
00005 <font class="comment">/*       Permission is granted to copy, use, and distribute            */</font>
00006 <font class="comment">/*       for any commercial or noncommercial purpose under the terms   */</font>
00007 <font class="comment">/*       of the GNU General Public license, version 2, June 1991       */</font>
00008 <font class="comment">/*       (see file : LICENSING).                                       */</font>
00009 <font class="comment">/***********************************************************************/</font>
00010 
00011 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00012 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00013 <font class="preprocessor">#include &lt;ctype.h&gt;</font>
00014 <font class="preprocessor">#include &lt;string.h&gt;</font>
00015 <font class="preprocessor">#include &lt;unistd.h&gt;</font>
00016 <font class="preprocessor">#include &lt;<a class="code" href="assert_8h.html">assert.h</a>&gt;</font>
00017 
00018 <font class="preprocessor">#include &lt;polylib/polylib.h&gt;</font>
00019 
00020 <font class="comment"></font>
00021 <font class="comment">/*! \class Ehrhart</font>
00022 <font class="comment"></font>
00023 <font class="comment">The following are mainly for debug purposes. You shouldn't need to</font>
00024 <font class="comment">change anything for daily usage...</font>
00025 <font class="comment"></font>
00026 <font class="comment">&lt;p&gt;</font>
00027 <font class="comment"></font>
00028 <font class="comment">you may define each macro independently </font>
00029 <font class="comment">&lt;ol&gt;</font>
00030 <font class="comment">&lt;li&gt; #define EDEBUG minimal debug </font>
00031 <font class="comment">&lt;li&gt; #define EDEBUG1 prints enumeration points</font>
00032 <font class="comment">&lt;li&gt; #define EDEBUG11 prints number of points</font>
00033 <font class="comment">&lt;li&gt; #define EDEBUG2 prints domains</font>
00034 <font class="comment">&lt;li&gt; #define EDEBUG21 prints more domains</font>
00035 <font class="comment">&lt;li&gt; #define EDEBUG3 prints systems of equations that are solved</font>
00036 <font class="comment">&lt;li&gt; #define EDEBUG4 prints message for degree reduction</font>
00037 <font class="comment">&lt;li&gt; #define EDEBUG5 prints result before simplification </font>
00038 <font class="comment">&lt;li&gt; #define EDEBUG6 prints domains in Preprocess </font>
00039 <font class="comment">&lt;li&gt; #define EDEBUG61 prints even more in Preprocess</font>
00040 <font class="comment">&lt;li&gt; #define EDEBUG62 prints domains in Preprocess2</font>
00041 <font class="comment">&lt;/ol&gt;</font>
00042 <font class="comment">*/</font>
00043 
00044 <font class="comment"></font>
00045 <font class="comment">/** </font>
00046 <font class="comment">    </font>
00047 <font class="comment">define this to print all constraints on the validity domains if not</font>
00048 <font class="comment">defined, only new constraints (not in validity domain given by the</font>
00049 <font class="comment">user) are printed</font>
00050 <font class="comment"></font>
00051 <font class="comment">*/</font>
<a name="l00052"></a><a class="code" href="ehrhart_8c.html#a0">00052</a> <font class="preprocessor">#define EPRINT_ALL_VALIDITY_CONSTRAINTS</font>
00053 <font class="preprocessor"></font>
00054 <font class="comment">/* #define EDEBUG       */</font>              <font class="comment">/* minimal debug */</font>
00055 <font class="comment">/* #define EDEBUG1      */</font>              <font class="comment">/* prints enumeration points */</font>
00056 <font class="comment">/* #define EDEBUG11     */</font>              <font class="comment">/* prints number of points */</font>
00057 <font class="comment">/* #define EDEBUG2      */</font>              <font class="comment">/* prints domains */</font>
00058 <font class="comment">/* #define EDEBUG21     */</font>              <font class="comment">/* prints more domains */</font>
00059 <font class="comment">/* #define EDEBUG3      */</font>              <font class="comment">/* prints systems of equations that are solved */</font>
00060 <font class="comment">/* #define EDEBUG4      */</font>              <font class="comment">/* prints message for degree reduction */</font>
00061 <font class="comment">/* #define EDEBUG5      */</font>              <font class="comment">/* prints result before simplification */</font>
00062 <font class="comment">/* #define EDEBUG6      */</font>              <font class="comment">/* prints domains in Preprocess */</font>
00063 <font class="comment">/* #define EDEBUG61     */</font>              <font class="comment">/* prints even more in Preprocess */</font>
00064 <font class="comment">/* #define EDEBUG62     */</font>              <font class="comment">/* prints domains in Preprocess2 */</font>
00065 
00066 <font class="comment"></font>
00067 <font class="comment">/**</font>
00068 <font class="comment"> Reduce the degree of resulting polynomials</font>
00069 <font class="comment">*/</font>
<a name="l00070"></a><a class="code" href="ehrhart_8c.html#a1">00070</a> <font class="preprocessor">#define REDUCE_DEGREE</font>
00071 <font class="preprocessor"></font><font class="comment"></font>
00072 <font class="comment">/** </font>
00073 <font class="comment">define this to print one warning message per domain overflow these</font>
00074 <font class="comment">overflows should no longer happen since version 4.20</font>
00075 <font class="comment">*/</font>
<a name="l00076"></a><a class="code" href="ehrhart_8c.html#a2">00076</a> <font class="preprocessor">#define ALL_OVERFLOW_WARNINGS</font>
00077 <font class="preprocessor"></font><font class="comment"></font>
00078 <font class="comment">/**</font>
00079 <font class="comment">EPRINT : print results while computing the ehrhart polynomial.  this</font>
00080 <font class="comment">is done by default if you build the executable ehrhart.  (If EMAIN is</font>
00081 <font class="comment">defined).  Don't define EMAIN here, it is defined when necessary in</font>
00082 <font class="comment">the makefile.  </font>
00083 <font class="comment"></font>
00084 <font class="comment">&lt;p&gt;</font>
00085 <font class="comment"></font>
00086 <font class="comment">Notice: you may however define EPRINT without defining EMAIN, but in</font>
00087 <font class="comment">this case, you have to initialize the global variable param_name by</font>
00088 <font class="comment">calling Read_ParamNames before any call to ehrhart.  This is NOT</font>
00089 <font class="comment">recommanded, unless you know what you do.  EPRINT causes more debug</font>
00090 <font class="comment">messages to be printed.</font>
00091 <font class="comment"></font>
00092 <font class="comment">*/</font>
00093 <font class="comment">/* #define EPRINT */</font>
00094 
00095 <font class="comment">/******************* -----------END USER #DEFS-------- *********************/</font>
00096 
<a name="l00097"></a><a class="code" href="ehrhart_8c.html#a5">00097</a> <font class="keywordtype">int</font> overflow_warning_flag = 1;
00098 
00099 <font class="comment">//#ifdef EMAIN</font>
00100 <font class="comment">/* print enumeration results while computing */</font>
<a name="l00101"></a><a class="code" href="ehrhart_8c.html#a3">00101</a> <font class="preprocessor">#define EPRINT</font>
00102 <font class="preprocessor"></font><font class="comment">//#endif</font>
00103 <font class="preprocessor">#ifdef EPRINT</font>
<a name="l00104"></a><a class="code" href="ehrhart_8c.html#a6">00104</a> <font class="preprocessor"></font><font class="keywordtype">char</font> **param_name;      <font class="comment">/* global variable to print parameter names */</font>
00105 <font class="preprocessor">#endif</font>
00106 <font class="preprocessor"></font>
00107 <font class="comment">/*-------------------------------------------------------------------*/</font>
00108 <font class="comment">/* EHRHART POLYNOMIAL SYMBOLIC ALGEBRA SYSTEM                        */</font>
00109 <font class="comment">/*-------------------------------------------------------------------*/</font> <font class="comment"></font>
00110 <font class="comment">/** </font>
00111 <font class="comment"></font>
00112 <font class="comment">EHRHART POLYNOMIAL SYMBOLIC ALGEBRA SYSTEM. The newly allocated enode</font>
00113 <font class="comment">can be freed with a simple free(x)</font>
00114 <font class="comment"></font>
00115 <font class="comment">@param type : enode type</font>
00116 <font class="comment">@param size : degree+1 for polynomial, period for periodic</font>
00117 <font class="comment">@param pos  : 1..nb_param, position of parameter            </font>
00118 <font class="comment">@return a newly allocated enode </font>
00119 <font class="comment"></font>
00120 <font class="comment">*/</font>
<a name="l00121"></a><a class="code" href="ehrhart_8c.html#a7">00121</a> enode *<a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(enode_type type,<font class="keywordtype">int</font> size,<font class="keywordtype">int</font> pos)<font class="keyword"> </font>{
00122   
00123   enode *res;
00124   <font class="keywordtype">int</font> i;
00125   
00126   <font class="keywordflow">if</font>(size == 0) {
00127     fprintf(stderr, <font class="stringliteral">"Allocating enode of size 0 !\n"</font> );
00128     <font class="keywordflow">return</font> NULL;
00129   }
00130   res = (enode *) malloc(<font class="keyword">sizeof</font>(enode) + (size-1)*<font class="keyword">sizeof</font>(evalue));
00131   res-&gt;type = type;
00132   res-&gt;size = size;
00133   res-&gt;pos = pos;
00134   <font class="keywordflow">for</font>(i=0; i&lt;size; i++) {
00135     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;arr[i].d);
00136     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;arr[i].x.n);
00137     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;arr[i].d,0);
00138     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;arr[i].x.n,0);
00139   }
00140   <font class="keywordflow">return</font> res;
00141 } <font class="comment">/* new_enode */</font>
00142 <font class="comment"></font>
00143 <font class="comment">/**</font>
00144 <font class="comment">releases all memory referenced by e.  (recursive)        </font>
00145 <font class="comment">@param e pointer to an evalue</font>
00146 <font class="comment">*/</font>
<a name="l00147"></a><a class="code" href="ehrhart_8c.html#a8">00147</a> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a8">free_evalue_refs</a>(evalue *e)<font class="keyword"> </font>{
00148   
00149   enode *p;
00150   <font class="keywordtype">int</font> i;
00151   
00152   <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e-&gt;d))<font class="keyword"> </font>{
00153     
00154     <font class="comment">/* 'e' stores a constant */</font>
00155     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(e-&gt;d);
00156     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(e-&gt;x.n);
00157     <font class="keywordflow">return</font>; 
00158   }  
00159   p = e-&gt;x.p;
00160   <font class="keywordflow">if</font> (!p) <font class="keywordflow">return</font>;       <font class="comment">/* null pointer */</font>
00161   <font class="keywordflow">for</font> (i=0; i&lt;p-&gt;size; i++) {
00162     <a class="code" href="ehrhart_8c~.html#a8">free_evalue_refs</a>(&amp;(p-&gt;arr[i]));
00163   }
00164   free(p);
00165   <font class="keywordflow">return</font>;
00166 } <font class="comment">/* free_evalue_refs */</font>
00167 <font class="comment"></font>
00168 <font class="comment">/**</font>
00169 <font class="comment"></font>
00170 <font class="comment">@param e pointer to an evalue </font>
00171 <font class="comment">@return description</font>
00172 <font class="comment"></font>
00173 <font class="comment">*/</font>
<a name="l00174"></a><a class="code" href="ehrhart_8c.html#a9">00174</a> enode *<a class="code" href="ehrhart_8c~.html#a9">ecopy</a>(enode *e)<font class="keyword"> </font>{
00175   
00176   enode *res;
00177   <font class="keywordtype">int</font> i;
00178   
00179   res = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(e-&gt;type,e-&gt;size,e-&gt;pos);
00180   <font class="keywordflow">for</font>(i=0;i&lt;e-&gt;size;++i) {
00181     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(res-&gt;arr[i].d,e-&gt;arr[i].d);
00182     <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(res-&gt;arr[i].d))
00183       res-&gt;arr[i].x.p = <a class="code" href="ehrhart_8c~.html#a9">ecopy</a>(e-&gt;arr[i].x.p);
00184     <font class="keywordflow">else</font>
00185       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(res-&gt;arr[i].x.n,e-&gt;arr[i].x.n);
00186   }
00187   <font class="keywordflow">return</font>(res);
00188 } <font class="comment">/* ecopy */</font>
00189 <font class="comment"></font>
00190 <font class="comment">/**</font>
00191 <font class="comment"></font>
00192 <font class="comment">@param DST destination file</font>
00193 <font class="comment">@param e pointer to evalue to be printed</font>
00194 <font class="comment"></font>
00195 <font class="comment">*/</font>
<a name="l00196"></a><a class="code" href="ehrhart_8c.html#a10">00196</a> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(FILE *DST,evalue *e,<font class="keywordtype">char</font> **pname)<font class="keyword"> </font>{
00197   
00198   <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e-&gt;d))<font class="keyword"> </font>{    
00199     <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(e-&gt;d))<font class="keyword"> </font>{
00200       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(DST,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,e-&gt;x.n);
00201       fprintf(DST,<font class="stringliteral">"/"</font>);
00202       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(DST,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,e-&gt;d);
00203     }  
00204     <font class="keywordflow">else</font> {
00205       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(DST,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,e-&gt;x.n);
00206     }
00207   }  
00208   <font class="keywordflow">else</font>
00209     <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(DST,e-&gt;x.p,pname);
00210   <font class="keywordflow">return</font>;
00211 } <font class="comment">/* print_evalue */</font>
00212 <font class="comment"></font>
00213 <font class="comment">/** prints the enode  to DST  </font>
00214 <font class="comment"></font>
00215 <font class="comment">@param DST destination file </font>
00216 <font class="comment">@param p pointer to enode  to be printed </font>
00217 <font class="comment">@param pname array of strings, name of the parameters</font>
00218 <font class="comment"></font>
00219 <font class="comment">*/</font>
<a name="l00220"></a><a class="code" href="ehrhart_8c.html#a11">00220</a> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(FILE *DST,enode *p,<font class="keywordtype">char</font> **pname)<font class="keyword"> </font>{
00221   
00222   <font class="keywordtype">int</font> i;
00223   
00224   <font class="keywordflow">if</font> (!p) {
00225     fprintf(DST, <font class="stringliteral">"NULL"</font>);
00226     <font class="keywordflow">return</font>;
00227   }
00228   <font class="keywordflow">if</font> (p-&gt;type == evector) {
00229     fprintf(DST, <font class="stringliteral">"{ "</font>);
00230     <font class="keywordflow">for</font> (i=0; i&lt;p-&gt;size; i++) {
00231       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(DST, &amp;p-&gt;arr[i], pname);
00232       <font class="keywordflow">if</font> (i!=(p-&gt;size-1))
00233         fprintf(DST, <font class="stringliteral">", "</font>);
00234     }
00235     fprintf(DST, <font class="stringliteral">" }\n"</font>);
00236   }
00237   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (p-&gt;type == polynomial) {
00238     fprintf(DST, <font class="stringliteral">"( "</font>);
00239     <font class="keywordflow">for</font> (i=p-&gt;size-1; i&gt;=0; i--) {
00240       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(DST, &amp;p-&gt;arr[i], pname);
00241       <font class="keywordflow">if</font> (i==1) fprintf(DST, <font class="stringliteral">" * %s + "</font>, pname[p-&gt;pos-1]);
00242       <font class="keywordflow">else</font> <font class="keywordflow">if</font> (i&gt;1) 
00243         fprintf(DST, <font class="stringliteral">" * %s^%d + "</font>, pname[p-&gt;pos-1], i);
00244     }
00245     fprintf(DST, <font class="stringliteral">" )\n"</font>);
00246   }
00247   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (p-&gt;type == periodic) {
00248     fprintf(DST, <font class="stringliteral">"[ "</font>);
00249     <font class="keywordflow">for</font> (i=0; i&lt;p-&gt;size; i++) {
00250       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(DST, &amp;p-&gt;arr[i], pname);
00251       <font class="keywordflow">if</font> (i!=(p-&gt;size-1)) fprintf(DST, <font class="stringliteral">", "</font>);
00252     }
00253     fprintf(DST,<font class="stringliteral">" ]_%s"</font>, pname[p-&gt;pos-1]);
00254   }
00255   <font class="keywordflow">return</font>;
00256 } <font class="comment">/* print_enode */</font> 
00257 <font class="comment"></font>
00258 <font class="comment">/**</font>
00259 <font class="comment"></font>
00260 <font class="comment">@param  e1 pointers to evalues</font>
00261 <font class="comment">@param  e2 pointers to evalues</font>
00262 <font class="comment">@return 1 (true) if they are equal, 0 (false) if not       </font>
00263 <font class="comment"></font>
00264 <font class="comment">*/</font>
<a name="l00265"></a><a class="code" href="ehrhart_8c.html#a12">00265</a> <font class="keyword">static</font> <font class="keywordtype">int</font> <a class="code" href="ehrhart_8c~.html#a12">eequal</a>(evalue *e1,evalue *e2)<font class="keyword"> </font>{ 
00266  
00267     <font class="keywordtype">int</font> i;
00268     enode *p1, *p2;
00269   
00270     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a23">value_ne</a>(e1-&gt;d,e2-&gt;d))
00271         <font class="keywordflow">return</font> 0;
00272   
00273     <font class="comment">/* e1-&gt;d == e2-&gt;d */</font>
00274     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e1-&gt;d))<font class="keyword"> </font>{    
00275         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a23">value_ne</a>(e1-&gt;x.n,e2-&gt;x.n))
00276             <font class="keywordflow">return</font> 0;
00277     
00278         <font class="comment">/* e1-&gt;d == e2-&gt;d != 0  AND e1-&gt;n == e2-&gt;n */</font>
00279         <font class="keywordflow">return</font> 1;
00280     }
00281   
00282     <font class="comment">/* e1-&gt;d == e2-&gt;d == 0 */</font>
00283     p1 = e1-&gt;x.p;
00284     p2 = e2-&gt;x.p;
00285     <font class="keywordflow">if</font> (p1-&gt;type != p2-&gt;type) <font class="keywordflow">return</font> 0;
00286     <font class="keywordflow">if</font> (p1-&gt;size != p2-&gt;size) <font class="keywordflow">return</font> 0;
00287     <font class="keywordflow">if</font> (p1-&gt;pos  != p2-&gt;pos) <font class="keywordflow">return</font> 0;
00288     <font class="keywordflow">for</font> (i=0; i&lt;p1-&gt;size; i++)
00289         <font class="keywordflow">if</font> (!<a class="code" href="ehrhart_8c~.html#a12">eequal</a>(&amp;p1-&gt;arr[i], &amp;p2-&gt;arr[i]) ) 
00290             <font class="keywordflow">return</font> 0;
00291     <font class="keywordflow">return</font> 1;
00292 } <font class="comment">/* eequal */</font>
00293 <font class="comment"></font>
00294 <font class="comment">/** </font>
00295 <font class="comment"></font>
00296 <font class="comment">@param e pointer to an evalue</font>
00297 <font class="comment"></font>
00298 <font class="comment">*/</font>
<a name="l00299"></a><a class="code" href="ehrhart_8c.html#a13">00299</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a13">reduce_evalue</a> (evalue *e)<font class="keyword"> </font>{
00300   
00301     enode *p;
00302     <font class="keywordtype">int</font> i, j, k;
00303   
00304     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e-&gt;d))
00305         <font class="keywordflow">return</font>; <font class="comment">/* a rational number, its already reduced */</font>
00306     <font class="keywordflow">if</font>(!(p = e-&gt;x.p))
00307         <font class="keywordflow">return</font>; <font class="comment">/* hum... an overflow probably occured */</font>
00308   
00309     <font class="comment">/* First reduce the components of p */</font>
00310     <font class="keywordflow">for</font> (i=0; i&lt;p-&gt;size; i++)
00311         <a class="code" href="ehrhart_8c~.html#a13">reduce_evalue</a>(&amp;p-&gt;arr[i]);
00312 
00313     <font class="keywordflow">if</font> (p-&gt;type==periodic) {
00314     
00315         <font class="comment">/* Try to reduce the period */</font>
00316         <font class="keywordflow">for</font> (i=1; i&lt;=(p-&gt;size)/2; i++) {
00317             <font class="keywordflow">if</font> ((p-&gt;size % i)==0) {
00318         
00319                 <font class="comment">/* Can we reduce the size to i ? */</font>
00320                 <font class="keywordflow">for</font> (j=0; j&lt;i; j++)
00321                     <font class="keywordflow">for</font> (k=j+i; k&lt;e-&gt;x.p-&gt;size; k+=i)
00322                         <font class="keywordflow">if</font> (!<a class="code" href="ehrhart_8c~.html#a12">eequal</a>(&amp;p-&gt;arr[j], &amp;p-&gt;arr[k])) <font class="keywordflow">goto</font> you_lose;
00323 
00324                 <font class="comment">/* OK, lets do it */</font>
00325                 <font class="keywordflow">for</font> (j=i; j&lt;p-&gt;size; j++) <a class="code" href="ehrhart_8c~.html#a8">free_evalue_refs</a>(&amp;p-&gt;arr[j]);
00326                 p-&gt;size = i;
00327                 <font class="keywordflow">break</font>;
00328 
00329             you_lose:   <font class="comment">/* OK, lets not do it */</font>
00330                 <font class="keywordflow">continue</font>;
00331             }
00332         }
00333 
00334         <font class="comment">/* Try to reduce its strength */</font>
00335         <font class="keywordflow">if</font> (p-&gt;size == 1) {
00336             memcpy(e,&amp;p-&gt;arr[0],<font class="keyword">sizeof</font>(evalue));
00337             free(p);
00338         }
00339     }
00340     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (p-&gt;type==polynomial) {
00341           
00342         <font class="comment">/* Try to reduce the degree */</font>
00343         <font class="keywordflow">for</font> (i=p-&gt;size-1;i&gt;=0;i--) {
00344             <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a69">value_one_p</a>(p-&gt;arr[i].d) &amp;&amp; value_zero_p(p-&gt;arr[i].x.n))
00345         
00346                 <font class="comment">/* Zero coefficient */</font>
00347                 <font class="keywordflow">continue</font>;
00348             <font class="keywordflow">else</font>
00349                 <font class="keywordflow">break</font>;
00350         }
00351         <font class="keywordflow">if</font> (i==-1) p-&gt;size = 1;
00352         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (i+1&lt;p-&gt;size) p-&gt;size = i+1;
00353 
00354         <font class="comment">/* Try to reduce its strength */</font>
00355         <font class="keywordflow">if</font> (p-&gt;size == 1) {
00356             memcpy(e,&amp;p-&gt;arr[0],<font class="keyword">sizeof</font>(evalue));
00357             free(p);
00358         }
00359     }
00360 } <font class="comment">/* reduce_evalue */</font>
00361 
00362 <font class="comment"></font>
00363 <font class="comment">/**</font>
00364 <font class="comment"></font>
00365 <font class="comment">multiplies two evalues and puts the result in res</font>
00366 <font class="comment"></font>
00367 <font class="comment">@param e1 pointer to an evalue</font>
00368 <font class="comment">@param e2 pointer to a constant evalue</font>
00369 <font class="comment">@param res  pointer to result evalue = e1 * e2</font>
00370 <font class="comment"></font>
00371 <font class="comment">*/</font>
<a name="l00372"></a><a class="code" href="ehrhart_8c.html#a14">00372</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a14">emul</a> (evalue *e1,evalue *e2,evalue *res)<font class="keyword"> </font>{
00373   
00374     enode *p;
00375     <font class="keywordtype">int</font> i;
00376     Value g;
00377 
00378     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(e2-&gt;d))<font class="keyword"> </font>{
00379         fprintf(stderr, <font class="stringliteral">"emul: ?expecting constant value\n"</font>);
00380         <font class="keywordflow">return</font>;
00381     }  
00382     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(g);
00383     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e1-&gt;d))<font class="keyword"> </font>{
00384     
00385         <font class="comment">/* Product of two rational numbers */</font>
00386         <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(res-&gt;d,e1-&gt;d,e2-&gt;d);
00387         <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(res-&gt;x.n,e1-&gt;x.n,e2-&gt;x.n );
00388         <a class="code" href="vector_8c.html#a3">Gcd</a>(res-&gt;x.n, res-&gt;d,&amp;g);
00389         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(g))<font class="keyword"> </font>{
00390             <a class="code" href="arithmetique_8h.html#a51">value_division</a>(res-&gt;d,res-&gt;d,g);
00391             <a class="code" href="arithmetique_8h.html#a51">value_division</a>(res-&gt;x.n,res-&gt;x.n,g);
00392         }
00393     }
00394     <font class="keywordflow">else</font> { <font class="comment">/* e1 is an expression */</font>    
00395         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;d,0);
00396         p = e1-&gt;x.p;
00397         res-&gt;x.p = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(p-&gt;type, p-&gt;size, p-&gt;pos);
00398         <font class="keywordflow">for</font> (i=0; i&lt;p-&gt;size; i++) {
00399             <a class="code" href="ehrhart_8c~.html#a14">emul</a>(&amp;p-&gt;arr[i], e2, &amp;(res-&gt;x.p-&gt;arr[i]) ); 
00400         }
00401     }
00402     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g);
00403     <font class="keywordflow">return</font>;
00404 } <font class="comment">/* emul */</font>
00405 <font class="comment"></font>
00406 <font class="comment">/**</font>
00407 <font class="comment">adds one evalue to evalue 'res. result = res + e1 </font>
00408 <font class="comment"></font>
00409 <font class="comment">@param e1 an evalue </font>
00410 <font class="comment">@param res </font>
00411 <font class="comment"></font>
00412 <font class="comment">*/</font>
<a name="l00413"></a><a class="code" href="ehrhart_8c.html#a15">00413</a> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(evalue *e1,evalue *res)<font class="keyword"> </font>{
00414 
00415   <font class="keywordtype">int</font> i;
00416   Value g,m1,m2;
00417  
00418   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(g);
00419   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(m1);
00420   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(m2);
00421   
00422   <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e1-&gt;d) &amp;&amp; value_notzero_p(res-&gt;d))<font class="keyword"> </font>{
00423     
00424     <font class="comment">/* Add two rational numbers*/</font>
00425     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(m1,e1-&gt;x.n,res-&gt;d);
00426     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(m2,res-&gt;x.n,e1-&gt;d);
00427     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(res-&gt;x.n,m1,m2);
00428     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(res-&gt;d,e1-&gt;d,res-&gt;d);  
00429     <a class="code" href="vector_8c.html#a3">Gcd</a>(res-&gt;x.n,res-&gt;d,&amp;g);
00430     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(g))<font class="keyword"> </font>{  
00431       <a class="code" href="arithmetique_8h.html#a51">value_division</a>(res-&gt;d,res-&gt;d,g);
00432       <a class="code" href="arithmetique_8h.html#a51">value_division</a>(res-&gt;x.n,res-&gt;x.n,g);
00433     }
00434     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00435     <font class="keywordflow">return</font>;
00436   }
00437   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e1-&gt;d) &amp;&amp; value_zero_p(res-&gt;d))<font class="keyword"> </font>{
00438     <font class="keywordflow">if</font> (res-&gt;x.p-&gt;type==polynomial) {
00439       
00440       <font class="comment">/* Add the constant to the constant term */</font>
00441       <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(e1, &amp;res-&gt;x.p-&gt;arr[0]);
00442       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00443       <font class="keywordflow">return</font>;
00444     }
00445     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (res-&gt;x.p-&gt;type==periodic) {
00446       
00447       <font class="comment">/* Add the constant to all elements of periodic number */</font>
00448       <font class="keywordflow">for</font> (i=0; i&lt;res-&gt;x.p-&gt;size; i++) { 
00449         <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(e1, &amp;res-&gt;x.p-&gt;arr[i]);
00450       }
00451       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00452       <font class="keywordflow">return</font>;
00453     }
00454     <font class="keywordflow">else</font> {
00455       fprintf(stderr, <font class="stringliteral">"eadd: cannot add const with vector\n"</font>);
00456       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00457       <font class="keywordflow">return</font>;
00458     }
00459   }
00460   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(e1-&gt;d) &amp;&amp; value_notzero_p(res-&gt;d))<font class="keyword"> </font>{
00461     fprintf(stderr,<font class="stringliteral">"eadd: cannot add evalue to const\n"</font>);
00462     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00463     <font class="keywordflow">return</font>;
00464   }
00465   <font class="keywordflow">else</font> {    <font class="comment">/* ((e1-&gt;d==0) &amp;&amp; (res-&gt;d==0)) */</font>  
00466     <font class="keywordflow">if</font> ((e1-&gt;x.p-&gt;type != res-&gt;x.p-&gt;type) ||
00467         (e1-&gt;x.p-&gt;pos  != res-&gt;x.p-&gt;pos )) {
00468       fprintf(stderr, <font class="stringliteral">"eadd: ?cannot add, incompatible types\n"</font>);
00469       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00470       <font class="keywordflow">return</font>;
00471     }
00472     <font class="keywordflow">if</font> (e1-&gt;x.p-&gt;size == res-&gt;x.p-&gt;size) {
00473       <font class="keywordflow">for</font> (i=0; i&lt;res-&gt;x.p-&gt;size; i++) {
00474         <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(&amp;e1-&gt;x.p-&gt;arr[i], &amp;res-&gt;x.p-&gt;arr[i]);
00475       }
00476       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00477       <font class="keywordflow">return</font>;
00478     }
00479     
00480     <font class="comment">/* Sizes are different */</font>
00481     <font class="keywordflow">if</font> (res-&gt;x.p-&gt;type==polynomial) { 
00482       
00483       <font class="comment">/* VIN100: if e1-size &gt; res-size you have to copy e1 in a   */</font>
00484       <font class="comment">/* new enode and add res to that new node. If you do not do */</font>
00485       <font class="comment">/* that, you lose the the upper weight part of e1 !         */</font>
00486       
00487       <font class="keywordflow">if</font>(e1-&gt;x.p-&gt;size &gt; res-&gt;x.p-&gt;size) {
00488         enode *tmp;
00489         tmp = <a class="code" href="ehrhart_8c~.html#a9">ecopy</a>(e1-&gt;x.p);
00490         <font class="keywordflow">for</font>(i=0;i&lt;res-&gt;x.p-&gt;size;++i) {
00491           <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(&amp;res-&gt;x.p-&gt;arr[i], &amp;tmp-&gt;arr[i]);
00492           <a class="code" href="ehrhart_8c~.html#a8">free_evalue_refs</a>(&amp;res-&gt;x.p-&gt;arr[i]);
00493         }
00494         res-&gt;x.p = tmp;
00495       }
00496       <font class="keywordflow">else</font> {
00497         <font class="keywordflow">for</font> (i=0; i&lt;e1-&gt;x.p-&gt;size ; i++) {
00498           <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(&amp;e1-&gt;x.p-&gt;arr[i], &amp;res-&gt;x.p-&gt;arr[i]);
00499         }
00500         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00501         <font class="keywordflow">return</font>;
00502       }
00503     }
00504     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (res-&gt;x.p-&gt;type==periodic) {
00505       fprintf(stderr, <font class="stringliteral">"eadd: ?addition of different sized periodic nos\n"</font>);
00506       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00507       <font class="keywordflow">return</font>;
00508     }
00509     <font class="keywordflow">else</font> { <font class="comment">/* evector */</font>
00510       fprintf(stderr, <font class="stringliteral">"eadd: ?cannot add vectors of different length\n"</font>);
00511       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00512       <font class="keywordflow">return</font>;
00513     }
00514   }
00515   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m2);
00516   <font class="keywordflow">return</font>;
00517 } <font class="comment">/* eadd */</font>
00518 <font class="comment"></font>
00519 <font class="comment">/** </font>
00520 <font class="comment"></font>
00521 <font class="comment">computes the inner product of two vectors. Result = result (evalue) =</font>
00522 <font class="comment">v1.v2 (dot product)</font>
00523 <font class="comment"></font>
00524 <font class="comment">@param  v1 an enode (vector)</font>
00525 <font class="comment">@param  v2 an enode (vector of constants)</font>
00526 <font class="comment">@param res result (evalue)</font>
00527 <font class="comment"></font>
00528 <font class="comment">*/</font>
<a name="l00529"></a><a class="code" href="ehrhart_8c.html#a16">00529</a> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a16">edot</a>(enode *v1,enode *v2,evalue *res)<font class="keyword"> </font>{
00530   
00531     <font class="keywordtype">int</font> i;
00532     evalue tmp;
00533   
00534     <font class="keywordflow">if</font> ((v1-&gt;type != evector) || (v2-&gt;type != evector)) {
00535         fprintf(stderr, <font class="stringliteral">"edot: ?expecting vectors\n"</font>);
00536         <font class="keywordflow">return</font>;
00537     }
00538     <font class="keywordflow">if</font> (v1-&gt;size != v2-&gt;size) {
00539         fprintf(stderr, <font class="stringliteral">"edot: ? vector lengths do not agree\n"</font>);
00540         <font class="keywordflow">return</font>;
00541     }
00542     <font class="keywordflow">if</font> (v1-&gt;size&lt;=0) {
00543         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;d,1); <font class="comment">/* set result to 0/1 */</font>
00544         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;x.n,0);
00545         <font class="keywordflow">return</font>;
00546     }
00547   
00548     <font class="comment">/* vector v2 is expected to have only rational numbers in */</font>
00549     <font class="comment">/* the array.  No pointers. */</font>  
00550     <a class="code" href="ehrhart_8c~.html#a14">emul</a>(&amp;v1-&gt;arr[0],&amp;v2-&gt;arr[0],res);
00551     <font class="keywordflow">for</font> (i=1; i&lt;v1-&gt;size; i++) {
00552         <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp.d);
00553         <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp.x.n);
00554      
00555         <font class="comment">/* res = res + v1[i]*v2[i] */</font>
00556         <a class="code" href="ehrhart_8c~.html#a14">emul</a>(&amp;v1-&gt;arr[i],&amp;v2-&gt;arr[i],&amp;tmp);
00557         <a class="code" href="ehrhart_8c~.html#a15">eadd</a>(&amp;tmp,res);
00558         <a class="code" href="ehrhart_8c~.html#a8">free_evalue_refs</a>(&amp;tmp);
00559     }
00560     <font class="keywordflow">return</font>;
00561 } <font class="comment">/* edot */</font>
00562 <font class="comment"></font>
00563 <font class="comment">/**</font>
00564 <font class="comment"></font>
00565 <font class="comment">local recursive function used in the following ref contains the new</font>
00566 <font class="comment">position for each old index position</font>
00567 <font class="comment"></font>
00568 <font class="comment">@param e pointer to an evalue</font>
00569 <font class="comment">@param ref transformation Matrix</font>
00570 <font class="comment"></font>
00571 <font class="comment">*/</font>
<a name="l00572"></a><a class="code" href="ehrhart_8c.html#a17">00572</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a17">aep_evalue</a>(evalue *e, <font class="keywordtype">int</font> *ref)<font class="keyword"> </font>{
00573   
00574     enode *p;
00575     <font class="keywordtype">int</font> i;
00576   
00577     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e-&gt;d))
00578         <font class="keywordflow">return</font>;         <font class="comment">/* a rational number, its already reduced */</font>
00579     <font class="keywordflow">if</font>(!(p = e-&gt;x.p))
00580         <font class="keywordflow">return</font>;         <font class="comment">/* hum... an overflow probably occured */</font>
00581   
00582     <font class="comment">/* First check the components of p */</font>
00583     <font class="keywordflow">for</font> (i=0;i&lt;p-&gt;size;i++)
00584         <a class="code" href="ehrhart_8c~.html#a17">aep_evalue</a>(&amp;p-&gt;arr[i],ref);
00585   
00586     <font class="comment">/* Then p itself */</font>
00587     p-&gt;pos = ref[p-&gt;pos-1]+1;
00588     <font class="keywordflow">return</font>;
00589 } <font class="comment">/* aep_evalue */</font>
00590 <font class="comment"></font>
00591 <font class="comment">/** Comments */</font>
<a name="l00592"></a><a class="code" href="ehrhart_8c.html#a18">00592</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a18">addeliminatedparams_evalue</a>(evalue *e,Matrix *CT)<font class="keyword"> </font>{
00593         
00594     enode *p;
00595     <font class="keywordtype">int</font> i, j;
00596     <font class="keywordtype">int</font> *ref;
00597 
00598     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(e-&gt;d))
00599         <font class="keywordflow">return</font>;          <font class="comment">/* a rational number, its already reduced */</font>
00600     <font class="keywordflow">if</font>(!(p = e-&gt;x.p))
00601         <font class="keywordflow">return</font>;          <font class="comment">/* hum... an overflow probably occured */</font>
00602   
00603     <font class="comment">/* Compute ref */</font>
00604     ref = (<font class="keywordtype">int</font> *)malloc(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*(CT-&gt;NbRows-1));
00605     <font class="keywordflow">for</font>(i=0;i&lt;CT-&gt;NbRows-1;i++)
00606         <font class="keywordflow">for</font>(j=0;j&lt;CT-&gt;NbColumns;j++)
00607             <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(CT-&gt;p[i][j]))<font class="keyword"> </font>{
00608                 ref[i] = j;
00609                 <font class="keywordflow">break</font>;
00610             }
00611   
00612     <font class="comment">/* Transform the references in e, using ref */</font>
00613     <a class="code" href="ehrhart_8c~.html#a17">aep_evalue</a>(e,ref);
00614     free( ref );
00615     <font class="keywordflow">return</font>;
00616 } <font class="comment">/* addeliminatedparams_evalue */</font>
00617 <font class="comment"></font>
00618 <font class="comment">/** </font>
00619 <font class="comment"></font>
00620 <font class="comment">This procedure finds an integer point contained in polyhedron D /</font>
00621 <font class="comment">first checks for positive values, then for negative values returns</font>
00622 <font class="comment">TRUE on success. Result is in min.  returns FALSE if no integer point</font>
00623 <font class="comment">is found</font>
00624 <font class="comment"></font>
00625 <font class="comment">&lt;p&gt;</font>
00626 <font class="comment"></font>
00627 <font class="comment">This is the maximum number of iterations for a given parameter to find</font>
00628 <font class="comment">a integer point inside the context. Kind of weird. cherche_min should</font>
00629 <font class="comment"></font>
00630 <font class="comment">&lt;p&gt;</font>
00631 <font class="comment"></font>
00632 <font class="comment">@param min</font>
00633 <font class="comment">@param D</font>
00634 <font class="comment">@param pos</font>
00635 <font class="comment"></font>
00636 <font class="comment">*/</font>
00637  <font class="comment">//FIXME: needs to be rewritten !</font>
<a name="l00638"></a><a class="code" href="ehrhart_8c.html#a4">00638</a> <font class="preprocessor">#define MAXITER 100</font>
<a name="l00639"></a><a class="code" href="ehrhart_8c.html#a19">00639</a> <font class="preprocessor"></font><font class="keywordtype">int</font> <a class="code" href="ehrhart_8c~.html#a19">cherche_min</a>(Value *min,Polyhedron *D,<font class="keywordtype">int</font> pos)<font class="keyword"> </font>{
00640         
00641     Value binf, bsup;   <font class="comment">/* upper &amp; lower bound */</font>
00642     Value i;
00643     <font class="keywordtype">int</font> flag, maxiter;
00644   
00645     <font class="keywordflow">if</font>(!D)
00646         <font class="keywordflow">return</font>(1);
00647     <font class="keywordflow">if</font>(pos &gt; D-&gt;Dimension)
00648         <font class="keywordflow">return</font>(1);
00649   
00650     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(binf); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(bsup);
00651     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(i);
00652   
00653 <font class="preprocessor">#ifdef EDEBUG61</font>
00654 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"Entering Cherche min --&gt; \n"</font>);
00655     fprintf(stderr,<font class="stringliteral">"LowerUpperBounds :\n"</font>);
00656     fprintf(stderr,<font class="stringliteral">"pos = %d\n"</font>,pos);
00657     fprintf(stderr,<font class="stringliteral">"current min = ("</font>);
00658     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,min[0]);
00659     {<font class="keywordtype">int</font> j;
00660     <font class="keywordflow">for</font>(j=1;j&lt;=D-&gt;Dimension ; j++) {
00661         fprintf(stderr,<font class="stringliteral">", "</font>);
00662         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,min[j]);
00663     }  
00664     }
00665     fprintf(stderr,<font class="stringliteral">")\n"</font>);
00666 <font class="preprocessor">#endif</font>
00667 <font class="preprocessor"></font>        
00668     flag = <a class="code" href="polyhedron_8c.html#a49">lower_upper_bounds</a>(pos,D,min,&amp;binf,&amp;bsup);
00669   
00670 <font class="preprocessor">#ifdef EDEBUG61</font>
00671 <font class="preprocessor"></font>    fprintf(stderr, <font class="stringliteral">"flag = %d\n"</font>, flag);
00672     fprintf(stderr,<font class="stringliteral">"binf = "</font>);
00673     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,binf);
00674     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00675     fprintf(stderr,<font class="stringliteral">"bsup = "</font>);
00676     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,bsup);
00677     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00678 <font class="preprocessor">#endif</font>
00679 <font class="preprocessor"></font>
00680     <font class="keywordflow">if</font>(flag&amp;LB_INFINITY)
00681         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(binf,0);
00682   
00683     <font class="comment">/* Loop from 0 (or binf if positive) to bsup */</font>
00684     <font class="keywordflow">for</font>(maxiter=0,(((flag&amp;LB_INFINITY) || <a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(binf)) ? 
00685             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(i,0) : <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(i,binf));
00686         ((flag&amp;UB_INFINITY) || <a class="code" href="arithmetique_8h.html#a27">value_le</a>(i,bsup)) &amp;&amp; maxiter&lt;MAXITER ;
00687         <a class="code" href="arithmetique_8h.html#a45">value_increment</a>(i,i),maxiter++)<font class="keyword"> </font>{
00688     
00689         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(min[pos],i);
00690         <font class="keywordflow">if</font>(<a class="code" href="ehrhart_8c~.html#a19">cherche_min</a>(min,D-&gt;next,pos+1))<font class="keyword"> </font>{
00691             <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(binf); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(bsup);
00692             <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(i);
00693             <font class="keywordflow">return</font>(1);
00694         }  
00695     }
00696   
00697     <font class="comment">/* Descending loop from -1 (or bsup if negative) to binf */</font>
00698     <font class="keywordflow">if</font>((flag&amp;LB_INFINITY) || <a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(binf))
00699         <font class="keywordflow">for</font>(maxiter=0,(((flag&amp;UB_INFINITY) || <a class="code" href="arithmetique_8h.html#a63">value_pos_p</a>(bsup))?
00700                 <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(i,-1)
00701                 :<a class="code" href="arithmetique_8h.html#a11">value_assign</a>(i,bsup));
00702             ((flag&amp;LB_INFINITY) || <a class="code" href="arithmetique_8h.html#a25">value_ge</a>(i,binf)) &amp;&amp; maxiter&lt;MAXITER  ;
00703             <a class="code" href="arithmetique_8h.html#a50">value_decrement</a>(i,i),maxiter++)<font class="keyword"> </font>{
00704 
00705             <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(min[pos],i);
00706             <font class="keywordflow">if</font>(<a class="code" href="ehrhart_8c~.html#a19">cherche_min</a>(min,D-&gt;next,pos+1))<font class="keyword"> </font>{
00707                 <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(binf); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(bsup);
00708                 <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(i);
00709                 <font class="keywordflow">return</font>(1);
00710             }   
00711         }
00712     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(binf); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(bsup);
00713     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(i);
00714 
00715     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(min[pos],0);
00716     <font class="keywordflow">return</font>(0);       <font class="comment">/* not found :-( */</font>
00717 } <font class="comment">/* cherche_min */</font>
00718 <font class="comment"></font>
00719 <font class="comment">/** </font>
00720 <font class="comment"></font>
00721 <font class="comment">This procedure finds the smallest parallelepiped of size</font>
00722 <font class="comment">'&lt;i&gt;size[i]&lt;/i&gt;' for every dimension i, contained in polyhedron D If</font>
00723 <font class="comment">this is not possible, an empty polyhedron is returned</font>
00724 <font class="comment"></font>
00725 <font class="comment">&lt;p&gt;</font>
00726 <font class="comment"></font>
00727 <font class="comment">&lt;pre&gt;</font>
00728 <font class="comment">written by vin100, 2000, for version 4.19</font>
00729 <font class="comment">modified 2002, version 5.10</font>
00730 <font class="comment">&lt;/pre&gt;</font>
00731 <font class="comment"></font>
00732 <font class="comment">&lt;p&gt;</font>
00733 <font class="comment"></font>
00734 <font class="comment">It first finds the coordinates of the lexicographically smallest edge</font>
00735 <font class="comment">of the hypercube, obtained by transforming the constraints of D (by</font>
00736 <font class="comment">adding 'size' as many times as there are negative coeficients in each</font>
00737 <font class="comment">constraint), and finding the lexicographical min of this</font>
00738 <font class="comment">polyhedron. Then it builds the hypercube and returns it.</font>
00739 <font class="comment"></font>
00740 <font class="comment">&lt;p&gt;</font>
00741 <font class="comment">@param D</font>
00742 <font class="comment">@param size</font>
00743 <font class="comment">@param MAXRAYS</font>
00744 <font class="comment"></font>
00745 <font class="comment">*/</font>
00746 
<a name="l00747"></a><a class="code" href="ehrhart_8c.html#a20">00747</a> Polyhedron *<a class="code" href="ehrhart_8c~.html#a20">Polyhedron_Preprocess</a>(Polyhedron *D,Value *size,<font class="keywordtype">unsigned</font> <a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>)<font class="keyword"></font>
00748 <font class="keyword"></font>{
00749     Matrix *M;
00750     <font class="keywordtype">int</font> i, j, d;
00751     Polyhedron *T, *S, *H, *C;
00752     Value *min,tmp;
00753   
00754     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
00755     d = D-&gt;Dimension;
00756     M = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>, D-&gt;Dimension+2);
00757     M-&gt;NbRows = D-&gt;NbConstraints;
00758   
00759     <font class="comment">/* Original constraints */</font>
00760     <font class="keywordflow">for</font>(i=0;i&lt;D-&gt;NbConstraints;i++)
00761         <a class="code" href="vector_8c.html#a11">Vector_Copy</a>(D-&gt;Constraint[i],M-&gt;p[i],(d+2));
00762 
00763 <font class="preprocessor">#ifdef EDEBUG6</font>
00764 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"M for PreProcess : "</font>);
00765     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,M);
00766     fprintf(stderr,<font class="stringliteral">"\nsize == "</font>);
00767     <font class="keywordflow">for</font>( i=0 ; i&lt;d ; i++ )
00768         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,size[i]);
00769     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00770 <font class="preprocessor">#endif</font>
00771 <font class="preprocessor"></font>
00772     <font class="comment">/* Additionnal constraints */</font>
00773     <font class="keywordflow">for</font>(i=0;i&lt;D-&gt;NbConstraints;i++) {
00774         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(D-&gt;Constraint[i][0]))<font class="keyword"> </font>{
00775             fprintf(stderr,<font class="stringliteral">"Polyhedron_Preprocess: "</font>);
00776             fprintf(stderr,<font class="stringliteral">"an equality was found where I did expect an inequality.\n"</font>);
00777             fprintf(stderr,<font class="stringliteral">"Trying to continue...\n"</font>);
00778             <font class="keywordflow">continue</font>;
00779         }
00780         <a class="code" href="vector_8c.html#a11">Vector_Copy</a>(D-&gt;Constraint[i],M-&gt;p[M-&gt;NbRows],(d+2));
00781         <font class="keywordflow">for</font>(j=1;j&lt;=d;j++)
00782             <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(D-&gt;Constraint[i][j]))<font class="keyword"> </font>{
00783                 <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(tmp,D-&gt;Constraint[i][j],size[j-1]);
00784                 <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(M-&gt;p[M-&gt;NbRows][d+1],M-&gt;p[M-&gt;NbRows][d+1],tmp);
00785             }
00786     
00787         <font class="comment">/* If anything changed, add this new constraint */</font>
00788         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a23">value_ne</a>(M-&gt;p[M-&gt;NbRows][d+1],D-&gt;Constraint[i][d+1]))
00789             M-&gt;NbRows ++ ;
00790     }
00791   
00792 <font class="preprocessor">#ifdef EDEBUG6</font>
00793 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"M used to find min : "</font>);
00794     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,M);
00795 <font class="preprocessor">#endif</font>
00796 <font class="preprocessor"></font>  
00797     T = <a class="code" href="polyhedron_8c.html#a24">Constraints2Polyhedron</a>(M,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
00798     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(M);
00799     <font class="keywordflow">if</font> (!T || emptyQ(T))<font class="keyword"> </font>{
00800         <font class="keywordflow">if</font>(T)
00801             <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(T);
00802         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00803         <font class="keywordflow">return</font>(NULL);
00804     }
00805   
00806     <font class="comment">/* Ok, now find the lexicographical min of T */</font>
00807     min = (Value *) malloc(<font class="keyword">sizeof</font>(Value) * (d+2));
00808     <font class="keywordflow">for</font>(i=0;i&lt;=d;i++) {
00809         <a class="code" href="arithmetique_8h.html#a10">value_init</a>(min[i]);
00810         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(min[i],0);
00811     }  
00812     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(min[i]);
00813     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(min[i],1);
00814     C = <a class="code" href="polyhedron_8c.html#a23">Universe_Polyhedron</a>(0);
00815     S = <a class="code" href="polyhedron_8c.html#a48">Polyhedron_Scan</a>(T,C,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
00816     <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(C);
00817     <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(T);
00818 
00819 <font class="preprocessor">#ifdef EDEBUG6</font>
00820 <font class="preprocessor"></font>    <font class="keywordflow">for</font>(i=0;i&lt;=(d+1);i++) {
00821         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,min[i]);
00822         fprintf(stderr,<font class="stringliteral">" ,"</font>);
00823     }
00824     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00825     <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,S);
00826     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00827 <font class="preprocessor">#endif</font>
00828 <font class="preprocessor"></font>    
00829     <font class="keywordflow">if</font> (!<a class="code" href="ehrhart_8c~.html#a19">cherche_min</a>(min,S,1))<font class="keyword"></font>
00830 <font class="keyword">        </font>{
00831             <font class="keywordflow">for</font>(i=0;i&lt;=(d+1);i++)
00832                 <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(min[i]);
00833             <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00834             <font class="keywordflow">return</font>(NULL);
00835         }
00836     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(S);
00837   
00838 <font class="preprocessor">#ifdef EDEBUG6</font>
00839 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"min = ( "</font>);
00840     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,min[1]);
00841     <font class="keywordflow">for</font>(i=2;i&lt;=d;i++) {
00842         fprintf(stderr,<font class="stringliteral">", "</font>);
00843         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,min[i]);
00844     }  
00845     fprintf(stderr,<font class="stringliteral">")\n"</font>);
00846 <font class="preprocessor">#endif</font>
00847 <font class="preprocessor"></font>  
00848     <font class="comment">/* Min is the point from which we can construct the hypercube */</font>
00849     M = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(d*2,d+2);
00850     <font class="keywordflow">for</font>(i=0;i&lt;d;i++) {
00851     
00852         <font class="comment">/* Creates inequality  1 0..0 1 0..0 -min[i+1] */</font>
00853         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i][0],1);
00854         <font class="keywordflow">for</font>(j=1;j&lt;=d;j++)
00855             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i][j],0);
00856         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i][i+1],1);
00857         <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(M-&gt;p[2*i][d+1],min[i+1]);
00858     
00859         <font class="comment">/* Creates inequality  1 0..0 -1 0..0 min[i+1]+size -1 */</font>
00860         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i+1][0],1);
00861         <font class="keywordflow">for</font>(j=1;j&lt;=d;j++)
00862             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i+1][j],0);
00863         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[2*i+1][i+1],-1);
00864         <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(M-&gt;p[2*i+1][d+1],min[i+1],size[i]);
00865         <a class="code" href="arithmetique_8h.html#a49">value_sub_int</a>(M-&gt;p[2*i+1][d+1],M-&gt;p[2*i+1][d+1],1);
00866     }
00867   
00868 <font class="preprocessor">#ifdef EDEBUG6</font>
00869 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"PolyhedronPreprocess: constraints H = "</font>);
00870     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,M);
00871 <font class="preprocessor">#endif</font>
00872 <font class="preprocessor"></font>  
00873     H = <a class="code" href="polyhedron_8c.html#a24">Constraints2Polyhedron</a>(M,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
00874   
00875 <font class="preprocessor">#ifdef EDEBUG6</font>
00876 <font class="preprocessor"></font>    <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,H);
00877     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00878 <font class="preprocessor">#endif</font>
00879 <font class="preprocessor"></font>  
00880     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(M);
00881     <font class="keywordflow">for</font>(i=0;i&lt;=(d+1);i++)
00882         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(min[i]);
00883     free(min);
00884     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00885     <font class="keywordflow">return</font>(H);
00886 } <font class="comment">/* Polyhedron_Preprocess */</font>
00887 <font class="comment"></font>
00888 <font class="comment">/** This procedure finds an hypercube of size 'size', containing</font>
00889 <font class="comment">polyhedron D increases size and lcm if necessary (and not "too big")</font>
00890 <font class="comment">If this is not possible, an empty polyhedron is returned</font>
00891 <font class="comment"></font>
00892 <font class="comment">&lt;p&gt;</font>
00893 <font class="comment"></font>
00894 <font class="comment">&lt;pre&gt; written by vin100, 2001, for version 4.19&lt;/pre&gt;</font>
00895 <font class="comment"></font>
00896 <font class="comment">@param D</font>
00897 <font class="comment">@param size</font>
00898 <font class="comment">@param lcm</font>
00899 <font class="comment">@param MAXRAYS</font>
00900 <font class="comment"></font>
00901 <font class="comment">*/</font>
<a name="l00902"></a><a class="code" href="ehrhart_8c.html#a21">00902</a> Polyhedron *<a class="code" href="ehrhart_8c~.html#a21">Polyhedron_Preprocess2</a>(Polyhedron *D,Value *size,Value *lcm,<font class="keywordtype">unsigned</font> <a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>)<font class="keyword"> </font>{
00903   
00904     Matrix *c;
00905     Polyhedron *H;
00906     <font class="keywordtype">int</font> i,j,r;
00907     Value <a class="code" href="polyparam_8c.html#a2">n</a>;      <font class="comment">/* smallest/biggest value */</font>
00908     Value s;    <font class="comment">/* size in this dimension */</font>
00909     Value tmp1,tmp2;
00910 
00911 <font class="preprocessor">#ifdef EDEBUG62</font>
00912 <font class="preprocessor"></font>    <font class="keywordtype">int</font> np;
00913 <font class="preprocessor">#endif</font>
00914 <font class="preprocessor"></font>
00915     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(<a class="code" href="polyparam_8c.html#a2">n</a>); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(s);
00916     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp1); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp2);
00917     c = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(D-&gt;Dimension*2,D-&gt;Dimension+2);
00918   
00919 <font class="preprocessor">#ifdef EDEBUG62</font>
00920 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"\nPreProcess2 : starting\n"</font>);
00921     fprintf(stderr,<font class="stringliteral">"lcm = "</font>);
00922     <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
00923         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm[np]);
00924     fprintf(stderr,<font class="stringliteral">", size = "</font>);
00925     <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
00926         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,size[np]);
00927     fprintf(stderr,<font class="stringliteral">"\n"</font>);
00928 <font class="preprocessor">#endif</font>
00929 <font class="preprocessor"></font>  
00930     <font class="keywordflow">for</font>(i=0;i&lt;D-&gt;Dimension;i++) {
00931     
00932         <font class="comment">/* Create constraint 1 0..0 1 0..0 -min */</font>
00933         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i][0],1);
00934         <font class="keywordflow">for</font>(j=0;j&lt;D-&gt;Dimension;j++)
00935             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i][1+j],0);
00936         <a class="code" href="arithmetique_8h.html#a51">value_division</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,D-&gt;Ray[0][i+1],D-&gt;Ray[0][D-&gt;Dimension+1]);
00937         <font class="keywordflow">for</font>(r=1;r&lt;D-&gt;NbRays;r++) {
00938             <a class="code" href="arithmetique_8h.html#a51">value_division</a>(tmp1,D-&gt;Ray[r][i+1],D-&gt;Ray[r][D-&gt;Dimension+1]);
00939             <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a24">value_gt</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,tmp1))<font class="keyword"> </font>{
00940         
00941                 <font class="comment">/* New min */</font>
00942                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,D-&gt;Ray[r][i+1],D-&gt;Ray[r][D-&gt;Dimension+1]);
00943             }
00944         }
00945         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i][i+1],1);
00946         <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(c-&gt;p[2*i][D-&gt;Dimension+1],<a class="code" href="polyparam_8c.html#a2">n</a>);
00947     
00948         <font class="comment">/* Create constraint 1 0..0 -1 0..0 max */</font>
00949         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i+1][0],1);
00950         <font class="keywordflow">for</font>(j=0;j&lt;D-&gt;Dimension;j++)
00951             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i+1][1+j],0);
00952     
00953         <font class="comment">/* n = (num+den-1)/den */</font>
00954         <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp1,D-&gt;Ray[0][i+1],D-&gt;Ray[0][D-&gt;Dimension+1]);
00955         <a class="code" href="arithmetique_8h.html#a49">value_sub_int</a>(tmp1,tmp1,1);
00956         <a class="code" href="arithmetique_8h.html#a51">value_division</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,tmp1,D-&gt;Ray[0][D-&gt;Dimension+1]);
00957         <font class="keywordflow">for</font>(r=1;r&lt;D-&gt;NbRays;r++) {
00958             <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp1,D-&gt;Ray[r][i+1],D-&gt;Ray[r][D-&gt;Dimension+1]);
00959             <a class="code" href="arithmetique_8h.html#a49">value_sub_int</a>(tmp1,tmp1,1);
00960             <a class="code" href="arithmetique_8h.html#a51">value_division</a>(tmp1,tmp1,D-&gt;Ray[r][D-&gt;Dimension+1]);
00961             <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,tmp1))<font class="keyword"> </font>{
00962         
00963                 <font class="comment">/* New max */</font>
00964                 <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp1,D-&gt;Ray[r][i+1],D-&gt;Ray[r][D-&gt;Dimension+1]);
00965                 <a class="code" href="arithmetique_8h.html#a49">value_sub_int</a>(tmp1,tmp1,1);
00966                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,tmp1,D-&gt;Ray[r][D-&gt;Dimension+1]);
00967             }
00968         }
00969         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(c-&gt;p[2*i+1][i+1],-1);
00970         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(c-&gt;p[2*i+1][D-&gt;Dimension+1],<a class="code" href="polyparam_8c.html#a2">n</a>);
00971         <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(s,c-&gt;p[2*i+1][D-&gt;Dimension+1],c-&gt;p[2*i][D-&gt;Dimension+1]);
00972     
00973         <font class="comment">/* Now test if the dimension of the cube is greater than the size */</font>
00974         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a24">value_gt</a>(s,size[i]))<font class="keyword"> </font>{
00975       
00976 <font class="preprocessor">#ifdef EDEBUG62</font>
00977 <font class="preprocessor"></font>            fprintf(stderr,<font class="stringliteral">"size on dimension %d\n"</font>,i);
00978             fprintf(stderr,<font class="stringliteral">"lcm = "</font>);
00979             <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
00980                 <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm[np]);
00981             fprintf(stderr,<font class="stringliteral">", size = "</font>);
00982             <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
00983                 <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,size[np]);
00984             fprintf(stderr,<font class="stringliteral">"\n"</font>);
00985             fprintf(stderr,<font class="stringliteral">"required size (s) = "</font>);
00986             <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,s);
00987             fprintf(stderr,<font class="stringliteral">"\n"</font>);
00988 <font class="preprocessor">#endif</font>
00989 <font class="preprocessor"></font>      
00990             <font class="comment">/* If the needed size is "small enough"(&lt;=20 or less than twice *size) */</font>
00991             <font class="comment">/* then increase *size, and artificially increase lcm too !*/</font>
00992             <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(tmp1,20);
00993             <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp2,size[i],size[i]);
00994             <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a27">value_le</a>(s,tmp1)
00995                     || <a class="code" href="arithmetique_8h.html#a27">value_le</a>(s,tmp2))<font class="keyword"> </font>{
00996 
00997                 <font class="keywordflow">if</font>( <a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(lcm[i]) )
00998                     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(lcm[i],1);
00999                 <font class="comment">/* lcm divides size... */</font>
01000                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(tmp1,size[i],lcm[i]);
01001         
01002                 <font class="comment">/* lcm = ceil(s/h) */</font>
01003                 <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp2,s,tmp1);
01004                 <a class="code" href="arithmetique_8h.html#a44">value_add_int</a>(tmp2,tmp2,1);
01005                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(lcm[i],tmp2,tmp1);
01006         
01007                 <font class="comment">/* new size = lcm*h */</font>
01008                 <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(size[i],lcm[i],tmp1);
01009         
01010 <font class="preprocessor">#ifdef EDEBUG62</font>
01011 <font class="preprocessor"></font>                fprintf(stderr,<font class="stringliteral">"new size = "</font>);
01012                 <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
01013                     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,size[np]);
01014                 fprintf(stderr,<font class="stringliteral">", new lcm = "</font>);
01015                 <font class="keywordflow">for</font>( np=0 ; np&lt;D-&gt;Dimension; np++ )
01016                     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm[np]);
01017                 fprintf(stderr,<font class="stringliteral">"\n"</font>);
01018 <font class="preprocessor">#endif</font>
01019 <font class="preprocessor"></font>
01020             }
01021             <font class="keywordflow">else</font> {
01022         
01023 <font class="preprocessor">#ifdef EDEBUG62</font>
01024 <font class="preprocessor"></font>                fprintf(stderr,<font class="stringliteral">"Failed on dimension %d.\n"</font>,i);
01025 <font class="preprocessor">#endif</font>
01026 <font class="preprocessor"></font>                <font class="keywordflow">break</font>;
01027             }
01028         }
01029     }
01030     <font class="keywordflow">if</font>(i!=D-&gt;Dimension) {
01031         <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(c);
01032         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(<a class="code" href="polyparam_8c.html#a2">n</a>); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(s);
01033         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp2);
01034         <font class="keywordflow">return</font>(NULL);
01035     }
01036     <font class="keywordflow">for</font>(i=0;i&lt;D-&gt;Dimension;i++) {
01037         <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(c-&gt;p[2*i+1][D-&gt;Dimension+1],size[i], 
01038                 c-&gt;p[2*i][D-&gt;Dimension+1]);
01039     }
01040   
01041 <font class="preprocessor">#ifdef EDEBUG62</font>
01042 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"PreProcess2 : c ="</font>);
01043     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,c);
01044 <font class="preprocessor">#endif</font>
01045 <font class="preprocessor"></font>
01046     H = <a class="code" href="polyhedron_8c.html#a24">Constraints2Polyhedron</a>(c,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01047     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(c);
01048     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(<a class="code" href="polyparam_8c.html#a2">n</a>); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(s);
01049     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp2);
01050     <font class="keywordflow">return</font>(H);
01051 } <font class="comment">/* Polyhedron_Preprocess2 */</font>
01052 <font class="comment"></font>
01053 <font class="comment">/**  </font>
01054 <font class="comment"></font>
01055 <font class="comment">This procedure adds additional constraints to D so that as each</font>
01056 <font class="comment">parameter is scanned, it will have a minimum of 'size' points If this</font>
01057 <font class="comment">is not possible, an empty polyhedron is returned</font>
01058 <font class="comment"></font>
01059 <font class="comment">@param D</font>
01060 <font class="comment">@param size</font>
01061 <font class="comment">@param MAXRAYS</font>
01062 <font class="comment"></font>
01063 <font class="comment">*/</font>
<a name="l01064"></a><a class="code" href="ehrhart_8c.html#a22">01064</a> Polyhedron *<a class="code" href="ehrhart_8c~.html#a22">old_Polyhedron_Preprocess</a>(Polyhedron *D,Value size,<font class="keywordtype">unsigned</font> <a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>)<font class="keyword"> </font>{
01065   
01066     <font class="keywordtype">int</font> p, p1, ub, lb;
01067     Value a, a1, b, b1, g, aa;
01068     Value abs_a, abs_b, size_copy;
01069     <font class="keywordtype">int</font> dim, con, <font class="keyword">new</font>, needed;
01070     Value **C;
01071     Matrix *M;
01072     Polyhedron *D1;
01073   
01074     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(a); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(a1); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(b);
01075     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(b1); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(g); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(aa);
01076     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(abs_a); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(abs_b); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(size_copy);
01077   
01078     dim = D-&gt;Dimension;
01079     con = D-&gt;NbConstraints;
01080     M = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>,dim+2);
01081     <font class="keyword">new</font> = 0;
01082     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(size_copy,size);
01083     C = D-&gt;Constraint;
01084     <font class="keywordflow">for</font> (p=1; p&lt;=dim; p++) {
01085         <font class="keywordflow">for</font> (ub=0; ub&lt;con; ub++) {
01086             <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(a,C[ub][p]);
01087             <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a65">value_posz_p</a>(a))        <font class="comment">/* a &gt;= 0 */</font>
01088                 <font class="keywordflow">continue</font>;               <font class="comment">/* not an upper bound */</font>
01089             <font class="keywordflow">for</font> (lb=0;lb&lt;con;lb++) {
01090                 <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(b,C[lb][p]);
01091                 <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a66">value_negz_p</a>(b))
01092                     <font class="keywordflow">continue</font>;   <font class="comment">/* not a lower bound */</font>
01093         
01094                 <font class="comment">/* Check if a new constraint is needed for this (ub,lb) pair */</font>
01095                 <font class="comment">/* a constraint is only needed if a previously scanned */</font>
01096                 <font class="comment">/* parameter (1..p-1) constrains this parameter (p) */</font>
01097                 needed=0;
01098                 <font class="keywordflow">for</font> (p1=1; p1&lt;p; p1++) {
01099                     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(C[ub][p1]) || <a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(C[lb][p1]))<font class="keyword"> </font>{
01100                         needed=1; 
01101                         <font class="keywordflow">break</font>;
01102                     }
01103                 }
01104                 <font class="keywordflow">if</font> (!needed) <font class="keywordflow">continue</font>;  
01105                 <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(abs_a,a);
01106                 <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(abs_b,b);
01107 
01108                 <font class="comment">/* Create new constraint: b*UB-a*LB &gt;= a*b*size */</font>
01109                 <a class="code" href="vector_8c.html#a3">Gcd</a>(abs_a,abs_b,&amp;g);
01110                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(a1,a,g);
01111                 <a class="code" href="arithmetique_8h.html#a51">value_division</a>(b1,b,g);
01112                 <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(M-&gt;p[<font class="keyword">new</font>][0],1);
01113                 <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(abs_a,a1);           <font class="comment">/* abs_a = -a1 */</font>
01114                 <a class="code" href="vector_8c.html#a20">Vector_Combine</a>(&amp;(C[ub][1]),&amp;(C[lb][1]),&amp;(M-&gt;p[<font class="keyword">new</font>][1]),
01115                         b1,abs_a,dim+1);
01116                 <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(aa,a1,b1);
01117                 <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(abs_a,aa,size_copy);
01118                 <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(M-&gt;p[<font class="keyword">new</font>][dim+1],M-&gt;p[<font class="keyword">new</font>][dim+1],abs_a);
01119                 <a class="code" href="vector_8c.html#a25">Vector_Normalize</a>(&amp;(M-&gt;p[<font class="keyword">new</font>][1]),(dim+1));
01120                 <font class="keyword">new</font>++;
01121             }
01122         }
01123     }
01124     D1 = <a class="code" href="polyhedron_8c.html#a28">AddConstraints</a>(M-&gt;p_Init,<font class="keyword">new</font>,D,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01125     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(M);
01126   
01127     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(a); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(a1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(b);
01128     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(b1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(aa);
01129     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(abs_a); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(abs_b); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(size_copy);
01130     <font class="keywordflow">return</font> D1;
01131 } <font class="comment">/* old_Polyhedron_Preprocess */</font>
01132 <font class="comment"></font>
01133 <font class="comment">/** </font>
01134 <font class="comment"></font>
01135 <font class="comment">PROCEDURES TO COMPUTE ENUMERATION. recursive procedure, recurse for</font>
01136 <font class="comment">each imbriquation</font>
01137 <font class="comment"></font>
01138 <font class="comment">@param pos index position of current loop index (1..hdim-1)</font>
01139 <font class="comment">@param P loop domain</font>
01140 <font class="comment">@param context context values for fixed indices </font>
01141 <font class="comment">@return the number of integer points in this</font>
01142 <font class="comment">polyhedron </font>
01143 <font class="comment"></font>
01144 <font class="comment">*/</font>
<a name="l01145"></a><a class="code" href="ehrhart_8c.html#a23">01145</a> <font class="keywordtype">int</font> <a class="code" href="ehrhart_8c~.html#a23">count_points</a> (<font class="keywordtype">int</font> pos,Polyhedron *P,Value *context)<font class="keyword"> </font>{
01146    
01147     Value LB, UB, k;
01148     <font class="keywordtype">int</font> CNT,result;
01149 
01150     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(LB); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(UB); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(k);
01151     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(LB,0);
01152     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(UB,0);
01153 
01154     <font class="keywordflow">if</font> (<a class="code" href="polyhedron_8c.html#a49">lower_upper_bounds</a>(pos,P,context,&amp;LB,&amp;UB) !=0)<font class="keyword"> </font>{
01155     
01156         <font class="comment">/* Problem if UB or LB is INFINITY */</font>
01157         fprintf(stderr, <font class="stringliteral">"count_points: ? infinite domain\n"</font>);
01158         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(LB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(UB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k);
01159         <font class="keywordflow">return</font> -1;
01160     }
01161   
01162 <font class="preprocessor">#ifdef EDEBUG1</font>
01163 <font class="preprocessor"></font>    <font class="keywordflow">if</font> (!P-&gt;next) {
01164         <font class="keywordtype">int</font> i;
01165         <font class="keywordflow">for</font> (<a class="code" href="arithmetique_8h.html#a11">value_assign</a>(k,LB); <a class="code" href="arithmetique_8h.html#a27">value_le</a>(k,UB); <a class="code" href="arithmetique_8h.html#a45">value_increment</a>(k,k))<font class="keyword"> </font>{
01166             fprintf(stderr, <font class="stringliteral">"("</font>);
01167             <font class="keywordflow">for</font> (i=1; i&lt;pos; i++) {
01168                 <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,context[i]);
01169                 fprintf(stderr,<font class="stringliteral">","</font>);
01170             }
01171             <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,k);
01172             fprintf(stderr,<font class="stringliteral">")\n"</font>);
01173         }
01174     }
01175 <font class="preprocessor">#endif</font>
01176 <font class="preprocessor"></font>  
01177     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(context[pos],0);
01178     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(UB,LB))<font class="keyword"> </font>{
01179         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(LB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(UB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k);
01180         <font class="keywordflow">return</font> 0;  
01181     }  
01182     <font class="keywordflow">if</font> (!P-&gt;next) {
01183         <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(k,UB,LB);
01184         <a class="code" href="arithmetique_8h.html#a44">value_add_int</a>(k,k,1);
01185         result = <a class="code" href="arithmetique_8h.html#a7">VALUE_TO_INT</a>(k);
01186         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(LB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(UB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k);
01187         <font class="keywordflow">return</font> (result);
01188     } 
01189 
01190     <font class="comment">/*-----------------------------------------------------------------*/</font>
01191     <font class="comment">/* Optimization idea                                               */</font>
01192     <font class="comment">/*   If inner loops are not a function of k (the current index)    */</font>
01193     <font class="comment">/*   i.e. if P-&gt;Constraint[i][pos]==0 for all P following this and */</font>
01194     <font class="comment">/*        for all i,                                               */</font>
01195     <font class="comment">/*   Then CNT = (UB-LB+1)*count_points(pos+1, P-&gt;next, context)    */</font>
01196     <font class="comment">/*   (skip the for loop)                                           */</font>
01197     <font class="comment">/*-----------------------------------------------------------------*/</font>
01198   
01199     CNT = 0;
01200     <font class="keywordflow">for</font> (<a class="code" href="arithmetique_8h.html#a11">value_assign</a>(k,LB);<a class="code" href="arithmetique_8h.html#a27">value_le</a>(k,UB);<a class="code" href="arithmetique_8h.html#a45">value_increment</a>(k,k))<font class="keyword"> </font>{
01201         <font class="keywordtype">int</font> c;
01202     
01203         <font class="comment">/* Insert k in context */</font>
01204         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(context[pos],k);
01205         c = <a class="code" href="ehrhart_8c~.html#a23">count_points</a>(pos+1,P-&gt;next,context);
01206         <font class="keywordflow">if</font>(c!=-1)
01207             CNT = CNT + c;
01208         <font class="keywordflow">else</font> {
01209             CNT=0;
01210             <font class="keywordflow">break</font>;
01211         }
01212     }
01213   
01214 <font class="preprocessor">#ifdef EDEBUG11</font>
01215 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"%d\n"</font>,CNT);
01216 <font class="preprocessor">#endif</font>
01217 <font class="preprocessor"></font>  
01218     <font class="comment">/* Reset context */</font>
01219     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(context[pos],0);
01220     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(LB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(UB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k);
01221     <font class="keywordflow">return</font> CNT;
01222 } <font class="comment">/* count_points */</font>
01223 
01224 <font class="comment">/*------------------------------------------------------------*/</font>
01225 <font class="comment">/* enode *P_Enum(L, LQ, context, pos, nb_param, dim, lcm)     */</font>
01226 <font class="comment">/*     L : list of polyhedra for the loop nest                */</font>
01227 <font class="comment">/*     LQ : list of polyhedra for the parameter loop nest     */</font>
01228 <font class="comment">/*     pos : 1..nb_param, position of the parameter           */</font>
01229 <font class="comment">/*     nb_param : number of parameters total                  */</font>
01230 <font class="comment">/*     dim : total dimension of the polyhedron, param incl.   */</font>
01231 <font class="comment">/*     lcm : denominator array [0..dim-1] of the polyhedron   */</font>
01232 <font class="comment">/* Returns an enode tree representing the pseudo polynomial   */</font>
01233 <font class="comment">/*   expression for the enumeration of the polyhedron.        */</font>
01234 <font class="comment">/* A recursive procedure.                                     */</font>
01235 <font class="comment">/*------------------------------------------------------------*/</font>
<a name="l01236"></a><a class="code" href="ehrhart_8c.html#a24">01236</a> <font class="keyword">static</font> enode *<a class="code" href="ehrhart_8c~.html#a24">P_Enum</a>(Polyhedron *L,Polyhedron *LQ,Value *context,<font class="keywordtype">int</font> pos,<font class="keywordtype">int</font> nb_param,<font class="keywordtype">int</font> dim,Value *lcm)<font class="keyword"> </font>{
01237 
01238   enode *res,*B,*C;
01239   <font class="keywordtype">int</font> hdim,i,j,rank,flag;
01240   Value <a class="code" href="polyparam_8c.html#a2">n</a>,g,nLB,nUB,nlcm,noff,nexp,k1,nm,hdv,k,lcm_copy;
01241   Value tmp;
01242   Matrix *A;
01243 
01244 <font class="preprocessor">#ifdef EDEBUG</font>
01245 <font class="preprocessor"></font>  fprintf(stderr,<font class="stringliteral">"-------------------- begin P_Enum -------------------\n"</font>);
01246   fprintf(stderr,<font class="stringliteral">"Calling P_Enum with pos = %d\n"</font>,pos);
01247 <font class="preprocessor">#endif</font>
01248 <font class="preprocessor"></font>  
01249   <font class="comment">/* Xavier Redon modification: handle the case when there is no parameter */</font>
01250   <font class="keywordflow">if</font>(nb_param==0) {
01251     res=<a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(polynomial,1,0);
01252     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;arr[0].d,1);
01253     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;arr[0].x.n,(count_points(1,L,context)));
01254     <font class="keywordflow">return</font> res;
01255   }
01256   
01257   <font class="comment">/* Initialize all the 'Value' variables */</font>
01258   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(<a class="code" href="polyparam_8c.html#a2">n</a>); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(g); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(nLB);
01259   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(nUB); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(nlcm); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(noff);
01260   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(nexp); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(k1); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(nm);
01261   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(hdv); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(k); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
01262   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(lcm_copy);
01263 
01264   <font class="keywordflow">if</font>( <a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(lcm[pos-1]) )<font class="keyword"></font>
01265 <font class="keyword">  </font>{
01266                 hdim = 1;
01267                 <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>( lcm_copy, 1 );
01268   }
01269   <font class="keywordflow">else</font>
01270   {
01271           <font class="comment">/* hdim is the degree of the polynomial + 1 */</font>
01272                 hdim = dim-nb_param+1;          <font class="comment">/* homogenous dim w/o parameters */</font>
01273                 <a class="code" href="arithmetique_8h.html#a11">value_assign</a>( lcm_copy, lcm[pos-1] );
01274   }  
01275 
01276   <font class="comment">/* code to limit generation of equations to valid parameters only */</font>
01277   <font class="comment">/*----------------------------------------------------------------*/</font>
01278   flag = <a class="code" href="polyhedron_8c.html#a49">lower_upper_bounds</a>(pos,LQ,&amp;context[dim-nb_param],&amp;nLB,&amp;nUB);
01279   <font class="keywordflow">if</font> (flag &amp; LB_INFINITY) {
01280     <font class="keywordflow">if</font> (!(flag &amp; UB_INFINITY)) {
01281       
01282       <font class="comment">/* Only an upper limit: set lower limit */</font>
01283       <font class="comment">/* Compute nLB such that (nUB-nLB+1) &gt;= (hdim*lcm) */</font>
01284       <a class="code" href="arithmetique_8h.html#a49">value_sub_int</a>(nLB,nUB,1);
01285       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(hdv,hdim);
01286       <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(tmp,hdv,lcm_copy);
01287       <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(nLB,nLB,tmp);
01288       <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a63">value_pos_p</a>(nLB))
01289         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(nLB,0);
01290     }
01291     <font class="keywordflow">else</font> {
01292       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(nLB,0);
01293       
01294       <font class="comment">/* No upper nor lower limit: set lower limit to 0 */</font>
01295       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(hdv,hdim);
01296       <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(nUB,hdv,lcm_copy);
01297       <a class="code" href="arithmetique_8h.html#a44">value_add_int</a>(nUB,nUB,1);
01298     }
01299   }
01300 
01301   <font class="comment">/* if (nUB-nLB+1) &lt; (hdim*lcm) then we have more unknowns than equations */</font>
01302   <font class="comment">/* We can: 1. Find more equations by changing the context parameters, or */</font>
01303   <font class="comment">/* 2. Assign extra unknowns values in such a way as to simplify result.  */</font>
01304   <font class="comment">/* Think about ways to scan parameter space to get as much info out of it*/</font>
01305   <font class="comment">/* as possible.                                                          */</font>
01306   
01307 <font class="preprocessor">#ifdef REDUCE_DEGREE</font>
01308 <font class="preprocessor"></font>  <font class="keywordflow">if</font> (pos==1 &amp;&amp; (flag &amp; UB_INFINITY)==0) {
01309     <font class="comment">/* only for finite upper bound on first parameter */</font>
01310     <font class="comment">/* NOTE: only first parameter because subsequent parameters may</font>
01311 <font class="comment">       be artificially limited by the choice of the first parameter */</font>
01312    
01313 <font class="preprocessor">#ifdef EDEBUG</font>
01314 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"*************** n **********\n"</font>);
01315     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01316     fprintf(stderr,<font class="stringliteral">"\n"</font>);
01317 <font class="preprocessor">#endif</font>
01318 <font class="preprocessor"></font>
01319     <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,nUB,nLB);
01320     <a class="code" href="arithmetique_8h.html#a45">value_increment</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01321     
01322 <font class="preprocessor">#ifdef EDEBUG </font>
01323 <font class="preprocessor"></font>    <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01324     fprintf(stderr,<font class="stringliteral">"\n*************** n ************\n"</font>);
01325 <font class="preprocessor">#endif </font>
01326 <font class="preprocessor"></font>
01327     <font class="comment">/* Total number of samples&gt;0 */</font>
01328     <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(<a class="code" href="polyparam_8c.html#a2">n</a>))
01329       i=0;
01330     <font class="keywordflow">else</font> {
01331       <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(tmp,<a class="code" href="polyparam_8c.html#a2">n</a>,lcm_copy);
01332       <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(tmp))<font class="keyword"> </font>{
01333                   <a class="code" href="arithmetique_8h.html#a51">value_division</a>(tmp,<a class="code" href="polyparam_8c.html#a2">n</a>,lcm_copy);
01334                   <a class="code" href="arithmetique_8h.html#a45">value_increment</a>(tmp,tmp);
01335                   i = <a class="code" href="arithmetique_8h.html#a7">VALUE_TO_INT</a>(tmp);
01336       }
01337       <font class="keywordflow">else</font> {
01338                   <a class="code" href="arithmetique_8h.html#a51">value_division</a>(tmp,<a class="code" href="polyparam_8c.html#a2">n</a>,lcm_copy);
01339                   i =   <a class="code" href="arithmetique_8h.html#a7">VALUE_TO_INT</a>(tmp);      <font class="comment">/* ceiling of n/lcm */</font>
01340       }
01341     }
01342 
01343 <font class="preprocessor">#ifdef EDEBUG </font>
01344 <font class="preprocessor"></font>    <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01345     fprintf(stderr,<font class="stringliteral">"\n*************** n ************\n"</font>);
01346 <font class="preprocessor">#endif </font>
01347 <font class="preprocessor"></font>    
01348     <font class="comment">/* Reduce degree of polynomial based on number of sample points */</font>
01349     <font class="keywordflow">if</font> (i &lt; hdim){
01350       hdim=i;
01351       
01352 <font class="preprocessor">#ifdef EDEBUG4</font>
01353 <font class="preprocessor"></font>      fprintf(stdout,<font class="stringliteral">"Parameter #%d: LB="</font>,pos);
01354       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,nLB);
01355       fprintf(stdout,<font class="stringliteral">" UB="</font>);
01356       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,nUB);
01357       fprintf(stdout,<font class="stringliteral">" lcm="</font>);
01358       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm_copy);
01359       fprintf(stdout,<font class="stringliteral">" degree reduced to %d\n"</font>,hdim-1);
01360 <font class="preprocessor">#endif</font>
01361 <font class="preprocessor"></font>      
01362     }
01363   }
01364 <font class="preprocessor">#endif </font><font class="comment">/* REDUCE_DEGREE */</font>
01365   
01366   <font class="comment">/* hdim is now set */</font>  
01367   <font class="comment">/* allocate result structure */</font>
01368   res = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(polynomial,hdim,pos);
01369   <font class="keywordflow">for</font> (i=0;i&lt;hdim;i++) {
01370     <font class="keywordtype">int</font> l;
01371     l = <a class="code" href="arithmetique_8h.html#a7">VALUE_TO_INT</a>(lcm_copy);
01372     res-&gt;arr[i].x.p = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(periodic,l,pos);
01373   }
01374   
01375   <font class="comment">/* Utility arrays */</font>
01376   A = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(hdim, 2*hdim+1);                     <font class="comment">/* used for Gauss */</font>
01377   B = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(evector, hdim, 0);
01378   C = <a class="code" href="ehrhart_8c~.html#a7">new_enode</a>(evector, hdim, 0);
01379   
01380   <font class="comment">/*----------------------------------------------------------------*/</font>
01381   <font class="comment">/*                                                                */</font>
01382   <font class="comment">/*                                0&lt;-----+---k---------&gt;          */</font>
01383   <font class="comment">/* |---------noff-----------------&gt;-nlcm-&gt;-------lcm----&gt;         */</font>
01384   <font class="comment">/* |--- . . . -----|--------------|------+-------|------+-------|-*/</font>
01385   <font class="comment">/* 0          (q-1)*lcm         q*lcm    |  (q+1)*lcm   |         */</font>
01386   <font class="comment">/*                                      nLB          nLB+lcm      */</font>
01387   <font class="comment">/*                                                                */</font>
01388   <font class="comment">/*----------------------------------------------------------------*/</font>
01389   <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(nLB))<font class="keyword"> </font>{
01390     <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(nlcm,nLB,lcm_copy);
01391     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(nlcm,nlcm,lcm_copy);
01392   }
01393   <font class="keywordflow">else</font> {
01394     <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(nlcm,nLB,lcm_copy);
01395   }
01396   
01397   <font class="comment">/* noff is a multiple of lcm */</font>
01398   <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(noff,nLB,nlcm);
01399   <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp,lcm_copy,nlcm);
01400   <font class="keywordflow">for</font> (<a class="code" href="arithmetique_8h.html#a11">value_assign</a>(k,nlcm);<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(k,tmp);<a class="code" href="arithmetique_8h.html#a45">value_increment</a>(k,k))<font class="keyword"> </font>{
01401  
01402 <font class="preprocessor">#ifdef EDEBUG</font>
01403 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"Finding "</font>);
01404     <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,k);
01405     fprintf(stderr,<font class="stringliteral">"-th elements of periodic coefficients\n"</font>);
01406 <font class="preprocessor">#endif</font>
01407 <font class="preprocessor"></font>
01408     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(hdv,hdim);
01409     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(nm,hdv,lcm_copy);
01410     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(nm,nm,nLB);
01411     i=0;
01412     <font class="keywordflow">for</font> (<a class="code" href="arithmetique_8h.html#a43">value_addto</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,k,noff); <a class="code" href="arithmetique_8h.html#a26">value_lt</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,nm); <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>,lcm_copy),i++)<font class="keyword"> </font>{
01413       
01414       <font class="comment">/* n == i*lcm + k + noff;   */</font>
01415       <font class="comment">/* nlcm &lt;= k &lt; nlcm+lcm     */</font>
01416       <font class="comment">/* n mod lcm == k1 */</font>
01417       
01418 <font class="preprocessor">#ifdef ALL_OVERFLOW_WARNINGS</font>
01419 <font class="preprocessor"></font>      <font class="keywordflow">if</font> (((flag &amp; UB_INFINITY)==0) &amp;&amp; <a class="code" href="arithmetique_8h.html#a24">value_gt</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,nUB))<font class="keyword"> </font>{
01420         fprintf(stdout,<font class="stringliteral">"Domain Overflow: Parameter #%d:"</font>,pos);
01421         fprintf(stdout,<font class="stringliteral">"nLB="</font>);
01422         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,nLB);
01423         fprintf(stdout,<font class="stringliteral">" n="</font>);
01424         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01425         fprintf(stdout,<font class="stringliteral">" nUB="</font>);
01426         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,nUB);
01427         fprintf(stdout,<font class="stringliteral">"\n"</font>);
01428       }
01429 <font class="preprocessor">#else</font>
01430 <font class="preprocessor"></font>      <font class="keywordflow">if</font> (overflow_warning_flag &amp;&amp; ((flag &amp; UB_INFINITY)==0) &amp;&amp;
01431           <a class="code" href="arithmetique_8h.html#a24">value_gt</a>(<a class="code" href="polyparam_8c.html#a2">n</a>,nUB))<font class="keyword"> </font>{
01432         fprintf(stdout,<font class="stringliteral">"\nWARNING: Parameter Domain Overflow."</font>);
01433         fprintf(stdout,<font class="stringliteral">" Result may be incorrect on this domain.\n"</font>);
01434         overflow_warning_flag = 0;
01435       }
01436 <font class="preprocessor">#endif</font>
01437 <font class="preprocessor"></font>      
01438       <font class="comment">/* Set parameter to n */</font>
01439       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(context[dim-nb_param+pos],<a class="code" href="polyparam_8c.html#a2">n</a>);
01440       
01441 <font class="preprocessor">#ifdef EDEBUG1</font>
01442 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01443 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"%s = "</font>,param_name[pos-1]);
01444       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01445       fprintf(stderr,<font class="stringliteral">" (hdim=%d, lcm[%d]="</font>,hdim,pos-1);
01446       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm_copy);
01447       fprintf(stderr,<font class="stringliteral">")\n"</font>);
01448 <font class="preprocessor">#else</font>
01449 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"P%d = "</font>,pos);
01450       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01451       fprintf(stderr,<font class="stringliteral">" (hdim=%d, lcm[%d]="</font>,hdim,pos-1);
01452       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,lcm_copy);
01453       fprintf(stderr,<font class="stringliteral">")\n"</font>);      
01454 <font class="preprocessor">#endif</font>
01455 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
01456 <font class="preprocessor"></font>      
01457       <font class="comment">/* Setup B vector */</font>
01458       <font class="keywordflow">if</font> (pos==nb_param) {
01459         
01460 <font class="preprocessor">#ifdef EDEBUG   </font>
01461 <font class="preprocessor"></font>        fprintf(stderr,<font class="stringliteral">"Yes\n"</font>);
01462 <font class="preprocessor">#endif </font>
01463 <font class="preprocessor"></font>        
01464         <font class="comment">/* call count */</font>
01465         <font class="comment">/* count can only be called when the context is fully specified */</font>
01466         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(B-&gt;arr[i].d,1);
01467         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(B-&gt;arr[i].x.n,(count_points(1,L,context)));
01468         
01469 <font class="preprocessor">#ifdef EDEBUG3</font>
01470 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (j=1; j&lt;pos; j++) fputs(<font class="stringliteral">"   "</font>,stdout);
01471         fprintf(stdout, <font class="stringliteral">"E("</font>);
01472         <font class="keywordflow">for</font> (j=1; j&lt;nb_param; j++) {
01473           <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,context[dim-nb_param+j]);
01474           fprintf(stdout,<font class="stringliteral">","</font>);
01475         }  
01476         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
01477         fprintf(stdout,<font class="stringliteral">") = "</font>);
01478         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,B-&gt;arr[i].x.n);
01479         fprintf(stdout,<font class="stringliteral">" ="</font>);
01480 <font class="preprocessor">#endif</font>
01481 <font class="preprocessor"></font>        
01482       }
01483       <font class="keywordflow">else</font> {    <font class="comment">/* count is a function of other parameters */</font>
01484         <font class="comment">/* call P_Enum recursively */</font>
01485         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(B-&gt;arr[i].d,0);
01486         B-&gt;arr[i].x.p = <a class="code" href="ehrhart_8c~.html#a24">P_Enum</a>(L,LQ-&gt;next,context,pos+1,nb_param,dim,lcm);
01487         
01488 <font class="preprocessor">#ifdef EDEBUG3</font>
01489 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01490 <font class="preprocessor"></font>        
01491         <font class="keywordflow">for</font> (j=1; j&lt;pos; j++)
01492           fputs(<font class="stringliteral">"   "</font>, stdout);
01493         fprintf(stdout, <font class="stringliteral">"E("</font>);
01494         <font class="keywordflow">for</font> (j=1; j&lt;=pos; j++) {
01495           <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,context[dim-nb_param+j]);
01496           fprintf(stdout,<font class="stringliteral">","</font>);
01497         }         
01498         <font class="keywordflow">for</font> (j=pos+1; j&lt;nb_param; j++)
01499           fprintf(stdout,<font class="stringliteral">"%s,"</font>,param_name[j]);
01500         fprintf(stdout,<font class="stringliteral">"%s) = "</font>,param_name[j]);
01501         <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(stdout,B-&gt;arr[i].x.p,param_name);
01502         fprintf(stdout,<font class="stringliteral">" ="</font>);
01503 <font class="preprocessor">#endif</font>
01504 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
01505 <font class="preprocessor"></font>        
01506       }
01507       
01508       <font class="comment">/* Create i-th equation*/</font>
01509       <font class="comment">/* K_0 + K_1 * n**1 + ... + K_dim * n**dim | Identity Matrix */</font>
01510       
01511       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(A-&gt;p[i][0],0);  <font class="comment">/* status bit = equality */</font>
01512       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(nexp,1);
01513       <font class="keywordflow">for</font> (j=1;j&lt;=hdim;j++) {
01514         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(A-&gt;p[i][j],nexp);
01515         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(A-&gt;p[i][j+hdim],0);
01516         
01517 <font class="preprocessor">#ifdef EDEBUG3</font>
01518 <font class="preprocessor"></font>        fprintf(stdout,<font class="stringliteral">" + "</font>);
01519         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,<a class="code" href="arithmetique_8h.html#a5">VALUE_FMT</a>,nexp);
01520         fprintf(stdout,<font class="stringliteral">" c%d"</font>,j);
01521 <font class="preprocessor">#endif  </font>
01522 <font class="preprocessor"></font>        <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(nexp,nexp,<a class="code" href="polyparam_8c.html#a2">n</a>);
01523       }
01524       
01525 <font class="preprocessor">#ifdef EDEBUG3</font>
01526 <font class="preprocessor"></font>      fprintf(stdout, <font class="stringliteral">"\n"</font>);
01527 <font class="preprocessor">#endif</font>
01528 <font class="preprocessor"></font>      
01529       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(A-&gt;p[i][i+1+hdim],1);      
01530     }
01531     
01532     <font class="comment">/* Assertion check */</font>
01533     <font class="keywordflow">if</font> (i!=hdim)
01534       fprintf(stderr, <font class="stringliteral">"P_Enum: ?expecting i==hdim\n"</font>);
01535     
01536 <font class="preprocessor">#ifdef EDEBUG</font>
01537 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01538 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"B (enode) =\n"</font>);
01539     <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(stderr,B,param_name);
01540 <font class="preprocessor">#endif</font>
01541 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"A (Before Gauss) =\n"</font>);
01542     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,A);
01543 <font class="preprocessor">#endif</font>
01544 <font class="preprocessor"></font>    
01545     <font class="comment">/* Solve hdim (=dim+1) equations with hdim unknowns, result in CNT */</font>
01546     rank = <a class="code" href="polyhedron_8c.html#a15">Gauss</a>(A,hdim,2*hdim);
01547     
01548 <font class="preprocessor">#ifdef EDEBUG</font>
01549 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"A (After Gauss) =\n"</font>);
01550     <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(stderr,P_VALUE_FMT,A);
01551 <font class="preprocessor">#endif</font>
01552 <font class="preprocessor"></font>    
01553     <font class="comment">/* Assertion check */</font>
01554     <font class="keywordflow">if</font> (rank!=hdim) {
01555       fprintf(stderr, <font class="stringliteral">"P_Enum: ?expecting rank==hdim\n"</font>);
01556     }
01557     
01558     <font class="comment">/* if (rank &lt; hdim) then set the last hdim-rank coefficients to ? */</font>
01559     <font class="comment">/* if (rank == 0) then set all coefficients to 0 */</font>    
01560     <font class="comment">/* copy result as k1-th element of periodic numbers */</font>
01561     <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a26">value_lt</a>(k,lcm_copy))
01562       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(k1,k);
01563     <font class="keywordflow">else</font>
01564       <a class="code" href="arithmetique_8h.html#a48">value_substract</a>(k1,k,lcm_copy);
01565     
01566     <font class="keywordflow">for</font> (i=0; i&lt;rank; i++) {
01567       
01568       <font class="comment">/* Set up coefficient vector C from i-th row of inverted matrix */</font>
01569       <font class="keywordflow">for</font> (j=0; j&lt;rank; j++) {
01570         <a class="code" href="vector_8c.html#a3">Gcd</a>(A-&gt;p[i][i+1],A-&gt;p[i][j+1+hdim],&amp;g);
01571         <a class="code" href="arithmetique_8h.html#a51">value_division</a>(C-&gt;arr[j].d,A-&gt;p[i][i+1],g);
01572         <a class="code" href="arithmetique_8h.html#a51">value_division</a>(C-&gt;arr[j].x.n,A-&gt;p[i][j+1+hdim],g);
01573       }
01574       
01575 <font class="preprocessor">#ifdef EDEBUG</font>
01576 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01577 <font class="preprocessor"></font>      fprintf(stderr, <font class="stringliteral">"C (enode) =\n"</font>);
01578       <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(stderr, C, param_name);
01579 <font class="preprocessor">#endif</font>
01580 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
01581 <font class="preprocessor"></font>      
01582       <font class="comment">/* The i-th enode is the lcm-periodic coefficient of term n**i */</font>
01583       <a class="code" href="ehrhart_8c~.html#a16">edot</a>(B,C,&amp;(res-&gt;arr[i].x.p-&gt;arr[VALUE_TO_INT(k1)]));
01584       
01585 <font class="preprocessor">#ifdef EDEBUG</font>
01586 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01587 <font class="preprocessor"></font>      fprintf(stderr, <font class="stringliteral">"B.C (evalue)=\n"</font>);
01588       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(stderr,&amp;(res-&gt;arr[i].x.p-&gt;arr[VALUE_TO_INT(k1)]),param_name );
01589       fprintf(stderr,<font class="stringliteral">"\n"</font>);
01590 <font class="preprocessor">#endif</font>
01591 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
01592 <font class="preprocessor"></font>      
01593     }
01594     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(tmp,lcm_copy,nlcm);
01595   }
01596   
01597 <font class="preprocessor">#ifdef EDEBUG</font>
01598 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
01599 <font class="preprocessor"></font>  fprintf(stderr,<font class="stringliteral">"res (enode) =\n"</font>);
01600   <a class="code" href="ehrhart_8c~.html#a11">print_enode</a>(stderr,res,param_name);
01601   
01602 <font class="preprocessor">#endif</font>
01603 <font class="preprocessor"></font>  fprintf(stderr, <font class="stringliteral">"-------------------- end P_Enum -----------------------\n"</font>);
01604 <font class="preprocessor">#endif</font>
01605 <font class="preprocessor"></font>  
01606   <font class="comment">/* Reset context */</font>
01607   <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(context[dim-nb_param+pos],0);
01608   
01609   <font class="comment">/* Release memory */</font>
01610   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(A);
01611   free(B);
01612   free(C);
01613   
01614   <font class="comment">/* Clear all the 'Value' variables */</font>
01615   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(<a class="code" href="polyparam_8c.html#a2">n</a>); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(g); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(nLB);
01616   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(nUB); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(nlcm); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(noff);
01617   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(nexp); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k1); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(nm);
01618   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(hdv); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
01619   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(lcm_copy);
01620   <font class="keywordflow">return</font> res;
01621 } <font class="comment">/* P_Enum */</font>
01622 
01623 <font class="comment">/*----------------------------------------------------------------*/</font>
01624 <font class="comment">/* Scan_Vertices(PP, Q, CT)                                       */</font>
01625 <font class="comment">/*    PP : ParamPolyhedron                                        */</font>
01626 <font class="comment">/*    Q : Domain                                                  */</font>
01627 <font class="comment">/*    CT : Context transformation matrix                          */</font>
01628 <font class="comment">/*----------------------------------------------------------------*/</font>
<a name="l01629"></a><a class="code" href="ehrhart_8c.html#a25">01629</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="ehrhart_8c~.html#a25">Scan_Vertices</a>(Param_Polyhedron *PP,Param_Domain *Q,Matrix *CT,
01630    Value *lcm, <font class="keywordtype">int</font> nbp )<font class="keyword"></font>
01631 <font class="keyword"></font>{
01632   Param_Vertices *V;
01633   <font class="keywordtype">int</font> i, j, ix, l, np;
01634   <font class="keywordtype">unsigned</font> bx;
01635   Value k,m1;
01636 
01637   <font class="comment">/* Compute the denominator of P */</font>
01638   <font class="comment">/* lcm = Least Common Multiple of the denominators of the vertices of P */</font>
01639   <font class="comment">/* and print the vertices */</font>  
01640 
01641   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(k); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(m1);
01642   <font class="keywordflow">for</font>( np=0 ; np&lt;nbp ; np++ )
01643     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>( lcm[np], 0 );
01644 
01645 <font class="preprocessor">#ifdef EPRINT</font>
01646 <font class="preprocessor"></font>  fprintf(stdout,<font class="stringliteral">"Vertices:\n"</font>);
01647 <font class="preprocessor">#endif</font>
01648 <font class="preprocessor"></font>
01649   <font class="keywordflow">for</font>(i=0,ix=0,bx=MSB,V=PP-&gt;V; V &amp;&amp; i&lt;PP-&gt;nbV; i++,V=V-&gt;next) {
01650     <font class="keywordflow">if</font> (Q-&gt;F[ix] &amp; bx) {
01651 <font class="preprocessor">#ifdef EPRINT</font>
01652 <font class="preprocessor"></font>      <font class="keywordflow">if</font>(CT) {
01653         Matrix *v;
01654         v = <a class="code" href="polyparam_8c.html#a38">VertexCT</a>(V-&gt;Vertex,CT);
01655         <a class="code" href="polyparam_8c.html#a37">Print_Vertex</a>(stdout,v,param_name);
01656         <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(v);
01657       }
01658       <font class="keywordflow">else</font>
01659         <a class="code" href="polyparam_8c.html#a37">Print_Vertex</a>(stdout,V-&gt;Vertex,param_name);
01660       fprintf(stdout,<font class="stringliteral">"\n"</font>);
01661 <font class="preprocessor">#endif</font>
01662 <font class="preprocessor"></font>
01663       <font class="keywordflow">for</font>(j=0;j&lt;V-&gt;Vertex-&gt;NbRows;j++) {
01664                         <font class="comment">/* A matrix */</font>
01665                         <font class="keywordflow">for</font>( l=0 ; l&lt;V-&gt;Vertex-&gt;NbColumns-2 ; l++ )
01666                         {
01667                                 <font class="keywordflow">if</font>( <a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(V-&gt;Vertex-&gt;p[j][l]) )<font class="keyword"></font>
01668 <font class="keyword">                                </font>{
01669                                         <a class="code" href="vector_8c.html#a3">Gcd</a>(V-&gt;Vertex-&gt;p[j][V-&gt;Vertex-&gt;NbColumns-1],V-&gt;Vertex-&gt;p[j][l], &amp;m1);
01670                                         <a class="code" href="arithmetique_8h.html#a51">value_division</a>(k,V-&gt;Vertex-&gt;p[j][V-&gt;Vertex-&gt;NbColumns-1],m1);
01671                                         <font class="keywordflow">if</font>( <a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(lcm[l]) )<font class="keyword"></font>
01672 <font class="keyword">                                        </font>{
01673                                                 <font class="comment">/* lcm[l] = lcm[l] * k / gcd(k,lcm[l]) */</font>
01674                                                 <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(k) &amp;&amp; <a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(k))<font class="keyword"></font>
01675 <font class="keyword">                                                </font>{
01676                                                   <a class="code" href="vector_8c.html#a3">Gcd</a>(lcm[l],k,&amp;m1);
01677                                                   <a class="code" href="arithmetique_8h.html#a51">value_division</a>(k,k,m1);
01678                                                   <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(lcm[l],lcm[l],k);
01679                                                 }
01680                                         }
01681                                         <font class="keywordflow">else</font>
01682                                         {
01683                                                 <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(lcm[l],k);
01684                                         }
01685                                 }
01686                         }
01687       }
01688     }
01689     NEXT(ix,bx);
01690   }
01691   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(k); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1);
01692 } <font class="comment">/* Scan_Vertices */</font>
01693 <font class="comment"></font>
01694 <font class="comment">/**</font>
01695 <font class="comment"></font>
01696 <font class="comment">Procedure to count points in a non-parameterized polytope.</font>
01697 <font class="comment"></font>
01698 <font class="comment">@param P       Polyhedron to count</font>
01699 <font class="comment">@param C       Parameter Context domain</font>
01700 <font class="comment">@param CT      Matrix to transform context to original</font>
01701 <font class="comment">@parma CEq     additionnal equalities in context</font>
01702 <font class="comment">@param MAXRAYS workspace size</font>
01703 <font class="comment"></font>
01704 <font class="comment">*/</font>
<a name="l01705"></a><a class="code" href="ehrhart_8c.html#a26">01705</a> Enumeration *<a class="code" href="ehrhart_8c~.html#a26">Enumerate_NoParameters</a>(Polyhedron *P,Polyhedron *C,Matrix *CT,Polyhedron *CEq,<font class="keywordtype">unsigned</font> <a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>)<font class="keyword"> </font>{
01706   
01707     Polyhedron *L;
01708     Enumeration *res;
01709     Value *context,tmp;
01710     <font class="keywordtype">int</font> j;
01711     <font class="keywordtype">int</font> hdim = P-&gt;Dimension + 1;
01712   
01713 <font class="preprocessor">#ifdef EPRINT</font>
01714 <font class="preprocessor"></font>    <font class="keywordtype">int</font> r,i;
01715 <font class="preprocessor">#endif</font>
01716 <font class="preprocessor"></font>  
01717     <font class="comment">/* Create a context vector size dim+2 */</font>
01718     context = (Value *) malloc((hdim+1)*<font class="keyword">sizeof</font>(Value));
01719     <font class="keywordflow">for</font> (j=0;j&lt;= hdim;j++) 
01720         <a class="code" href="arithmetique_8h.html#a10">value_init</a>(context[j]);
01721     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
01722   
01723     res = (Enumeration *)malloc(<font class="keyword">sizeof</font>(Enumeration));
01724     res-&gt;next = NULL;
01725     res-&gt;ValidityDomain = <a class="code" href="polyhedron_8c.html#a23">Universe_Polyhedron</a>(0);  <font class="comment">/* no parameters */</font>
01726     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;EP.d);
01727     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;EP.d,0);  
01728     L = <a class="code" href="polyhedron_8c.html#a48">Polyhedron_Scan</a>(P,res-&gt;ValidityDomain,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01729   
01730 <font class="preprocessor">#ifdef EDEBUG2</font>
01731 <font class="preprocessor"></font>    fprintf(stderr, <font class="stringliteral">"L = \n"</font>);
01732     <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr, P_VALUE_FMT, L);
01733 <font class="preprocessor">#endif</font>
01734 <font class="preprocessor"></font>  
01735     <font class="keywordflow">if</font>(CT) {
01736         Polyhedron *Dt;
01737     
01738         <font class="comment">/* Add parameters to validity domain */</font>
01739         Dt = <a class="code" href="polyhedron_8c.html#a50">Polyhedron_Preimage</a>(res-&gt;ValidityDomain,CT,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01740         <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(res-&gt;ValidityDomain);
01741         res-&gt;ValidityDomain = <a class="code" href="polyhedron_8c.html#a32">DomainIntersection</a>(Dt,CEq,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01742         <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(Dt);
01743     }
01744   
01745 <font class="preprocessor">#ifdef EPRINT </font>
01746 <font class="preprocessor"></font>    fprintf(stdout,<font class="stringliteral">"---------------------------------------\n"</font>);
01747     fprintf(stdout,<font class="stringliteral">"Domain:\n"</font>);
01748     <a class="code" href="polyparam_8c.html#a39">Print_Domain</a>(stdout,res-&gt;ValidityDomain, param_name);
01749   
01750     <font class="comment">/* Print the vertices */</font>
01751     printf(<font class="stringliteral">"Vertices:\n"</font>);
01752     <font class="keywordflow">for</font>(r=0;r&lt;P-&gt;NbRays;++r) {
01753         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(P-&gt;Ray[r][0]))
01754             printf(<font class="stringliteral">"(line) "</font>);
01755         printf(<font class="stringliteral">"["</font>);
01756         <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,P_VALUE_FMT,P-&gt;Ray[r][1]);
01757         <font class="keywordflow">for</font>(i=1;i&lt;P-&gt;Dimension;i++) {
01758             printf(<font class="stringliteral">", "</font>);
01759             <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,P_VALUE_FMT,P-&gt;Ray[r][i+1]);
01760         }  
01761         printf(<font class="stringliteral">"]"</font>);
01762         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a70">value_notone_p</a>(P-&gt;Ray[r][i+1]))<font class="keyword"> </font>{
01763             printf(<font class="stringliteral">"/"</font>);
01764             <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stdout,P_VALUE_FMT, P-&gt;Ray[r][i+1]);
01765         }
01766         printf(<font class="stringliteral">"\n"</font>);
01767     }
01768 <font class="preprocessor">#endif    </font>
01769 <font class="preprocessor"></font>    <a class="code" href="arithmetic__errors_8h.html#a4">CATCH</a>(overflow_error)<font class="keyword"> </font>{
01770         fprintf(stderr,<font class="stringliteral">"Enumerate: arithmetic overflow error.\n"</font>);
01771         fprintf(stderr,<font class="stringliteral">"You should rebuild PolyLib using GNU-MP or increasing the size of integers.\n"</font>);
01772         overflow_warning_flag = 0;
01773         <a class="code" href="assert_8h.html#a1">assert</a>(overflow_warning_flag);
01774     }
01775     <a class="code" href="arithmetic__errors_8h.html#a6">TRY</a> {
01776     
01777         <a class="code" href="vector_8c.html#a9">Vector_Set</a>(context,0,(hdim+1));
01778     
01779         <font class="comment">/* Set context[hdim] = 1  (the constant) */</font>
01780         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(context[hdim],1);
01781         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(tmp,1);
01782         res-&gt;EP.x.p = <a class="code" href="ehrhart_8c~.html#a24">P_Enum</a>(L,NULL,context,1,0,hdim-1,&amp;tmp);
01783         <a class="code" href="arithmetic__errors_8h.html#a5">UNCATCH</a>(overflow_error);
01784     }
01785   
01786     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(L);
01787   
01788     <font class="comment">/*  **USELESS, there are no references to parameters in res**</font>
01789 <font class="comment">        if( CT )</font>
01790 <font class="comment">        addeliminatedparams_evalue(&amp;res-&gt;EP, CT);</font>
01791 <font class="comment">    */</font>
01792   
01793 <font class="preprocessor">#ifdef EPRINT</font>
01794 <font class="preprocessor"></font>    fprintf(stdout,<font class="stringliteral">"\nEhrhart Polynomial:\n"</font>);
01795     <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(stdout,&amp;res-&gt;EP,param_name);
01796     fprintf(stdout, <font class="stringliteral">"\n"</font>);
01797 <font class="preprocessor">#endif</font>
01798 <font class="preprocessor"></font>  
01799     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
01800     <font class="keywordflow">for</font> (j=0;j&lt;= hdim;j++) 
01801         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(context[j]);  
01802     <font class="keywordflow">return</font>(res);
01803 } <font class="comment">/* Enumerate_NoParameters */</font>
01804 <font class="comment"></font>
01805 <font class="comment">/**  Procedure to count points in a parameterized polytope.</font>
01806 <font class="comment"></font>
01807 <font class="comment">@param P Polyhedron to enumerate</font>
01808 <font class="comment">@param C Context Domain</font>
01809 <font class="comment">@param MAXRAYS size of workspace</font>
01810 <font class="comment">@return a list of validity domains + evalues EP</font>
01811 <font class="comment"></font>
01812 <font class="comment">*/</font>
<a name="l01813"></a><a class="code" href="ehrhart_8c.html#a27">01813</a> Enumeration *<a class="code" href="ehrhart_8c~.html#a27">Polyhedron_Enumerate</a>(Polyhedron *<a class="code" href="polyparam_8c.html#a9">Pi</a>,Polyhedron *C,<font class="keywordtype">unsigned</font> <a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>)<font class="keyword"></font>
01814 <font class="keyword"></font>{
01815   Polyhedron *L, *CQ, *CQ2, *LQ, *U, *CEq, *rVD, *P;
01816   Matrix *CT;
01817   Param_Polyhedron *PP;
01818   Param_Domain   *Q;
01819   <font class="keywordtype">int</font> i,hdim, dim, nb_param, np;
01820   Value *lcm, *m1, hdv;
01821   Value *context;
01822   Enumeration *en, *res;
01823 
01824   res = NULL;
01825   P = <a class="code" href="polyparam_8c.html#a9">Pi</a>;
01826 
01827 <font class="preprocessor">#ifdef EDEBUG2</font>
01828 <font class="preprocessor"></font>  fprintf(stderr,<font class="stringliteral">"C = \n"</font>);
01829   <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,C);
01830   fprintf(stderr,<font class="stringliteral">"P = \n"</font>);
01831   <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,P);
01832 <font class="preprocessor">#endif</font>
01833 <font class="preprocessor"></font>
01834   hdim          = P-&gt;Dimension + 1;
01835   dim           = P-&gt;Dimension;
01836   nb_param      = C-&gt;Dimension;
01837 
01838   <font class="comment">/* Don't call Polyhedron2Param_Domain if there are no parameters */</font>
01839   <font class="keywordflow">if</font>(nb_param == 0) {
01840     
01841     <font class="keywordflow">return</font>(<a class="code" href="ehrhart_8c~.html#a26">Enumerate_NoParameters</a>(P,C,NULL,NULL,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>));  
01842   }
01843   PP = <a class="code" href="polyparam_8c.html#a42">Polyhedron2Param_SimplifiedDomain</a>(&amp;P,C,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>,&amp;CEq,&amp;CT);
01844   <font class="keywordflow">if</font>(!PP) {
01845 <font class="preprocessor">#ifdef EPRINT</font>
01846 <font class="preprocessor"></font>    fprintf(stdout, <font class="stringliteral">"\nEhrhart Polynomial:\nNULL\n"</font>);
01847 <font class="preprocessor">#endif</font>
01848 <font class="preprocessor"></font>
01849     <font class="keywordflow">return</font>(NULL);
01850   }
01851   
01852   <font class="comment">/* CT : transformation matrix to eliminate useless ("false") parameters */</font>
01853   <font class="keywordflow">if</font>(CT) {
01854     nb_param -= CT-&gt;NbColumns-CT-&gt;NbRows;
01855     dim  -= CT-&gt;NbColumns-CT-&gt;NbRows;
01856     hdim -= CT-&gt;NbColumns-CT-&gt;NbRows;
01857     
01858     <font class="comment">/* Don't call Polyhedron2Param_Domain if there are no parameters */</font>
01859     <font class="keywordflow">if</font>(nb_param == 0)
01860     {
01861             res = <a class="code" href="ehrhart_8c~.html#a26">Enumerate_NoParameters</a>(P,C,CT,CEq,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01862             <font class="keywordflow">if</font>( P != <a class="code" href="polyparam_8c.html#a9">Pi</a> )
01863                     <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>( P );
01864             <font class="keywordflow">return</font>( res );
01865     }  
01866   }
01867 
01868   <font class="comment">/* get memory for Values */</font>
01869   lcm = (Value *)malloc( nb_param * <font class="keyword">sizeof</font>(Value));
01870   m1  = (Value *)malloc( nb_param * <font class="keyword">sizeof</font>(Value));
01871   <font class="comment">/* Initialize all the 'Value' variables */</font>
01872   <font class="keywordflow">for</font>( np=0 ; np&lt;nb_param ; np++ )
01873   {
01874     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(lcm[np]); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(m1[np]);
01875   }
01876   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(hdv);
01877 
01878   <font class="keywordflow">for</font>(Q=PP-&gt;D;Q;Q=Q-&gt;next) {
01879     <font class="keywordflow">if</font>(CT) {
01880       Polyhedron *Dt;
01881       CQ = Q-&gt;Domain;      
01882       Dt = <a class="code" href="polyhedron_8c.html#a50">Polyhedron_Preimage</a>(Q-&gt;Domain,CT,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01883       rVD = <a class="code" href="polyhedron_8c.html#a32">DomainIntersection</a>(Dt,CEq,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01884       
01885       <font class="comment">/* if rVD is empty or too small in geometric dimension */</font>
01886       <font class="keywordflow">if</font>(!rVD || emptyQ(rVD) ||
01887          (rVD-&gt;Dimension-rVD-&gt;NbEq &lt; Dt-&gt;Dimension-Dt-&gt;NbEq-CEq-&gt;NbEq))<font class="keyword"> </font>{
01888         <font class="keywordflow">if</font>(rVD)
01889           <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(rVD);
01890         <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(Dt);
01891         <font class="keywordflow">continue</font>;               <font class="comment">/* empty validity domain */</font>
01892       }
01893       <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>(Dt);
01894     }
01895     <font class="keywordflow">else</font>
01896       rVD = CQ = Q-&gt;Domain;    
01897     en = (Enumeration *)malloc(<font class="keyword">sizeof</font>(Enumeration));
01898     en-&gt;next = res;
01899     res = en;
01900     res-&gt;ValidityDomain = rVD;
01901     
01902 <font class="preprocessor">#ifdef EPRINT</font>
01903 <font class="preprocessor"></font>    fprintf(stdout,<font class="stringliteral">"---------------------------------------\n"</font>);
01904     fprintf(stdout,<font class="stringliteral">"Domain:\n"</font>);
01905     
01906 <font class="preprocessor">#ifdef EPRINT_ALL_VALIDITY_CONSTRAINTS</font>
01907 <font class="preprocessor"></font>    <a class="code" href="polyparam_8c.html#a39">Print_Domain</a>(stdout,res-&gt;ValidityDomain,param_name);
01908 <font class="preprocessor">#else    </font>
01909 <font class="preprocessor"></font>    {
01910       Polyhedron *VD;
01911       VD = <a class="code" href="polyhedron_8c.html#a42">DomainSimplify</a>(res-&gt;ValidityDomain,C,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01912       <a class="code" href="polyparam_8c.html#a39">Print_Domain</a>(stdout,VD,param_name);
01913       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(VD);
01914     }
01915 <font class="preprocessor">#endif </font><font class="comment">/* EPRINT_ALL_VALIDITY_CONSTRAINTS */</font>
01916 <font class="preprocessor">#endif </font><font class="comment">/* EPRINT */</font>
01917     
01918     overflow_warning_flag = 1;
01919     
01920     <font class="comment">/* Scan the vertices and compute lcm */</font>
01921     <a class="code" href="ehrhart_8c~.html#a25">Scan_Vertices</a>(PP,Q,CT,lcm,nb_param);
01922     
01923 <font class="preprocessor">#ifdef EDEBUG2</font>
01924 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"Denominator = "</font>);
01925     <font class="keywordflow">for</font>( np=0;np&lt;nb_param;np++)
01926       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,lcm[np]);
01927     fprintf(stderr,<font class="stringliteral">" and hdim == %d \n"</font>,hdim);
01928 <font class="preprocessor">#endif</font>
01929 <font class="preprocessor"></font>    
01930 <font class="preprocessor">#ifdef EDEBUG2</font>
01931 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"CQ = \n"</font>);
01932     <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,CQ);
01933 <font class="preprocessor">#endif</font>
01934 <font class="preprocessor"></font>
01935     <font class="comment">/* Before scanning, add constraints to ensure at least hdim*lcm */</font>
01936     <font class="comment">/* points in every dimension */</font>
01937     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(hdv,hdim-nb_param);
01938 
01939     <font class="keywordflow">for</font>( np=0;np&lt;nb_param;np++)
01940     {
01941                 <font class="keywordflow">if</font>( <a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(lcm[np]) )
01942                         <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(m1[np],hdv,lcm[np]);
01943                 <font class="keywordflow">else</font>
01944                         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(m1[np],1);
01945     }
01946 
01947 <font class="preprocessor">#ifdef EDEBUG2 </font>
01948 <font class="preprocessor"></font>    fprintf(stderr,<font class="stringliteral">"m1 == "</font>);
01949     <font class="keywordflow">for</font>( np=0;np&lt;nb_param;np++)
01950       <a class="code" href="arithmetique_8h.html#a16">value_print</a>(stderr,P_VALUE_FMT,m1[np]);
01951     fprintf(stderr,<font class="stringliteral">"\n"</font>);
01952 <font class="preprocessor">#endif </font>
01953 <font class="preprocessor"></font>
01954     <a class="code" href="arithmetic__errors_8h.html#a4">CATCH</a>(overflow_error)<font class="keyword"> </font>{
01955       fprintf(stderr,<font class="stringliteral">"Enumerate: arithmetic overflow error.\n"</font>);
01956       CQ2 = NULL;
01957     }
01958     <a class="code" href="arithmetic__errors_8h.html#a6">TRY</a> {      
01959       CQ2 = <a class="code" href="ehrhart_8c~.html#a20">Polyhedron_Preprocess</a>(CQ,m1,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01960 
01961 <font class="preprocessor">#ifdef EDEBUG2</font>
01962 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"After preprocess, CQ2 = "</font>);
01963       <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,CQ2);
01964 <font class="preprocessor">#endif</font>
01965 <font class="preprocessor"></font>      
01966       <a class="code" href="arithmetic__errors_8h.html#a5">UNCATCH</a>(overflow_error);
01967     }
01968     
01969     <font class="comment">/* Vin100, Feb 2001 */</font>
01970     <font class="comment">/* in case of degenerate, try to find a domain _containing_ CQ */</font>
01971     <font class="keywordflow">if</font> ((!CQ2 || emptyQ(CQ2)) &amp;&amp; CQ-&gt;NbBid==0) {
01972       <font class="keywordtype">int</font> r;
01973       
01974 <font class="preprocessor">#ifdef EDEBUG2</font>
01975 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"Trying to call Polyhedron_Preprocess2 : CQ = \n"</font>);
01976       <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,CQ);
01977 <font class="preprocessor">#endif</font>
01978 <font class="preprocessor"></font>      
01979       <font class="comment">/* Check if CQ is bounded */</font>
01980       <font class="keywordflow">for</font>(r=0;r&lt;CQ-&gt;NbRays;r++) {
01981         <font class="keywordflow">if</font>(<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(CQ-&gt;Ray[r][0]) ||
01982            value_zero_p(CQ-&gt;Ray[r][CQ-&gt;Dimension+1]))
01983           <font class="keywordflow">break</font>;
01984       }
01985       <font class="keywordflow">if</font>(r==CQ-&gt;NbRays) {
01986         
01987         <font class="comment">/* ok, CQ is bounded */</font>
01988         <font class="comment">/* now find if CQ is contained in a hypercube of size m1 */</font>
01989         CQ2 = <a class="code" href="ehrhart_8c~.html#a21">Polyhedron_Preprocess2</a>(CQ,m1,lcm,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
01990       }
01991     }
01992     <font class="keywordflow">if</font> (!CQ2 || emptyQ(CQ2))<font class="keyword"> </font>{
01993 <font class="preprocessor">#ifdef EDEBUG2</font>
01994 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"Degenerate.\n"</font>);
01995 <font class="preprocessor">#endif</font>
01996 <font class="preprocessor"></font>      fprintf(stdout,<font class="stringliteral">"Degenerate Domain. Can not continue.\n"</font>);
01997       <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;EP.d);
01998       <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;EP.x.n);
01999       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;EP.d,1);
02000       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;EP.x.n,-1);
02001     }
02002     <font class="keywordflow">else</font> {
02003       
02004 <font class="preprocessor">#ifdef EDEBUG2</font>
02005 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"CQ2 = \n"</font>);
02006       <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,CQ2);
02007       <font class="keywordflow">if</font>( ! <a class="code" href="polyhedron_8c.html#a29">PolyhedronIncludes</a>(CQ, CQ2) )
02008         fprintf( stderr,<font class="stringliteral">"CQ does not include CQ2 !\n"</font>);
02009       <font class="keywordflow">else</font>
02010         fprintf( stderr,<font class="stringliteral">"CQ includes CQ2.\n"</font>);
02011       <font class="keywordflow">if</font>( ! <a class="code" href="polyhedron_8c.html#a29">PolyhedronIncludes</a>(res-&gt;ValidityDomain, CQ2) )
02012         fprintf( stderr,<font class="stringliteral">"CQ2 is *not* included in validity domain !\n"</font>);
02013       <font class="keywordflow">else</font>
02014         fprintf( stderr,<font class="stringliteral">"CQ2 is included in validity domain.\n"</font>);
02015 <font class="preprocessor">#endif</font>
02016 <font class="preprocessor"></font>      
02017       <font class="comment">/* L is used in counting the number of points in the base cases */</font>
02018       L = <a class="code" href="polyhedron_8c.html#a48">Polyhedron_Scan</a>(P,CQ,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>);
02019       U = <a class="code" href="polyhedron_8c.html#a23">Universe_Polyhedron</a>(0);
02020       
02021       <font class="comment">/* LQ is used to scan the parameter space */</font>
02022       LQ = <a class="code" href="polyhedron_8c.html#a48">Polyhedron_Scan</a>(CQ2,U,<a class="code" href="verif__ehrhart_8c.html#a0">MAXRAYS</a>); <font class="comment">/* bounds on parameters */</font>
02023       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(U);
02024       <font class="keywordflow">if</font>(CT)    <font class="comment">/* we did compute another Q-&gt;Domain */</font>
02025         <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(CQ);
02026       
02027       <font class="comment">/* Else, CQ was Q-&gt;Domain (used in res) */</font>
02028       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(CQ2);
02029       
02030 <font class="preprocessor">#ifdef EDEBUG2</font>
02031 <font class="preprocessor"></font>      fprintf(stderr,<font class="stringliteral">"L = \n"</font>);
02032       <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,L);
02033       fprintf(stderr,<font class="stringliteral">"LQ = \n"</font>);
02034       <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(stderr,P_VALUE_FMT,LQ);
02035 <font class="preprocessor">#endif</font>
02036 <font class="preprocessor"></font><font class="preprocessor">#ifdef EDEBUG3</font>
02037 <font class="preprocessor"></font>      fprintf(stdout,<font class="stringliteral">"\nSystem of Equations:\n"</font>);
02038 <font class="preprocessor">#endif</font>
02039 <font class="preprocessor"></font>      
02040       <a class="code" href="arithmetique_8h.html#a10">value_init</a>(res-&gt;EP.d);
02041       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(res-&gt;EP.d,0);
02042       
02043       <font class="comment">/* Create a context vector size dim+2 */</font>
02044       context = (Value *) malloc ((hdim+1)*<font class="keyword">sizeof</font>(Value));  
02045       <font class="keywordflow">for</font>(i=0;i&lt;=(hdim);i++)
02046         <a class="code" href="arithmetique_8h.html#a10">value_init</a>(context[i]);
02047       <a class="code" href="vector_8c.html#a9">Vector_Set</a>(context,0,(hdim+1));
02048       
02049       <font class="comment">/* Set context[hdim] = 1  (the constant) */</font>
02050       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(context[hdim],1);
02051       
02052       <a class="code" href="arithmetic__errors_8h.html#a4">CATCH</a>(overflow_error)<font class="keyword"> </font>{
02053                         fprintf(stderr,<font class="stringliteral">"Enumerate: arithmetic overflow error.\n"</font>);
02054                         fprintf(stderr,<font class="stringliteral">"You should rebuild PolyLib using GNU-MP or increasing the size of integers.\n"</font>);
02055                         overflow_warning_flag = 0;
02056                         <a class="code" href="assert_8h.html#a1">assert</a>(overflow_warning_flag);
02057         
02058       }
02059       <a class="code" href="arithmetic__errors_8h.html#a6">TRY</a> {
02060                         res-&gt;EP.x.p = <a class="code" href="ehrhart_8c~.html#a24">P_Enum</a>(L,LQ,context,1,nb_param,dim,lcm);
02061                         <a class="code" href="arithmetic__errors_8h.html#a5">UNCATCH</a>(overflow_error);        
02062       }
02063       
02064       <font class="keywordflow">for</font>(i=0;i&lt;=(hdim);i++)
02065         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(context[i]);
02066       free(context);
02067       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(L);
02068       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(LQ);
02069       
02070 <font class="preprocessor">#ifdef EDEBUG5</font>
02071 <font class="preprocessor"></font><font class="preprocessor">#ifdef EPRINT</font>
02072 <font class="preprocessor"></font>      fprintf(stdout,<font class="stringliteral">"\nEhrhart Polynomial (before simplification):\n"</font>);
02073       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(stdout,&amp;res-&gt;EP,param_name);
02074 <font class="preprocessor">#endif</font>
02075 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
02076 <font class="preprocessor"></font>      
02077       <font class="comment">/* Try to simplify the result */</font>
02078       <a class="code" href="ehrhart_8c~.html#a13">reduce_evalue</a>(&amp;res-&gt;EP);
02079       
02080       <font class="comment">/* Put back the original parameters into result */</font>
02081       <font class="comment">/* (equalities have been eliminated)            */</font>
02082       <font class="keywordflow">if</font>(CT) 
02083           <a class="code" href="ehrhart_8c~.html#a18">addeliminatedparams_evalue</a>(&amp;res-&gt;EP,CT);
02084       
02085 <font class="preprocessor">#ifdef EPRINT</font>
02086 <font class="preprocessor"></font>      fprintf(stdout,<font class="stringliteral">"\nEhrhart Polynomial:\n"</font>);
02087       <a class="code" href="ehrhart_8c~.html#a10">print_evalue</a>(stdout,&amp;res-&gt;EP, param_name);
02088       fprintf(stdout,<font class="stringliteral">"\n"</font>);
02089       <font class="comment">/* sometimes the final \n lacks (when a single constant is printed) */</font>
02090 <font class="preprocessor">#endif  </font>
02091 <font class="preprocessor"></font>      
02092     }
02093   }
02094 
02095   <font class="keywordflow">if</font>( P != <a class="code" href="polyparam_8c.html#a9">Pi</a> )
02096         <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a>( P );
02097   <font class="comment">/* Clear all the 'Value' variables */</font>
02098   <font class="keywordflow">for</font>( np=0; np&lt;nb_param ; np++ )
02099   {
02100     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(lcm[np]); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(m1[np]);
02101   }
02102   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(hdv);
02103 
02104   <font class="keywordflow">return</font> res;
02105 } <font class="comment">/* Polyhedron_Enumerate */</font> 
02106 
</pre></div><hr><address><small>Generated on Fri Oct 4 15:05:56 2002 for Polylib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.11.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
