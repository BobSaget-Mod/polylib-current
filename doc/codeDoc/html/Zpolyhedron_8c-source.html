<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Zpolyhedron.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Zpolyhedron.c</h1><a href="Zpolyhedron_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="preprocessor">#include &lt;polylib/polylib.h&gt;</font> 
00002 
00003 <font class="keyword">static</font> ZPolyhedron * <a class="code" href="Zpolyhedron_8c.html#a1">ZPolyhedronIntersection</a>(ZPolyhedron *, ZPolyhedron *);
00004 <font class="keyword">static</font> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a2">ZPolyhedron_Copy</a>(ZPolyhedron *A);
00005 <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a>(ZPolyhedron *Zpol);
00006 <font class="keyword">static</font> ZPolyhedron * <a class="code" href="Zpolyhedron_8c.html#a4">ZPolyhedronDifference</a>(ZPolyhedron *, ZPolyhedron *);
00007 <font class="keyword">static</font> ZPolyhedron * <a class="code" href="Zpolyhedron_8c.html#a5">ZPolyhedronImage</a>(ZPolyhedron *, Matrix *);
00008 <font class="keyword">static</font> ZPolyhedron * <a class="code" href="Zpolyhedron_8c.html#a6">ZPolyhedronPreimage</a>(ZPolyhedron *, Matrix *);
00009 <font class="keyword">static</font> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a7">AddZPolytoZDomain</a>(ZPolyhedron *A, ZPolyhedron *Head);
00010 <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="Zpolyhedron_8c.html#a8">ZPolyhedronPrint</a>(FILE *fp, <font class="keywordtype">char</font> *format, ZPolyhedron *A);
00011 
<a name="l00012"></a><a class="code" href="structforsimplify.html">00012</a> <font class="keyword">typedef</font> <font class="keyword">struct </font><a class="code" href="structforsimplify.html">forsimplify</a> {
<a name="l00013"></a><a class="code" href="structforsimplify.html#m0">00013</a>   Polyhedron *<a class="code" href="structforsimplify.html#m0">Pol</a>;
<a name="l00014"></a><a class="code" href="structforsimplify.html#m1">00014</a>   LatticeUnion *<a class="code" href="structforsimplify.html#m1">LatUni</a>;
<a name="l00015"></a><a class="code" href="structforsimplify.html#m2">00015</a>   <font class="keyword">struct </font><a class="code" href="structforsimplify.html">forsimplify</a> *next;
00016 } <a class="code" href="structforsimplify.html">ForSimplify</a>;
00017 
00018 
00019 <font class="comment">/* </font>
00020 <font class="comment"> * Returns True if 'Zpol' is empty, otherwise returns False </font>
00021 <font class="comment"> */</font>
<a name="l00022"></a><a class="code" href="Zpolyhedron_8c.html#a9">00022</a> Bool <a class="code" href="Zpolyhedron_8c.html#a9">isEmptyZPolyhedron</a> (ZPolyhedron *Zpol) {
00023   
00024   <font class="keywordflow">if</font>(Zpol == NULL)
00025     <font class="keywordflow">return</font> True;
00026   <font class="keywordflow">if</font>((<a class="code" href="Lattice_8c.html#a6">isEmptyLattice</a> (Zpol-&gt;Lat)) || (emptyQ(Zpol-&gt;P)))
00027     <font class="keywordflow">return</font> True;
00028   <font class="keywordflow">return</font> False;
00029 } <font class="comment">/* isEmptyZPolyhedron */</font>
00030 
00031 <font class="comment">/*</font>
00032 <font class="comment"> * Given Lattice 'Lat' and a Polyhderon 'Poly', allocate space, and return</font>
00033 <font class="comment"> * the Z-polyhderon corresponding to the image of the polyhderon 'Poly' by the </font>
00034 <font class="comment"> * lattice 'Lat'. If the input lattice 'Lat' is not integeral, it integralises </font>
00035 <font class="comment"> * it, i.e. the lattice of the Z-polyhderon returned is integeral. </font>
00036 <font class="comment"> */</font> 
<a name="l00037"></a><a class="code" href="Zpolyhedron_8c.html#a10">00037</a> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(Lattice *Lat, Polyhedron *Poly) {
00038   
00039   ZPolyhedron *A;
00040   
00041   <font class="keywordflow">if</font>(Lat-&gt;NbRows != Poly-&gt;Dimension+1) {
00042     fprintf(stderr,<font class="stringliteral">"\nInZPolyAlloc - The Lattice  and the Polyhedron"</font>);
00043     fprintf(stderr,<font class="stringliteral">" are not compatible to form a ZPolyhedra\n"</font>);
00044     <font class="keywordflow">return</font> NULL;
00045   }  
00046   <font class="keywordflow">if</font>((!(<a class="code" href="Lattice_8c.html#a6">isEmptyLattice</a>(Lat))) &amp;&amp; (!<a class="code" href="Lattice_8c.html#a27">isfulldim</a> (Lat))) {
00047     fprintf(stderr,<font class="stringliteral">"\nZPolAlloc: Lattice not Full Dimensional\n"</font>);
00048     <font class="keywordflow">return</font> NULL;
00049   }
00050   A = (ZPolyhedron *)malloc(<font class="keyword">sizeof</font>(ZPolyhedron));
00051   <font class="keywordflow">if</font> (!A) {
00052     fprintf(stderr,<font class="stringliteral">"ZPolAlloc : Out of Memory\n"</font>);
00053     <font class="keywordflow">return</font> NULL;
00054   } 
00055   A-&gt;next = NULL;
00056   A-&gt;P = <a class="code" href="polyhedron_8c.html#a37">Domain_Copy</a>(Poly);
00057   A-&gt;Lat = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(Lat);
00058   
00059   <font class="keywordflow">if</font>(<a class="code" href="Lattice_8c.html#a26">IsLattice</a>(Lat) == False) {
00060     ZPolyhedron *Res;
00061     
00062     Res = <a class="code" href="Zpolyhedron_8c.html#a24">IntegraliseLattice</a> (A);
00063     <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a> (A);
00064     <font class="keywordflow">return</font> Res;
00065   }
00066   <font class="keywordflow">return</font> A;
00067 } <font class="comment">/* ZPolyhedron_Alloc */</font>
00068 
00069 <font class="comment">/*</font>
00070 <font class="comment"> * Free the memory used by the Z-domain 'Head' </font>
00071 <font class="comment"> */</font>
<a name="l00072"></a><a class="code" href="Zpolyhedron_8c.html#a11">00072</a> <font class="keywordtype">void</font> <a class="code" href="Zpolyhedron_8c.html#a11">ZDomain_Free</a> (ZPolyhedron *Head) {
00073   
00074   <font class="keywordflow">if</font> (Head == NULL)
00075     <font class="keywordflow">return</font>;
00076   <font class="keywordflow">if</font> (Head-&gt;next != NULL)
00077     <a class="code" href="Zpolyhedron_8c.html#a11">ZDomain_Free</a>(Head-&gt;next);  
00078   <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a>(Head);
00079 } <font class="comment">/* ZDomain_Free */</font>
00080 
00081 <font class="comment">/*</font>
00082 <font class="comment"> * Free the memory used by the Z-polyhderon 'Zpol' </font>
00083 <font class="comment"> */</font>
<a name="l00084"></a><a class="code" href="Zpolyhedron_8c.html#a3">00084</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a> (ZPolyhedron *Zpol) {
00085   
00086   <font class="keywordflow">if</font> (Zpol == NULL)
00087     <font class="keywordflow">return</font>;
00088   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>((Matrix *) Zpol-&gt;Lat);
00089   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Zpol-&gt;P);
00090   free(Zpol);
00091   <font class="keywordflow">return</font>;
00092 } <font class="comment">/* ZPolyhderon_Free */</font>
00093 
00094 <font class="comment">/*</font>
00095 <font class="comment"> * Return a copy of the Z-domain 'Head' </font>
00096 <font class="comment"> */</font> 
<a name="l00097"></a><a class="code" href="Zpolyhedron_8c.html#a12">00097</a> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a12">ZDomain_Copy</a>(ZPolyhedron *Head) {
00098   
00099   ZPolyhedron *Zpol;
00100   Zpol = <a class="code" href="Zpolyhedron_8c.html#a2">ZPolyhedron_Copy</a>(Head);
00101   
00102   <font class="keywordflow">if</font> (Head-&gt;next != NULL)
00103     Zpol-&gt;next = <a class="code" href="Zpolyhedron_8c.html#a12">ZDomain_Copy</a>(Head-&gt;next);
00104   <font class="keywordflow">return</font> Zpol;
00105 } <font class="comment">/* ZDomain_Copy */</font>
00106 
00107 <font class="comment">/*</font>
00108 <font class="comment"> * Return a copy of the Z-polyhderon 'A' </font>
00109 <font class="comment"> */</font>
<a name="l00110"></a><a class="code" href="Zpolyhedron_8c.html#a2">00110</a> <font class="keyword">static</font> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a2">ZPolyhedron_Copy</a>(ZPolyhedron *A) {
00111 
00112   ZPolyhedron *Zpol;
00113   
00114   Zpol = <a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(A-&gt;Lat, A-&gt;P);
00115   <font class="keywordflow">return</font> Zpol;
00116 } <font class="comment">/* ZPolyhderon_Copy */</font>
00117 
00118 <font class="comment">/* </font>
00119 <font class="comment"> * Add the ZPolyhedron 'Zpol' to the Z-domain 'Result' and return a pointer </font>
00120 <font class="comment"> * to the new Z-domain. </font>
00121 <font class="comment"> */</font>
<a name="l00122"></a><a class="code" href="Zpolyhedron_8c.html#a13">00122</a> <font class="keyword">static</font> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a13">AddZPoly2ZDomain</a>(ZPolyhedron *Zpol, ZPolyhedron *Result) {
00123  
00124   ZPolyhedron *A;
00125   
00126   <font class="keywordflow">if</font> (<a class="code" href="Zpolyhedron_8c.html#a9">isEmptyZPolyhedron</a>(Zpol))
00127     <font class="keywordflow">return</font> Result;
00128   A = <a class="code" href="Zpolyhedron_8c.html#a2">ZPolyhedron_Copy</a>(Zpol);
00129   A-&gt;next = NULL;
00130   
00131   <font class="keywordflow">if</font> (<a class="code" href="Zpolyhedron_8c.html#a9">isEmptyZPolyhedron</a> (Result)) {
00132     <a class="code" href="Zpolyhedron_8c.html#a11">ZDomain_Free</a> (Result);
00133     <font class="keywordflow">return</font> A;
00134   }
00135   A-&gt;next = Result;  
00136   <font class="keywordflow">return</font> A;
00137 } <font class="comment">/* AddZPoly2ZDomain */</font>
00138   
00139 <font class="comment">/*</font>
00140 <font class="comment"> * Given a Z-polyhderon 'A' and a Z-domain 'Head', return a new Z-domain with </font>
00141 <font class="comment"> * 'A' added to it. If the new Z-polyhedron 'A', is already included in the </font>
00142 <font class="comment"> * Z-domain 'Head', it is not added in the list. Othewise, the function checks </font>
00143 <font class="comment"> * if the new Z-polyhedron 'A' to be added to the Z-domain 'Head' has a common</font>
00144 <font class="comment"> * lattice with some other Z-polyhderon already present in the Z-domain. If it </font>
00145 <font class="comment"> * is so, it takes the union of the underlying polyhdera; domains and returns. </font>
00146 <font class="comment"> * The function tries to make sure that the added Z-polyhedron 'A' is in the </font>
00147 <font class="comment"> * canonical form.</font>
00148 <font class="comment"> */</font>
<a name="l00149"></a><a class="code" href="Zpolyhedron_8c.html#a7">00149</a> <font class="keyword">static</font> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a7">AddZPolytoZDomain</a>(ZPolyhedron *A, ZPolyhedron *Head) {
00150   
00151   ZPolyhedron *Zpol, *temp, *temp1;
00152   Polyhedron *i;
00153   Bool Added;  
00154   
00155   <font class="keywordflow">if</font> ((A == NULL) || (<a class="code" href="Zpolyhedron_8c.html#a9">isEmptyZPolyhedron</a>(A)))
00156     <font class="keywordflow">return</font> Head;
00157   
00158   <font class="comment">/* For each "underlying" Pol, find the Cnf and add Zpol in Cnf*/</font>  
00159   <font class="keywordflow">for</font>(i=A-&gt;P; i!= NULL; i=i-&gt;next) {
00160     ZPolyhedron *Z, *Z1;
00161     Polyhedron *Image;
00162     Matrix *H, *U;
00163     Lattice *Lat ;
00164     
00165     Added = False;    
00166     Image = <a class="code" href="polyhedron_8c.html#a37">Domain_Copy</a>(i);
00167     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Image-&gt;next);
00168     Image-&gt;next = NULL;
00169     Z1 = <a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(A-&gt;Lat,Image);
00170     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Image);
00171     <a class="code" href="Zpolyhedron_8c.html#a23">CanonicalForm</a>(Z1,&amp;Z,&amp;H); 
00172     <a class="code" href="Zpolyhedron_8c.html#a11">ZDomain_Free</a>(Z1);
00173     Lat = (Lattice *)<a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(H-&gt;NbRows,Z-&gt;Lat-&gt;NbColumns);
00174     <a class="code" href="matrix_8c.html#a12">Matrix_Product</a>(H,Z-&gt;Lat,(Matrix *)Lat);
00175     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(H);    
00176     <a class="code" href="Lattice_8c.html#a8">AffineHermite</a>(Lat,(Lattice **)&amp;H,&amp;U);
00177     Image = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(Z-&gt;P,U,MAXNOOFRAYS);
00178     <a class="code" href="Zpolyhedron_8c.html#a11">ZDomain_Free</a>(Z);
00179       
00180     Zpol=<a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>((Lattice *)H,Image);     
00181     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Image);
00182     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>((Matrix *)Lat);
00183     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(H);
00184     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(U);
00185     
00186     <font class="keywordflow">if</font> ((Head == NULL) || (<a class="code" href="Zpolyhedron_8c.html#a9">isEmptyZPolyhedron</a> (Head))) {
00187       Head = Zpol;
00188       <font class="keywordflow">continue</font>;
00189     }     
00190     temp1 = temp = Head;
00191     
00192     <font class="comment">/* Check if the curr pol is included in the zpol or vice versa. */</font>    
00193     <font class="keywordflow">for</font>(; temp != NULL; temp = temp-&gt;next) {
00194       <font class="keywordflow">if</font> (<a class="code" href="Zpolyhedron_8c.html#a16">ZPolyhedronIncludes</a>(Zpol, temp) == True) {
00195         <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a> (Zpol);
00196         Added = True; 
00197         <font class="keywordflow">break</font>;
00198       }
00199       <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="Zpolyhedron_8c.html#a16">ZPolyhedronIncludes</a>(temp, Zpol) == True) {
00200         <font class="keywordflow">if</font> (temp == Head) {
00201           Zpol-&gt;next = temp-&gt;next;
00202           Head = Zpol;
00203           <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a> (temp);
00204           Added = True;
00205           <font class="keywordflow">break</font>;
00206         }       
00207         temp1-&gt;next = Zpol;
00208         Zpol-&gt;next = temp-&gt;next;
00209         <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a> (temp);
00210         Added = True;
00211         <font class="keywordflow">break</font> ;
00212       }
00213       temp1 = temp ;
00214     }
00215     <font class="keywordflow">if</font>(Added == True)
00216       <font class="keywordflow">continue</font> ; 
00217     <font class="keywordflow">for</font>(temp = Head; temp != NULL; temp = temp-&gt;next) {
00218       <font class="keywordflow">if</font>(<a class="code" href="Lattice_8c.html#a12">sameLattice</a>(temp-&gt;Lat, Zpol-&gt;Lat) == True) {
00219         Polyhedron *Union;
00220         
00221         Union = <a class="code" href="polyhedron_8c.html#a44">DomainUnion</a> (temp-&gt;P,Zpol-&gt;P,MAXNOOFRAYS);
00222         <font class="keywordflow">if</font> (!Union)
00223           fprintf (stderr,<font class="stringliteral">"\n In AddZPolytoZDomain: Out of memory\n"</font>);
00224         <font class="keywordflow">else</font> {
00225           <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(temp-&gt;P);
00226           temp-&gt;P = Union;
00227           Added = True;
00228           <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a>(Zpol);
00229         }
00230         <font class="keywordflow">break</font> ; 
00231       }
00232       temp1 = temp;
00233     }
00234     <font class="keywordflow">if</font> (Added == False) 
00235       temp1-&gt;next = Zpol;
00236   }
00237   <font class="keywordflow">return</font> Head ;  
00238 } <font class="comment">/* AddZPolytoZDomain */</font>
00239 
00240 <font class="comment">/*</font>
00241 <font class="comment"> * Return the empty Z-polyhedron of dimension 'dimension' </font>
00242 <font class="comment"> */</font>
<a name="l00243"></a><a class="code" href="Zpolyhedron_8c.html#a14">00243</a> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a>(<font class="keywordtype">int</font> dimension) {
00244 
00245   ZPolyhedron *Zpol;
00246   Lattice *E ;
00247   Polyhedron *P; 
00248   
00249 <font class="preprocessor">#ifdef DOMDEBUG</font>
00250 <font class="preprocessor"></font>  FILE *fp;
00251   fp = fopen (<font class="stringliteral">"_debug"</font>, <font class="stringliteral">"a"</font>);
00252   fprintf (fp, <font class="stringliteral">"\nEntered EMPTYZPOLYHEDRON\n"</font>);
00253   fclose (fp);
00254 <font class="preprocessor">#endif</font>
00255 <font class="preprocessor"></font>
00256   E = <a class="code" href="Lattice_8c.html#a5">EmptyLattice</a>(dimension+1);
00257   P = <a class="code" href="polyhedron_8c.html#a22">Empty_Polyhedron</a>(dimension);
00258   Zpol = <a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(E,P);
00259   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>((Matrix *) E);
00260   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(P);
00261   <font class="keywordflow">return</font> Zpol;
00262 } <font class="comment">/* EmptyZPolyhedron */</font>
00263 
00264 <font class="comment">/* </font>
00265 <font class="comment"> * Given Z-domains 'A' and 'B', return True if A is included in 'B', otherwise</font>
00266 <font class="comment"> * return False.</font>
00267 <font class="comment"> */</font>
<a name="l00268"></a><a class="code" href="Zpolyhedron_8c.html#a15">00268</a> Bool <a class="code" href="Zpolyhedron_8c.html#a15">ZDomainIncludes</a>(ZPolyhedron *A, ZPolyhedron *B) {
00269   
00270   ZPolyhedron *Diff;
00271   Bool ret = False;
00272   
00273   Diff = <a class="code" href="Zpolyhedron_8c.html#a20">ZDomainDifference</a>(A,B);
00274   <font class="keywordflow">if</font> (<a class="code" href="Zpolyhedron_8c.html#a9">isEmptyZPolyhedron</a>(Diff))
00275     ret = True;
00276   
00277   <a class="code" href="Zpolyhedron_8c.html#a11">ZDomain_Free</a>(Diff);
00278   <font class="keywordflow">return</font> ret;
00279 } <font class="comment">/* ZDomainIncludes */</font>
00280 
00281 <font class="comment">/* </font>
00282 <font class="comment"> * Given Z-polyhedra 'A' and 'B', return True if 'A' is included in 'B', </font>
00283 <font class="comment"> * otherwise return False </font>
00284 <font class="comment"> */</font>
<a name="l00285"></a><a class="code" href="Zpolyhedron_8c.html#a16">00285</a> Bool <a class="code" href="Zpolyhedron_8c.html#a16">ZPolyhedronIncludes</a>(ZPolyhedron *A, ZPolyhedron *B) {
00286 
00287   Polyhedron *Diff = NULL ;
00288   Bool retval = False;
00289 
00290 <font class="preprocessor">#ifdef DOMDEBUG</font>
00291 <font class="preprocessor"></font>  FILE *fp;
00292   fp = fopen(<font class="stringliteral">"_debug"</font>,<font class="stringliteral">"a"</font>);
00293   fprintf(fp,<font class="stringliteral">"\nEntered ZPOLYHEDRONINCLUDES\n"</font>);
00294   fclose(fp);
00295 <font class="preprocessor">#endif</font>
00296 <font class="preprocessor"></font>  
00297   <font class="keywordflow">if</font> (<a class="code" href="Lattice_8c.html#a11">LatticeIncludes</a>(A-&gt;Lat, B-&gt;Lat) == True) {
00298     Polyhedron *ImageA, *ImageB ;
00299     
00300     ImageA = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(A-&gt;P,A-&gt;Lat,MAXNOOFRAYS);
00301     ImageB = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(B-&gt;P,B-&gt;Lat,MAXNOOFRAYS);
00302       
00303     Diff = <a class="code" href="polyhedron_8c.html#a46">DomainDifference</a>(ImageA, ImageB, MAXNOOFRAYS);
00304     <font class="keywordflow">if</font>(emptyQ (Diff))
00305       retval = True ;
00306     
00307     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a> (ImageA);
00308     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a> (ImageB);
00309     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a> (Diff);
00310   }  
00311   <font class="keywordflow">return</font> retval;
00312 } <font class="comment">/* ZPolyhedronIncludes */</font> 
00313 
00314 <font class="comment">/*</font>
00315 <font class="comment"> * Print the contents of a Z-domain 'A' </font>
00316 <font class="comment"> */</font>
<a name="l00317"></a><a class="code" href="Zpolyhedron_8c.html#a17">00317</a> <font class="keywordtype">void</font> <a class="code" href="Zpolyhedron_8c.html#a17">ZDomainPrint</a>(FILE *fp,<font class="keywordtype">char</font> *format,ZPolyhedron *A) {
00318   
00319 <font class="preprocessor">#ifdef DOMDEBUG</font>
00320 <font class="preprocessor"></font>  FILE *fp1;
00321   fp1 = fopen(<font class="stringliteral">"_debug"</font>, <font class="stringliteral">"a"</font>);
00322   fprintf(fp1,<font class="stringliteral">"\nEntered ZDOMAINPRINT\n"</font>);
00323   fclose(fp1);
00324 <font class="preprocessor">#endif</font>
00325 <font class="preprocessor"></font>  
00326   <a class="code" href="Zpolyhedron_8c.html#a8">ZPolyhedronPrint</a>(fp,format,A);
00327   <font class="keywordflow">if</font> (A-&gt;next != NULL) {
00328     fprintf(fp,<font class="stringliteral">"\nUNIONED with\n"</font>);
00329     <a class="code" href="Zpolyhedron_8c.html#a17">ZDomainPrint</a>(fp,format,A-&gt;next);
00330   }
00331   <font class="keywordflow">return</font>;
00332 } <font class="comment">/* ZDomainPrint */</font>  
00333 
00334 <font class="comment">/*</font>
00335 <font class="comment"> * Print the contents of a ZPolyhderon 'A'</font>
00336 <font class="comment"> */</font>
<a name="l00337"></a><a class="code" href="Zpolyhedron_8c.html#a8">00337</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="Zpolyhedron_8c.html#a8">ZPolyhedronPrint</a> (FILE *fp, <font class="keywordtype">char</font> *format, ZPolyhedron *A) {
00338   
00339   <font class="keywordflow">if</font> (A == NULL)
00340     <font class="keywordflow">return</font> ;
00341   fprintf(fp,<font class="stringliteral">"\nZPOLYHEDRON: Dimension %d \n"</font>,A-&gt;Lat-&gt;NbRows-1);
00342   fprintf(fp, <font class="stringliteral">"\nLATTICE: \n"</font>);
00343   <a class="code" href="matrix_8c.html#a2">Matrix_Print</a>(fp,format,(Matrix *)A-&gt;Lat);
00344   <a class="code" href="polyhedron_8c.html#a20">Polyhedron_Print</a>(fp,format,A-&gt;P);  
00345   <font class="keywordflow">return</font>;
00346 } <font class="comment">/* ZPolyhedronPrint */</font>
00347 
00348 <font class="comment">/*</font>
00349 <font class="comment"> * Return the Z-domain union of the Z-domain 'A' and 'B'. The dimensions of the</font>
00350 <font class="comment"> * Z-domains 'A' and 'B' must be equal. All the Z-polyhedra of the resulting </font>
00351 <font class="comment"> * union are expected to be in Canonical forms.</font>
00352 <font class="comment"> */</font>
<a name="l00353"></a><a class="code" href="Zpolyhedron_8c.html#a18">00353</a> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a18">ZDomainUnion</a> (ZPolyhedron *A, ZPolyhedron *B) {
00354   
00355   ZPolyhedron *Result = NULL, *temp;
00356   
00357 <font class="preprocessor">#ifdef DOMDEBUG</font>
00358 <font class="preprocessor"></font>  FILE *fp;
00359   fp = fopen(<font class="stringliteral">"_debug"</font>, <font class="stringliteral">"a"</font>);
00360   fprintf(fp,<font class="stringliteral">"\nEntered ZDOMAINUNION\n"</font>);
00361   fclose(fp);
00362 <font class="preprocessor">#endif</font>
00363 <font class="preprocessor"></font>
00364   <font class="keywordflow">for</font>(temp = A; temp != NULL; temp = temp-&gt;next)
00365     Result = <a class="code" href="Zpolyhedron_8c.html#a7">AddZPolytoZDomain</a>(temp, Result); 
00366   <font class="keywordflow">for</font>(temp = B; temp != NULL; temp = temp-&gt;next )
00367     Result = <a class="code" href="Zpolyhedron_8c.html#a7">AddZPolytoZDomain</a>(temp, Result);
00368   <font class="keywordflow">return</font> Result;
00369 } <font class="comment">/* ZDomainUnion */</font>
00370 
00371 <font class="comment">/* </font>
00372 <font class="comment"> * Return the Z-domain intersection of the Z-domains 'A' and 'B'.The dimensions</font>
00373 <font class="comment"> * of domains 'A' and 'B' must be equal. </font>
00374 <font class="comment"> */</font>
<a name="l00375"></a><a class="code" href="Zpolyhedron_8c.html#a19">00375</a> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a19">ZDomainIntersection</a> (ZPolyhedron *A, ZPolyhedron *B) {
00376   
00377   ZPolyhedron *Result = NULL, *tempA = NULL, *tempB = NULL;
00378 
00379 <font class="preprocessor">#ifdef DOMDEBUG</font>
00380 <font class="preprocessor"></font>  FILE *fp;
00381   fp = fopen(<font class="stringliteral">"_debug"</font>, <font class="stringliteral">"a"</font>);
00382   fprintf(fp,<font class="stringliteral">"\nEntered ZDOMAININTERSECTION\n"</font>);
00383   fclose(fp);
00384 <font class="preprocessor">#endif  </font>
00385 <font class="preprocessor"></font>  
00386   <font class="keywordflow">for</font>(tempA = A; tempA != NULL; tempA = tempA-&gt;next)
00387     <font class="keywordflow">for</font>(tempB = B; tempB != NULL; tempB = tempB-&gt;next) {
00388       ZPolyhedron *Zpol;
00389       Zpol = <a class="code" href="Zpolyhedron_8c.html#a1">ZPolyhedronIntersection</a>(tempA, tempB);
00390       Result = <a class="code" href="Zpolyhedron_8c.html#a7">AddZPolytoZDomain</a>(Zpol, Result );
00391       <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a> (Zpol);
00392     }
00393   <font class="keywordflow">if</font> (Result == NULL)
00394     <font class="keywordflow">return</font> <a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a> (A-&gt;Lat-&gt;NbRows-1);
00395   <font class="keywordflow">return</font> Result;
00396 } <font class="comment">/* ZDomainIntersection */</font>
00397 
00398 <font class="comment">/*</font>
00399 <font class="comment"> * Return the Z-domain difference of the domains 'A' and 'B'. The dimensions of</font>
00400 <font class="comment"> * the Z-domains 'A' and 'B' must be equal. Note that the difference of two </font>
00401 <font class="comment"> * Z-polyhedra is a Union of Z-polyhedra. The algorithms is as given below :-</font>
00402 <font class="comment"> * Algorithm: (Given Z-domains A and B)</font>
00403 <font class="comment"> *           Result &lt;-- NULL</font>
00404 <font class="comment"> *           for every Z-polyhderon Zpoly of A {</font>
00405 <font class="comment"> *               temp &lt;-- Zpoly;</font>
00406 <font class="comment"> *               for every Z-polyhderon Z1 of B</font>
00407 <font class="comment"> *                  temp = temp - Z1;</font>
00408 <font class="comment"> *               }</font>
00409 <font class="comment"> *           Add temp to Result;</font>
00410 <font class="comment"> *           return;</font>
00411 <font class="comment"> */</font>
<a name="l00412"></a><a class="code" href="Zpolyhedron_8c.html#a20">00412</a> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a20">ZDomainDifference</a>(ZPolyhedron  *A, ZPolyhedron *B) {
00413   
00414   ZPolyhedron *Result = NULL, *tempA = NULL, *tempB = NULL;
00415   ZPolyhedron *templist, *res, *i, *j;
00416 
00417 <font class="preprocessor">#ifdef DOMDEBUG</font>
00418 <font class="preprocessor"></font>  FILE *fp;
00419   fp = fopen(<font class="stringliteral">"_debug"</font>, <font class="stringliteral">"a"</font>);
00420   fprintf(fp,<font class="stringliteral">"\nEntered ZDOMAINDIFFERENCE\n"</font>);
00421   fclose(fp);
00422 <font class="preprocessor">#endif</font>
00423 <font class="preprocessor"></font>  
00424   <font class="keywordflow">if</font> (A-&gt;Lat-&gt;NbRows != B-&gt;Lat-&gt;NbRows) {
00425     fprintf(stderr, <font class="stringliteral">"In ZDomainDifference : The Input ZDomains"</font>);
00426     fprintf(stderr, <font class="stringliteral">"Do not have the compatible dimensions\n"</font>);
00427     fprintf(stderr, <font class="stringliteral">"ZDomainDiffernce not performed\n"</font>);
00428     <font class="keywordflow">return</font> NULL;
00429   }
00430   
00431   <font class="keywordflow">for</font>(tempA = A; tempA != NULL; tempA = tempA-&gt;next) {
00432     ZPolyhedron *temp = NULL;
00433     temp = <a class="code" href="Zpolyhedron_8c.html#a2">ZPolyhedron_Copy</a>(tempA);
00434     
00435     <font class="keywordflow">for</font>(tempB = B; tempB != NULL; tempB = tempB-&gt;next) {
00436       templist = NULL; res = NULL;
00437       <font class="comment">//for(i = temp; i != NULL; i = i-&gt;next) {</font>
00438         i=temp;
00439         res = <a class="code" href="Zpolyhedron_8c.html#a4">ZPolyhedronDifference</a>(i,tempB);
00440         <font class="keywordflow">for</font> (j = res; j != NULL; j = j-&gt;next )
00441           templist = <a class="code" href="Zpolyhedron_8c.html#a13">AddZPoly2ZDomain</a>(j,templist);
00442         <a class="code" href="Zpolyhedron_8c.html#a11">ZDomain_Free</a>(res);
00443       <font class="comment">//}</font>
00444       <a class="code" href="Zpolyhedron_8c.html#a11">ZDomain_Free</a> (temp);
00445       temp = NULL; 
00446       <font class="keywordflow">for</font>(i = templist; i != NULL; i = i-&gt;next)
00447         temp = <a class="code" href="Zpolyhedron_8c.html#a13">AddZPoly2ZDomain</a>(i, temp);
00448       <a class="code" href="Zpolyhedron_8c.html#a11">ZDomain_Free</a> (templist);
00449     }
00450     <font class="keywordflow">for</font>(i = temp; i != NULL; i = i-&gt;next)
00451       Result = <a class="code" href="Zpolyhedron_8c.html#a7">AddZPolytoZDomain</a>(i, Result);
00452     <a class="code" href="Zpolyhedron_8c.html#a11">ZDomain_Free</a>(temp);    
00453   }
00454   <font class="keywordflow">if</font> (Result==NULL)
00455     <font class="keywordflow">return</font> (<a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a>(A-&gt;Lat-&gt;NbRows-1));
00456   <font class="keywordflow">return</font> Result;
00457 } <font class="comment">/* ZDomainDifference */</font>
00458 
00459 <font class="comment">/*</font>
00460 <font class="comment"> * Return the image of the Z-domain 'A' under the invertible, affine, rational</font>
00461 <font class="comment"> * transformation function 'Func'. The matrix representing the function 'Func'</font>
00462 <font class="comment"> * must be non-singular and the number of rows of the function must be equal</font>
00463 <font class="comment"> * to the number of rows in the matrix representing the lattice of 'A'. </font>
00464 <font class="comment"> * Note:: Image((Z1 U Z2),F) = Image(Z1,F) U Image(Z2 U F).</font>
00465 <font class="comment"> */</font>
<a name="l00466"></a><a class="code" href="Zpolyhedron_8c.html#a21">00466</a> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a21">ZDomainImage</a> (ZPolyhedron *A, Matrix *Func) {
00467 
00468   ZPolyhedron *Result = NULL, *temp;
00469 
00470 <font class="preprocessor">#ifdef DOMDEBUG</font>
00471 <font class="preprocessor"></font>  FILE *fp;
00472   fp = fopen (<font class="stringliteral">"_debug"</font>, <font class="stringliteral">"a"</font>);
00473   fprintf (fp, <font class="stringliteral">"\nEntered ZDOMAINIMAGE\n"</font>);
00474   fclose (fp);
00475 <font class="preprocessor">#endif  </font>
00476 <font class="preprocessor"></font>  
00477   <font class="keywordflow">for</font>(temp = A; temp != NULL; temp = temp-&gt;next) {
00478     ZPolyhedron *Zpol;
00479     Zpol =  <a class="code" href="Zpolyhedron_8c.html#a5">ZPolyhedronImage</a> (temp, Func);
00480     Result = <a class="code" href="Zpolyhedron_8c.html#a7">AddZPolytoZDomain</a> (Zpol, Result);
00481     <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a> (Zpol);
00482   }  
00483   <font class="keywordflow">if</font>(Result == NULL)
00484     <font class="keywordflow">return</font> <a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a>(A-&gt;Lat-&gt;NbRows-1);  
00485   <font class="keywordflow">return</font> Result;
00486 } <font class="comment">/* ZDomainImage */</font> 
00487 
00488 <font class="comment">/*</font>
00489 <font class="comment"> * Return the preimage of the Z-domain 'A' under the invertible, affine, ratio-</font>
00490 <font class="comment"> * nal transformation 'Func'. The number of rows of the matrix representing </font>
00491 <font class="comment"> * the function 'Func' must be equal to the number of rows of the matrix repr-</font>
00492 <font class="comment"> * senting the lattice of 'A'.  </font>
00493 <font class="comment"> */</font>
<a name="l00494"></a><a class="code" href="Zpolyhedron_8c.html#a22">00494</a> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a22">ZDomainPreimage</a> (ZPolyhedron *A, Matrix *Func) {
00495 
00496   ZPolyhedron *Result = NULL, *temp ;
00497   
00498 <font class="preprocessor">#ifdef DOMDEBUG</font>
00499 <font class="preprocessor"></font>  FILE *fp;
00500   fp = fopen(<font class="stringliteral">"_debug"</font>, <font class="stringliteral">"a"</font>);
00501   fprintf(fp,<font class="stringliteral">"\nEntered ZDOMAINPREIMAGE\n"</font>);
00502   fclose(fp);
00503 <font class="preprocessor">#endif</font>
00504 <font class="preprocessor"></font>  
00505   <font class="keywordflow">if</font> (A-&gt;Lat-&gt;NbRows != Func-&gt;NbRows) {
00506     fprintf(stderr,<font class="stringliteral">"\nError : In ZDomainPreimage, "</font>);
00507     fprintf(stderr,<font class="stringliteral">"Incompatible dimensions of ZPolyhedron "</font>);
00508     fprintf(stderr,<font class="stringliteral">"and the Function \n"</font>);
00509     <font class="keywordflow">return</font>(<a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a>(Func-&gt;NbColumns-1)); 
00510   }  
00511   <font class="keywordflow">for</font>(temp = A; temp != NULL; temp = temp-&gt;next) {       
00512     ZPolyhedron *Zpol;
00513     Zpol = <a class="code" href="Zpolyhedron_8c.html#a6">ZPolyhedronPreimage</a>(temp, Func);
00514     Result = <a class="code" href="Zpolyhedron_8c.html#a7">AddZPolytoZDomain</a>(Zpol, Result);
00515     <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a>(Zpol);
00516   }  
00517   <font class="keywordflow">if</font> (Result == NULL)
00518     <font class="keywordflow">return</font>(<a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a>(Func-&gt;NbColumns-1));
00519   <font class="keywordflow">return</font> Result;   
00520 } <font class="comment">/* ZDomainPreimage */</font> 
00521 
00522 <font class="comment">/*</font>
00523 <font class="comment"> * Return the Z-polyhedron intersection of the Z-polyhedra 'A' and 'B'. </font>
00524 <font class="comment"> * Note: If Z1 = L1 (intersect) P1 and Z2 = L2 (intersect) P2, then </font>
00525 <font class="comment"> *     Z1 (intersect) Z2 = (L1 (intersect) L2) (intersect) (P1 (intersect) P2) </font>
00526 <font class="comment"> */</font>
<a name="l00527"></a><a class="code" href="Zpolyhedron_8c.html#a1">00527</a> <font class="keyword">static</font> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a1">ZPolyhedronIntersection</a>(ZPolyhedron *A, ZPolyhedron *B) {
00528   
00529   ZPolyhedron *Result = NULL;
00530   Lattice *LInter;
00531   Polyhedron *PInter, *ImageA, *ImageB, *PreImage;
00532   
00533 <font class="preprocessor">#ifdef DOMDEBUG</font>
00534 <font class="preprocessor"></font>  FILE *fp;
00535   fp = fopen(<font class="stringliteral">"_debug"</font>,<font class="stringliteral">"a"</font>);
00536   fprintf(fp,<font class="stringliteral">"\nEntered ZPOLYHEDRONINTERSECTION\n"</font>);
00537   fclose(fp);
00538 <font class="preprocessor">#endif  </font>
00539 <font class="preprocessor"></font>  
00540   LInter = <a class="code" href="Lattice_8c.html#a16">LatticeIntersection</a>(A-&gt;Lat,B-&gt;Lat);
00541   <font class="keywordflow">if</font>(<a class="code" href="Lattice_8c.html#a6">isEmptyLattice</a>(LInter) == True) {
00542     <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a> (Result);
00543     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(LInter);
00544     <font class="keywordflow">return</font> (<a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a>(A-&gt;Lat-&gt;NbRows-1));
00545   }  
00546   ImageA = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(A-&gt;P,A-&gt;Lat,MAXNOOFRAYS);
00547   ImageB = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(B-&gt;P,B-&gt;Lat,MAXNOOFRAYS);
00548   PInter = <a class="code" href="polyhedron_8c.html#a32">DomainIntersection</a>(ImageA,ImageB,MAXNOOFRAYS); 
00549   <font class="keywordflow">if</font> (emptyQ(PInter))
00550     Result = <a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a>(LInter-&gt;NbRows-1);
00551   <font class="keywordflow">else</font> { 
00552     PreImage = <a class="code" href="polyhedron_8c.html#a51">DomainPreimage</a>(PInter,(Matrix *)LInter,MAXNOOFRAYS);
00553     Result = <a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(LInter, PreImage);    
00554     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a> (PreImage);
00555   }  
00556   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(LInter);
00557   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(PInter); 
00558   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(ImageA);
00559   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(ImageB);  
00560   <font class="keywordflow">return</font> Result ;
00561 } <font class="comment">/* ZPolyhedronIntersection */</font> 
00562 
00563 <font class="comment">/* </font>
00564 <font class="comment"> * Return the difference of the two Z-polyhedra 'A' and 'B'. Below is the </font>
00565 <font class="comment"> * procedure to find the difference of 'A' and 'B' :-</font>
00566 <font class="comment"> * Procedure: </font>
00567 <font class="comment"> *     Let A = L1 (intersect) P1' and B = L2 (intersect) P2' where </font>
00568 <font class="comment"> *     (P1' = DomImage(P1,L1) and P2' = DomImage(P2,L2)). Then </font>
00569 <font class="comment"> *     A-B = L1 (intersect) (P1'-P2') Union </font>
00570 <font class="comment"> *           (L1-L2) (intersect) (P1' (intersect) P2')</font>
00571 <font class="comment"> */</font> 
<a name="l00572"></a><a class="code" href="Zpolyhedron_8c.html#a4">00572</a> <font class="keyword">static</font> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a4">ZPolyhedronDifference</a>(ZPolyhedron *A, ZPolyhedron *B) {
00573   
00574   ZPolyhedron *Result = NULL ;
00575   LatticeUnion *LatDiff, *temp;
00576   Polyhedron *DomDiff, *DomInter, *PreImage, *ImageA, *ImageB;
00577   Bool flag = False;
00578 
00579 <font class="preprocessor">#ifdef DOMDEBUG</font>
00580 <font class="preprocessor"></font>  FILE *fp;
00581   fp = fopen(<font class="stringliteral">"_debug"</font>, <font class="stringliteral">"a"</font>);
00582   fprintf(fp,<font class="stringliteral">"\nEntered ZPOLYHEDRONDIFFERENCE\n"</font>);
00583   fclose(fp);
00584 <font class="preprocessor">#endif</font>
00585 <font class="preprocessor"></font>
00586   <font class="keywordflow">if</font>(<a class="code" href="Zpolyhedron_8c.html#a9">isEmptyZPolyhedron</a> (A))
00587     <font class="keywordflow">return</font> NULL;
00588   <font class="keywordflow">if</font>(<a class="code" href="Zpolyhedron_8c.html#a9">isEmptyZPolyhedron</a> (B)) {
00589     Result = <a class="code" href="Zpolyhedron_8c.html#a12">ZDomain_Copy</a> (A);
00590     <font class="keywordflow">return</font> Result;
00591   }  
00592   ImageA = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(A-&gt;P,(Matrix *)A-&gt;Lat,MAXNOOFRAYS);
00593   ImageB = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(B-&gt;P,(Matrix *)B-&gt;Lat,MAXNOOFRAYS);  
00594   DomDiff = <a class="code" href="polyhedron_8c.html#a46">DomainDifference</a>(ImageA,ImageB,MAXNOOFRAYS);
00595   <font class="keywordflow">if</font> (emptyQ (DomDiff))
00596     flag = True;
00597   <font class="keywordflow">else</font> {
00598     ZPolyhedron *Z;
00599     PreImage = <a class="code" href="polyhedron_8c.html#a51">DomainPreimage</a>(DomDiff,A-&gt;Lat,MAXNOOFRAYS);
00600     Z = <a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(A-&gt;Lat,PreImage);    
00601     Result = <a class="code" href="Zpolyhedron_8c.html#a7">AddZPolytoZDomain</a>(Z,Result);
00602   }  
00603   <font class="keywordflow">if</font> (flag == True)  <font class="comment">/* DomDiff = NULL; DomInter = A */</font>
00604     DomInter = <a class="code" href="polyhedron_8c.html#a37">Domain_Copy</a>(ImageA);
00605   <font class="keywordflow">else</font> {
00606     DomInter = <a class="code" href="polyhedron_8c.html#a32">DomainIntersection</a>(ImageA,ImageB,MAXNOOFRAYS);
00607     <font class="keywordflow">if</font> (emptyQ(DomInter)) {
00608       <font class="keywordflow">if</font> (flag == True)
00609         <font class="keywordflow">return</font> (<a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a>(A-&gt;Lat-&gt;NbRows-1));
00610       <font class="keywordflow">else</font>
00611         <font class="keywordflow">return</font> Result;
00612     }
00613   }  
00614   LatDiff = <a class="code" href="Lattice_8c.html#a21">LatticeDifference</a>(A-&gt;Lat, B-&gt;Lat);
00615   <font class="keywordflow">if</font>(LatDiff == NULL)
00616     <font class="keywordflow">if</font>(flag == True )
00617       <font class="keywordflow">return</font>(<a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a> (A-&gt;Lat-&gt;NbRows-1));
00618   
00619   <font class="keywordflow">while</font> (LatDiff != NULL) {
00620     ZPolyhedron *tempZ = NULL;
00621     
00622     PreImage = <a class="code" href="polyhedron_8c.html#a51">DomainPreimage</a>(DomInter, LatDiff-&gt;M, MAXNOOFRAYS);    
00623     tempZ = <a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(LatDiff-&gt;M, PreImage);
00624     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(PreImage);
00625     Result = <a class="code" href="Zpolyhedron_8c.html#a13">AddZPoly2ZDomain</a>(tempZ,Result);
00626     <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a>(tempZ);
00627     temp = LatDiff;
00628     LatDiff = LatDiff-&gt;next;  
00629     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> ((Matrix *) temp-&gt;M);
00630     free (temp);
00631   }  
00632   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a> (DomInter);
00633   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a> (DomDiff);
00634   <font class="keywordflow">return</font> Result;
00635 } <font class="comment">/* ZPolyhedronDifference */</font> 
00636 
00637 <font class="comment">/*</font>
00638 <font class="comment"> * Return the image of the Z-polyhedron 'ZPol' under the invertible, affine, </font>
00639 <font class="comment"> * rational transformation function 'Func'. The matrix representing the funct-</font>
00640 <font class="comment"> * ion must be non-singular and the number of rows of the function must be </font>
00641 <font class="comment"> * equal to the number of rows in the matrix representing the lattice of 'ZPol'</font>
00642 <font class="comment"> * Algorithm: </font>
00643 <font class="comment"> *         1)  Let ZPol = L (intersect) Q</font>
00644 <font class="comment"> *         2)  L1 = LatticeImage(L,F)</font>
00645 <font class="comment"> *         3)  Q1 = DomainImage(Q,F)</font>
00646 <font class="comment"> *         4)  Z1 = L1(Inverse(L1)*Q1)</font>
00647 <font class="comment"> *         5)  Return Z1</font>
00648 <font class="comment"> */</font>
<a name="l00649"></a><a class="code" href="Zpolyhedron_8c.html#a5">00649</a> <font class="keyword">static</font> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a5">ZPolyhedronImage</a>(ZPolyhedron *ZPol,Matrix *Func) {
00650  
00651   ZPolyhedron *Result = NULL ;
00652   Matrix *LatIm ;
00653   Polyhedron *Pol, *PolImage ; 
00654   
00655 <font class="preprocessor">#ifdef DOMDEBUG</font>
00656 <font class="preprocessor"></font>  FILE *fp;
00657   fp = fopen(<font class="stringliteral">"_debug"</font>, <font class="stringliteral">"a"</font>);
00658   fprintf(fp,<font class="stringliteral">"\nEntered ZPOLYHEDRONIMAGE\n"</font>);
00659   fclose(fp);
00660 <font class="preprocessor">#endif</font>
00661 <font class="preprocessor"></font>  
00662   <font class="keywordflow">if</font> ((Func-&gt;NbRows != ZPol-&gt;Lat-&gt;NbRows) || (Func-&gt;NbColumns != ZPol-&gt;Lat-&gt;NbColumns)) {
00663     fprintf (stderr, <font class="stringliteral">"In ZPolImage - The Function, is not compatible with the ZPolyhedron\n"</font>);
00664     <font class="keywordflow">return</font> NULL;
00665   }
00666   LatIm = <a class="code" href="Lattice_8c.html#a24">LatticeImage</a>(ZPol-&gt;Lat,Func);
00667   <font class="keywordflow">if</font> (<a class="code" href="Lattice_8c.html#a6">isEmptyLattice</a>(LatIm)) {
00668     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(LatIm);
00669     <font class="keywordflow">return</font> NULL;
00670   }
00671   Pol = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(ZPol-&gt;P,ZPol-&gt;Lat,MAXNOOFRAYS);
00672   PolImage = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(Pol,Func,MAXNOOFRAYS);
00673   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Pol);
00674   <font class="keywordflow">if</font>(emptyQ(PolImage)) {
00675     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (LatIm);
00676     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a> (PolImage);
00677     <font class="keywordflow">return</font> NULL;
00678   } 
00679   Pol = <a class="code" href="polyhedron_8c.html#a51">DomainPreimage</a>(PolImage,LatIm,MAXNOOFRAYS);
00680   Result = <a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(LatIm,Pol);
00681   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Pol);
00682   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(PolImage);
00683   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(LatIm);
00684   <font class="keywordflow">return</font> Result;  
00685 } <font class="comment">/* ZPolyhedronImage */</font> 
00686 
00687 <font class="comment">/*</font>
00688 <font class="comment"> * Return the preimage of the Z-polyhedron 'Zpol' under an affine transformati-</font>
00689 <font class="comment"> * on function 'G'. The number of rows of matrix representing the function 'G',</font>
00690 <font class="comment"> * must be equal to the number of rows of the matrix representing the lattice </font>
00691 <font class="comment"> * of Z1. </font>
00692 <font class="comment"> * Algorithm: </font>
00693 <font class="comment"> *            1) Let Zpol = L (intersect) Q</font>
00694 <font class="comment"> *            2) L1 =LatticePreimage(L,F);</font>
00695 <font class="comment"> *            3) Q1 = DomainPreimage(Q,F);</font>
00696 <font class="comment"> *            4) Z1 = L1(Inverse(L1)*Q1);</font>
00697 <font class="comment"> *            5) Return Z1</font>
00698 <font class="comment"> */</font>
<a name="l00699"></a><a class="code" href="Zpolyhedron_8c.html#a6">00699</a> <font class="keyword">static</font> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a6">ZPolyhedronPreimage</a>(ZPolyhedron *Zpol, Matrix *G) {
00700   
00701   Lattice *Latpreim;
00702   Polyhedron *Qprime, *Q, *Polpreim;
00703   ZPolyhedron *Result;
00704   
00705 <font class="preprocessor">#ifdef DOMDEBUG</font>
00706 <font class="preprocessor"></font>  FILE *fp;
00707   fp = fopen(<font class="stringliteral">"_debug"</font>,<font class="stringliteral">"a"</font>);
00708   fprintf(fp,<font class="stringliteral">"\nEntered ZPOLYHEDRONPREIMAGE\n"</font>);
00709   fclose(fp);
00710 <font class="preprocessor">#endif</font>
00711 <font class="preprocessor"></font>  
00712   <font class="keywordflow">if</font>(G-&gt;NbRows != Zpol-&gt;Lat-&gt;NbRows) {
00713     fprintf(stderr,<font class="stringliteral">"\nIn ZPolyhedronPreimage: Error, The dimensions of the "</font>);
00714     fprintf(stderr,<font class="stringliteral">"function are not compatible with that of the Zpolyhedron"</font>);
00715     <font class="keywordflow">return</font> <a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a>(G-&gt;NbColumns-1);
00716   }
00717   Q = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(Zpol-&gt;P,Zpol-&gt;Lat,MAXNOOFRAYS);
00718   Polpreim = <a class="code" href="polyhedron_8c.html#a51">DomainPreimage</a>(Q,G,MAXNOOFRAYS);
00719   <font class="keywordflow">if</font> (emptyQ(Polpreim))
00720     Result = NULL;
00721   <font class="keywordflow">else</font> {
00722     Latpreim = <a class="code" href="Lattice_8c.html#a25">LatticePreimage</a>(Zpol-&gt;Lat,G);
00723     <font class="keywordflow">if</font>(<a class="code" href="Lattice_8c.html#a6">isEmptyLattice</a>(Latpreim))
00724       Result = NULL;
00725     <font class="keywordflow">else</font> {
00726       Qprime = <a class="code" href="polyhedron_8c.html#a51">DomainPreimage</a>(Polpreim, Latpreim, MAXNOOFRAYS);
00727       Result = <a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(Latpreim, Qprime);
00728       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Qprime);
00729     }
00730     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(Latpreim);
00731   }  
00732   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Q);
00733   <font class="keywordflow">return</font> Result; 
00734 } <font class="comment">/* ZPolyhedronPreimage */</font> 
00735 
00736 <font class="comment">/* </font>
00737 <font class="comment"> * Return the Z-polyhderon 'Zpol' in canonical form: 'Result' (for the Z-poly-</font>
00738 <font class="comment"> * hedron in canonical form) and Basis 'Basis' (for the basis with respect to </font>
00739 <font class="comment"> * which 'Result' is in canonical form.   </font>
00740 <font class="comment"> */</font>
<a name="l00741"></a><a class="code" href="Zpolyhedron_8c.html#a23">00741</a> <font class="keywordtype">void</font> <a class="code" href="Zpolyhedron_8c.html#a23">CanonicalForm</a>(ZPolyhedron *Zpol,ZPolyhedron **Result,Matrix **Basis) {
00742 
00743   Matrix *B1 = NULL, *B2=NULL, *T1 , *B2inv;
00744   <font class="keywordtype">int</font> i, l1, l2;
00745   <a class="code" href="arithmetique_8h.html#a93">Value</a> tmp;
00746   Polyhedron *Image, *ImageP;
00747   Matrix *H, *U, *temp, *Hprime, *Uprime, *T2;
00748   
00749 <font class="preprocessor">#ifdef DOMDEBUG</font>
00750 <font class="preprocessor"></font>  FILE *fp;
00751   fp = fopen(<font class="stringliteral">"_debug"</font>, <font class="stringliteral">"a"</font>);
00752   fprintf(fp,<font class="stringliteral">"\nEntered CANONICALFORM\n"</font>);
00753   fclose(fp);
00754 <font class="preprocessor">#endif</font>
00755 <font class="preprocessor"></font>  
00756   <font class="keywordflow">if</font>(<a class="code" href="Zpolyhedron_8c.html#a9">isEmptyZPolyhedron</a> (Zpol)) {
00757     Basis[0] = <a class="code" href="Matop_8c.html#a1">Identity</a>(Zpol-&gt;Lat-&gt;NbRows);
00758     Result[0] = <a class="code" href="Zpolyhedron_8c.html#a12">ZDomain_Copy</a> (Zpol);
00759     <font class="keywordflow">return</font> ;
00760   }
00761   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
00762   l1 = <a class="code" href="Lattice_8c.html#a23">FindHermiteBasisofDomain</a>(Zpol-&gt;P,&amp;B1);
00763   Image = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a> (Zpol-&gt;P,(Matrix *)Zpol-&gt;Lat,MAXNOOFRAYS);
00764   l2 = <a class="code" href="Lattice_8c.html#a23">FindHermiteBasisofDomain</a>(Image,&amp;B2);
00765     
00766   <font class="keywordflow">if</font> (l1 != l2)
00767     fprintf(stderr,<font class="stringliteral">"In CNF : Something wrong with the Input Zpolyhedra \n"</font>); 
00768   
00769   B2inv = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(B2-&gt;NbRows, B2-&gt;NbColumns);
00770   temp = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(B2);
00771   <a class="code" href="matrix_8c.html#a13">Matrix_Inverse</a>(temp,B2inv);
00772   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(temp);
00773   
00774   temp = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(B2inv-&gt;NbRows,Zpol-&gt;Lat-&gt;NbColumns);
00775   T1 = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(temp-&gt;NbRows,B1-&gt;NbColumns);
00776   <a class="code" href="matrix_8c.html#a12">Matrix_Product</a>(B2inv,(Matrix *)Zpol-&gt;Lat,temp);
00777   <a class="code" href="matrix_8c.html#a12">Matrix_Product</a>(temp,B1,T1);  
00778   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(temp);
00779   
00780   T2 = <a class="code" href="Lattice_8c.html#a13">ChangeLatticeDimension</a>(T1,l1);
00781   temp = <a class="code" href="Lattice_8c.html#a13">ChangeLatticeDimension</a>(T2,T2-&gt;NbRows+1);
00782 
00783   <font class="comment">/* Adding the affine part */</font>
00784   <font class="keywordflow">for</font>(i = 0; i &lt; l1; i ++)
00785     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(temp-&gt;p[i][temp-&gt;NbColumns-1],T1-&gt;p[i][T1-&gt;NbColumns-1]);
00786   
00787   <a class="code" href="Lattice_8c.html#a8">AffineHermite</a>(temp,&amp;H,&amp;U);
00788   Hprime = <a class="code" href="Lattice_8c.html#a13">ChangeLatticeDimension</a>(H,Zpol-&gt;Lat-&gt;NbRows);
00789   
00790   <font class="comment">/* Exchanging the Affine part */</font>
00791   <font class="keywordflow">for</font>(i = 0; i &lt; l1; i ++) {
00792     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(tmp,Hprime-&gt;p[i][Hprime-&gt;NbColumns-1]);
00793     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(Hprime-&gt;p[i][Hprime-&gt;NbColumns-1],Hprime-&gt;p[i][H-&gt;NbColumns-1]);
00794     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(Hprime-&gt;p[i][H-&gt;NbColumns-1],tmp);
00795   }
00796   Uprime = <a class="code" href="Lattice_8c.html#a13">ChangeLatticeDimension</a>(U,Zpol-&gt;Lat-&gt;NbRows);
00797   
00798   <font class="comment">/* Exchanging the Affine part */</font>
00799   <font class="keywordflow">for</font> (i = 0;i &lt; l1; i++) {
00800     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(tmp,Uprime-&gt;p[i][Uprime-&gt;NbColumns-1]);
00801     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(Uprime-&gt;p[i][Uprime-&gt;NbColumns-1],Uprime-&gt;p[i][U-&gt;NbColumns-1]);
00802     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(Uprime-&gt;p[i][U-&gt;NbColumns-1],tmp);
00803   }    
00804   <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a> (Image);
00805   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (B2inv);
00806   B2inv = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(B1-&gt;NbRows, B1-&gt;NbColumns);
00807   <a class="code" href="matrix_8c.html#a13">Matrix_Inverse</a>(B1,B2inv);
00808   ImageP = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(Zpol-&gt;P, B2inv, MAXNOOFRAYS);
00809   Image = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(ImageP, Uprime, MAXNOOFRAYS);
00810   Result[0] = <a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(Hprime, Image);
00811   Basis[0] = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(B2); 
00812   
00813   <font class="comment">/* Free the variables */</font>
00814   <a class="code" href="polyhedron_8c.html#a18">Polyhedron_Free</a> (Image);
00815   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (B1);
00816   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (B2);
00817   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (temp);
00818   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (T1);
00819   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (T2);
00820   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (H);
00821   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (U);
00822   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (Hprime);
00823   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (Uprime);
00824   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00825   <font class="keywordflow">return</font>;
00826 } <font class="comment">/* CanonicalForm */</font> 
00827 
00828 <font class="comment">/*</font>
00829 <font class="comment"> * Given a Z-polyhedron 'A' in which the Lattice is not integral, return the</font>
00830 <font class="comment"> * Z-polyhedron which contains all the integral points in the input lattice.</font>
00831 <font class="comment"> */</font>
<a name="l00832"></a><a class="code" href="Zpolyhedron_8c.html#a24">00832</a> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a24">IntegraliseLattice</a>(ZPolyhedron *A) {
00833  
00834   ZPolyhedron *Result;
00835   Lattice *M = NULL, *Id;
00836   Polyhedron *Im = NULL, *Preim = NULL;
00837 
00838 <font class="preprocessor">#ifdef DOMDEBUG</font>
00839 <font class="preprocessor"></font>  FILE *fp;
00840   fp = fopen(<font class="stringliteral">"_debug"</font>,<font class="stringliteral">"a"</font>);
00841   fprintf(fp,<font class="stringliteral">"\nEntered INTEGRALISELATTICE\n"</font>);
00842   fclose(fp);
00843 <font class="preprocessor">#endif</font>
00844 <font class="preprocessor"></font>  
00845   Im = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(A-&gt;P,A-&gt;Lat,MAXNOOFRAYS);
00846   Id = <a class="code" href="Matop_8c.html#a1">Identity</a>(A-&gt;Lat-&gt;NbRows);
00847   M = <a class="code" href="Lattice_8c.html#a24">LatticeImage</a>(Id, A-&gt;Lat);
00848   <font class="keywordflow">if</font> (<a class="code" href="Lattice_8c.html#a6">isEmptyLattice</a>(M))
00849     Result = <a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a>(A-&gt;Lat-&gt;NbRows-1);
00850   <font class="keywordflow">else</font> {
00851     Preim = <a class="code" href="polyhedron_8c.html#a51">DomainPreimage</a>(Im,M,MAXNOOFRAYS);
00852     Result = <a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(M,Preim);
00853   }  
00854   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(M);
00855   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Im);
00856   <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Preim);  
00857   <font class="keywordflow">return</font> Result;
00858 } <font class="comment">/* IntegraliseLattice */</font> 
00859 
00860 <font class="comment">/* </font>
00861 <font class="comment"> * Return the simplified representation of the Z-domain 'ZDom'. It attempts to </font>
00862 <font class="comment"> * convexize unions of polyhedra when they correspond to the same lattices and</font>
00863 <font class="comment"> * to simplify union of lattices when they correspond to the same polyhdera. </font>
00864 <font class="comment"> */</font>
<a name="l00865"></a><a class="code" href="Zpolyhedron_8c.html#a25">00865</a> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a25">ZDomainSimplify</a>(ZPolyhedron *ZDom) {
00866   
00867   ZPolyhedron *Ztmp, *Result;
00868   <a class="code" href="structforsimplify.html">ForSimplify</a> *Head, *Prev, *Curr;
00869   ZPolyhedron *ZDomHead, *Emp;
00870   
00871   <font class="keywordflow">if</font> (ZDom == NULL) {
00872     fprintf(stderr,<font class="stringliteral">"\nError in ZDomainSimplify - ZDomHead = NULL\n"</font>);
00873     <font class="keywordflow">return</font> NULL;
00874   }  
00875   <font class="keywordflow">if</font> (ZDom-&gt;next == NULL)
00876     <font class="keywordflow">return</font> (<a class="code" href="Zpolyhedron_8c.html#a2">ZPolyhedron_Copy</a> (ZDom));  
00877   Emp = <a class="code" href="Zpolyhedron_8c.html#a14">EmptyZPolyhedron</a>(ZDom-&gt;Lat-&gt;NbRows-1);
00878   ZDomHead = <a class="code" href="Zpolyhedron_8c.html#a18">ZDomainUnion</a>(ZDom, Emp);
00879   <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a>(Emp);  
00880   Head = NULL;
00881   Ztmp = ZDomHead;
00882   <font class="keywordflow">do</font> {
00883     Polyhedron *Img;
00884     Img = <a class="code" href="polyhedron_8c.html#a53">DomainImage</a>(Ztmp-&gt;P,Ztmp-&gt;Lat,MAXNOOFRAYS);
00885     <font class="keywordflow">for</font>(Curr = Head; Curr != NULL; Curr = Curr-&gt;<a class="code" href="structforsimplify.html#m2">next</a>) {
00886       Polyhedron *Diff1;
00887       Bool flag = False;
00888       
00889       Diff1 = <a class="code" href="polyhedron_8c.html#a46">DomainDifference</a>(Img,Curr-&gt;<a class="code" href="structforsimplify.html#m0">Pol</a>,MAXNOOFRAYS);
00890       <font class="keywordflow">if</font> (emptyQ(Diff1)) {
00891         Polyhedron *Diff2;
00892 
00893         Diff2 = <a class="code" href="polyhedron_8c.html#a46">DomainDifference</a>(Curr-&gt;<a class="code" href="structforsimplify.html#m0">Pol</a>,Img,MAXNOOFRAYS); 
00894         <font class="keywordflow">if</font> (emptyQ(Diff2))
00895           flag = True;  
00896         <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Diff2);
00897       }      
00898       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a> (Diff1);
00899       <font class="keywordflow">if</font> (flag == True) {
00900         LatticeUnion *temp;     
00901         
00902         temp = (LatticeUnion *)malloc(<font class="keyword">sizeof</font>(LatticeUnion));
00903         temp-&gt;M = (Lattice *)<a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>((Matrix *)Ztmp-&gt;Lat); 
00904         temp-&gt;next = Curr-&gt;<a class="code" href="structforsimplify.html#m1">LatUni</a>;
00905         Curr-&gt;<a class="code" href="structforsimplify.html#m1">LatUni</a> = temp;
00906         <font class="keywordflow">break</font>;
00907       }
00908     }
00909     <font class="keywordflow">if</font>(Curr == NULL) {
00910       Curr = (<a class="code" href="structforsimplify.html">ForSimplify</a> *)malloc(<font class="keyword">sizeof</font>(<a class="code" href="structforsimplify.html">ForSimplify</a>));      
00911       Curr-&gt;<a class="code" href="structforsimplify.html#m0">Pol</a> = <a class="code" href="polyhedron_8c.html#a37">Domain_Copy</a>(Img);
00912       Curr-&gt;<a class="code" href="structforsimplify.html#m1">LatUni</a> = (LatticeUnion *)malloc(<font class="keyword">sizeof</font>(LatticeUnion));
00913       Curr-&gt;<a class="code" href="structforsimplify.html#m1">LatUni</a>-&gt;M = (Lattice *)<a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>((Matrix *)Ztmp-&gt;Lat); 
00914       Curr-&gt;<a class="code" href="structforsimplify.html#m1">LatUni</a>-&gt;next = NULL;
00915       Curr-&gt;<a class="code" href="structforsimplify.html#m2">next</a> = Head;
00916       Head = Curr;
00917     }   
00918     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a> (Img);
00919     Ztmp = Ztmp-&gt;next;
00920   } <font class="keywordflow">while</font>(Ztmp != NULL);
00921   
00922   <font class="keywordflow">for</font> (Curr = Head; Curr != NULL; Curr = Curr-&gt;<a class="code" href="structforsimplify.html#m2">next</a>)
00923     Curr-&gt;<a class="code" href="structforsimplify.html#m1">LatUni</a> = <a class="code" href="Lattice_8c.html#a36">LatticeSimplify</a>(Curr-&gt;<a class="code" href="structforsimplify.html#m1">LatUni</a>);  
00924   Result = NULL;
00925   <font class="keywordflow">for</font>(Curr = Head; Curr != NULL; Curr = Curr-&gt;<a class="code" href="structforsimplify.html#m2">next</a>) {
00926     LatticeUnion *L;    
00927     <font class="keywordflow">for</font>(L = Curr-&gt;<a class="code" href="structforsimplify.html#m1">LatUni</a>; L != NULL; L = L-&gt;next) {
00928       Polyhedron *Preim;
00929       ZPolyhedron *Zpol;
00930       
00931       Preim = <a class="code" href="polyhedron_8c.html#a51">DomainPreimage</a>(Curr-&gt;<a class="code" href="structforsimplify.html#m0">Pol</a>,L-&gt;M,MAXNOOFRAYS);
00932       Zpol = <a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(L-&gt;M, Preim);
00933       Zpol-&gt;next = Result;
00934       Result = Zpol;
00935       <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Preim);
00936     }
00937   }  
00938   Curr = Head;
00939   <font class="keywordflow">while</font> (Curr != NULL) {
00940     Prev = Curr;
00941     Curr = Curr-&gt;<a class="code" href="structforsimplify.html#m2">next</a>;     
00942     <a class="code" href="Lattice_8c.html#a2">LatticeUnion_Free</a>(Prev-&gt;<a class="code" href="structforsimplify.html#m1">LatUni</a>);
00943     <a class="code" href="polyhedron_8c.html#a19">Domain_Free</a>(Prev-&gt;<a class="code" href="structforsimplify.html#m0">Pol</a>);
00944     free(Prev);
00945   }
00946   <font class="keywordflow">return</font> Result;
00947 } <font class="comment">/* ZDomainSimplify */</font> 
00948 
<a name="l00949"></a><a class="code" href="Zpolyhedron_8c.html#a26">00949</a> ZPolyhedron *<a class="code" href="Zpolyhedron_8c.html#a26">SplitZpolyhedron</a>(ZPolyhedron *ZPol,Lattice *B) {
00950  
00951   Lattice *Intersection = NULL;
00952   Lattice *B1 = NULL, *B2 = NULL, *newB1 = NULL, *newB2 = NULL;
00953   Matrix *U = NULL,*M1 = NULL, *M2 = NULL, *M1Inverse = NULL,*MtProduct = NULL;
00954   Matrix *Vinv, *V , *temp, *DiagMatrix ;
00955   Matrix *H , *U1 , *X, *Y ;
00956   ZPolyhedron *zpnew, *Result;
00957   LatticeUnion *Head = NULL, *tempHead = NULL;
00958   <font class="keywordtype">int</font> i;
00959   <a class="code" href="arithmetique_8h.html#a93">Value</a> k;
00960   
00961 <font class="preprocessor">#ifdef DOMDEBUG</font>
00962 <font class="preprocessor"></font>  FILE *fp;
00963   fp = fopen(<font class="stringliteral">"_debug"</font>, <font class="stringliteral">"a"</font>);
00964   fprintf(fp,<font class="stringliteral">"\nEntered SplitZpolyhedron \n"</font>); 
00965   fclose(fp);
00966 <font class="preprocessor">#endif</font>
00967 <font class="preprocessor"></font>
00968   
00969   <font class="keywordflow">if</font> (B-&gt;NbRows != B-&gt;NbColumns) { 
00970     fprintf(stderr,<font class="stringliteral">"\n SplitZpolyhedron : The Input Matrix B is not a proper Lattice \n"</font>);
00971     <font class="keywordflow">return</font> NULL;
00972   }
00973   
00974   <font class="keywordflow">if</font> (ZPol-&gt;Lat-&gt;NbRows != B-&gt;NbRows) {
00975     fprintf(stderr,<font class="stringliteral">"\nSplitZpolyhedron : The Lattice in Zpolyhedron and B have "</font>);
00976     fprintf(stderr,<font class="stringliteral">"incompatible dimensions \n"</font>);
00977     <font class="keywordflow">return</font> NULL;
00978   }
00979   
00980   <font class="keywordflow">if</font> (<a class="code" href="Matop_8c.html#a7">isinHnf</a> (ZPol-&gt;Lat) != True) {
00981     <a class="code" href="Lattice_8c.html#a8">AffineHermite</a>(ZPol-&gt;Lat,&amp;H,&amp;U1);
00982     X = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(H);    
00983     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(U1);
00984     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(H);
00985   }
00986   <font class="keywordflow">else</font>
00987     X = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(ZPol-&gt;Lat);
00988   
00989   <font class="keywordflow">if</font> (<a class="code" href="Matop_8c.html#a7">isinHnf</a>(B) != True) {
00990     <a class="code" href="Lattice_8c.html#a8">AffineHermite</a>(B,&amp;H,&amp;U1);
00991     Y = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(H);   
00992     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(H);
00993     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(U1);
00994   }
00995   <font class="keywordflow">else</font>
00996     Y = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(B);  
00997   <font class="keywordflow">if</font> (<a class="code" href="Lattice_8c.html#a6">isEmptyLattice</a>(X)) {
00998     <font class="keywordflow">return</font> NULL;  
00999   }
01000 
01001   Head=<a class="code" href="Lattice_8c.html#a20">Lattice2LatticeUnion</a>(X,Y);
01002 
01003 <font class="comment">/* If the spliting operation can't be done the result is the original Zplyhedron. */</font>
01004 
01005   <font class="keywordflow">if</font> (Head == NULL) {
01006     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(X);
01007     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(Y);
01008     <font class="keywordflow">return</font> ZPol;
01009   }  
01010 
01011 
01012   Result=NULL;
01013 
01014   <font class="keywordflow">if</font> (Head)
01015    <font class="keywordflow">while</font>(Head)
01016     {
01017       tempHead = Head;
01018       Head = Head-&gt;next;  
01019       zpnew=<a class="code" href="Zpolyhedron_8c.html#a10">ZPolyhedron_Alloc</a>(tempHead-&gt;M,ZPol-&gt;P);
01020       Result=<a class="code" href="Zpolyhedron_8c.html#a13">AddZPoly2ZDomain</a>(zpnew,Result);
01021       <a class="code" href="Zpolyhedron_8c.html#a3">ZPolyhedron_Free</a>(zpnew);
01022       tempHead-&gt;next = NULL; 
01023       free(tempHead);  
01024     }
01025 
01026   <font class="keywordflow">return</font> Result;
01027 }
01028 
01029 
01030 
</pre></div><hr><address align="right"><small>Generated on Fri Nov 8 12:10:07 2002 for Polylib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
