<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Matop.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11.1 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Matop.c</h1><a href="Matop_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00002 <font class="preprocessor">#include &lt;polylib/polylib.h&gt;</font>
00003 
00004 <font class="comment">/*</font>
00005 <font class="comment"> * Return the lcm of 'i' and 'j' </font>
00006 <font class="comment"> */</font> 
<a name="l00007"></a><a class="code" href="Matop_8c.html#a0">00007</a> Value *<a class="code" href="Matop_8c.html#a0">Lcm</a> (Value i, Value j)<font class="keyword"> </font>{
00008   
00009   Value *tmp;
00010   Value aux;
00011   
00012   tmp = (Value *) malloc (<font class="keyword">sizeof</font>(Value));
00013   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(aux); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(*tmp);
00014   <a class="code" href="vector_8c.html#a3">Gcd</a>(i,j,tmp);
00015   <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(aux,i,j);
00016   <a class="code" href="arithmetique_8h.html#a51">value_division</a>(*tmp,aux,*tmp);
00017   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(aux);
00018   <font class="keywordflow">return</font> tmp;
00019 } <font class="comment">/* Lcm */</font>
00020 
00021 <font class="comment">/* </font>
00022 <font class="comment"> * Return an identity matrix of size 'size'. </font>
00023 <font class="comment"> */</font>
<a name="l00024"></a><a class="code" href="Matop_8c.html#a1">00024</a> Matrix *<a class="code" href="Matop_8c.html#a1">Identity</a> (<font class="keywordtype">unsigned</font> size)<font class="keyword"> </font>{
00025   
00026   <font class="keywordtype">unsigned</font> i, j;
00027   Matrix *A;
00028   
00029   A = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(size, size);
00030   <font class="keywordflow">for</font> (i = 0;i &lt; size; i ++)
00031     <font class="keywordflow">for</font> (j = 0; j &lt; size; j ++)
00032       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(A-&gt;p[i][j],0);
00033   <font class="keywordflow">for</font> (i =0; i &lt; size; i ++)  
00034     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(A-&gt;p[i][i],1);
00035   <font class="keywordflow">return</font> A;
00036 } <font class="comment">/* Identity */</font>
00037 
00038 <font class="comment">/*</font>
00039 <font class="comment"> * Exchange the rows 'Row1' and 'Row2' of the matrix 'M'</font>
00040 <font class="comment"> */</font>
<a name="l00041"></a><a class="code" href="Matop_8c.html#a2">00041</a> <font class="keywordtype">void</font> <a class="code" href="Matop_8c.html#a2">ExchangeRows</a>(Matrix *M, <font class="keywordtype">int</font> Row1, <font class="keywordtype">int</font> Row2)<font class="keyword"> </font>{
00042   
00043   <font class="keywordtype">int</font> i;
00044   Value *temp;
00045   
00046   temp = (Value *) malloc (<font class="keyword">sizeof</font>(Value) * M-&gt;NbColumns);
00047   
00048   <font class="keywordflow">for</font> (i = 0 ;i &lt; (int)M-&gt;NbColumns; i++) {
00049     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(temp[i]);
00050     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(temp[i],M-&gt;p[Row1][i]);
00051   }
00052   <font class="keywordflow">for</font> (i = 0; i &lt; (int)M-&gt;NbColumns;  i++) {
00053     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(M-&gt;p[Row1][i],M-&gt;p[Row2][i]);
00054     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(M-&gt;p[Row2][i],temp[i]);
00055     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(temp[i]);
00056   }  
00057   free (temp);
00058   <font class="keywordflow">return</font> ;
00059 } <font class="comment">/* ExchangeRows */</font>
00060 
00061 <font class="comment">/*</font>
00062 <font class="comment"> * Exchange the columns 'Column1' and 'Column2' of the matrix 'M'</font>
00063 <font class="comment"> */</font>
<a name="l00064"></a><a class="code" href="Matop_8c.html#a3">00064</a> <font class="keywordtype">void</font> <a class="code" href="Matop_8c.html#a3">ExchangeColumns</a>(Matrix *M, <font class="keywordtype">int</font> Column1, <font class="keywordtype">int</font> Column2)<font class="keyword"> </font>{
00065   
00066   <font class="keywordtype">int</font> i;
00067   Value *temp;
00068   
00069   temp = (Value *) malloc(<font class="keyword">sizeof</font>(Value) * M-&gt;NbRows);
00070   <font class="keywordflow">for</font> (i = 0 ;i &lt; (int) M-&gt;NbRows; i++) {
00071     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(temp[i]);
00072     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(temp[i],M-&gt;p[i][Column1]);
00073   } 
00074   <font class="keywordflow">for</font> (i = 0; i &lt; (int)M-&gt;NbRows; i++) {
00075       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(M-&gt;p[i][Column1],M-&gt;p[i][Column2]);
00076       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(M-&gt;p[i][Column2],temp[i]);
00077       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(temp[i]);
00078     }
00079   free (temp);
00080   <font class="keywordflow">return</font> ;
00081 } <font class="comment">/* ExchangeColumns */</font>
00082 
00083 <font class="comment">/* </font>
00084 <font class="comment"> * Return the Transpose of a matrix 'A' </font>
00085 <font class="comment"> */</font>
<a name="l00086"></a><a class="code" href="Matop_8c.html#a4">00086</a> Matrix *<a class="code" href="Matop_8c.html#a4">Transpose</a> (Matrix *A)<font class="keyword"> </font>{
00087   
00088   <font class="keywordtype">int</font> i,j;
00089   Matrix *<a class="code" href="NormalForms_8c.html#a9">transpose</a>;
00090   
00091   <a class="code" href="NormalForms_8c.html#a9">transpose</a> = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a> (A-&gt;NbColumns, A-&gt;NbRows);
00092   <font class="keywordflow">for</font> (i = 0; i &lt; (int)A-&gt;NbRows; i++)
00093     <font class="keywordflow">for</font> (j = 0; j &lt; (int)A-&gt;NbColumns; j++)
00094       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(transpose-&gt;p[j][i],A-&gt;p[i][j]);
00095   <font class="keywordflow">return</font> <a class="code" href="NormalForms_8c.html#a9">transpose</a>;
00096 } <font class="comment">/* Transpose */</font>
00097 
00098 <font class="comment">/*</font>
00099 <font class="comment"> * Return a copy of the contents of a matrix 'Src'.</font>
00100 <font class="comment"> */</font>
<a name="l00101"></a><a class="code" href="Matop_8c.html#a5">00101</a> Matrix *<a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(Matrix *Src )<font class="keyword"> </font>{
00102   
00103   Matrix *Dst;
00104   <font class="keywordtype">unsigned</font> i, j;
00105   
00106   Dst = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(Src-&gt;NbRows, Src-&gt;NbColumns);
00107   
00108   <font class="keywordflow">for</font> (i = 0; i &lt; Src-&gt;NbRows; i++)
00109     <font class="keywordflow">for</font> (j = 0; j &lt; Src-&gt;NbColumns; j++)
00110       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(Dst-&gt;p[i][j],Src-&gt;p[i][j]);
00111   <font class="keywordflow">return</font> Dst;
00112 } <font class="comment">/* Matrix_copy */</font>
00113 
00114 <font class="comment">/* </font>
00115 <font class="comment"> * Test if the input matrix is integral or not. </font>
00116 <font class="comment"> */</font>
<a name="l00117"></a><a class="code" href="Matop_8c.html#a6">00117</a> Bool <a class="code" href="Matop_8c.html#a6">isIntegral</a> (Matrix *A)<font class="keyword"> </font>{
00118   
00119   <font class="keywordtype">unsigned</font> i, j;
00120   Value divisor, tmp;
00121   
00122   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(divisor); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
00123   <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(divisor,A-&gt;p[A-&gt;NbRows-1][A-&gt;NbColumns-1]);
00124 
00125   <font class="keywordflow">for</font> (i = 0; i &lt; A-&gt;NbRows ; i++)
00126     <font class="keywordflow">for</font> (j = 0; j &lt; A-&gt;NbColumns ; j++) {
00127       <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(tmp,A-&gt;p[i][j],divisor);
00128       <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(tmp))<font class="keyword"> </font>{
00129         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(divisor); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00130           <font class="keywordflow">return</font> False;  
00131       }   
00132     }
00133   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(divisor); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00134   <font class="keywordflow">return</font> True ;
00135 } <font class="comment">/* isIntegral */</font>
00136 
00137 <font class="comment">/*</font>
00138 <font class="comment"> * Check if the matrix 'A' is in Hermite normal form or not. </font>
00139 <font class="comment"> */</font>
<a name="l00140"></a><a class="code" href="Matop_8c.html#a7">00140</a> Bool <a class="code" href="Matop_8c.html#a7">isinHnf</a>(Matrix *A)<font class="keyword"> </font>{
00141  
00142   Matrix *temp ;
00143   <font class="keywordtype">unsigned</font> i, j ;
00144   Value rem;
00145   
00146   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(rem); 
00147   temp = <a class="code" href="Lattice_8c.html#a10">Homogenise</a>(A,True) ;
00148   <font class="keywordflow">for</font> (i = 0; i &lt; temp-&gt;NbRows; i++) {
00149     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(rem,temp-&gt;p[i][i]);
00150     <font class="keywordflow">for</font> (j = 0; j &lt; i ; j++)
00151       <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a25">value_ge</a>(temp-&gt;p[i][j],rem))<font class="keyword"> </font>{
00152         <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(temp);
00153         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(rem);
00154         <font class="keywordflow">return</font> False ;
00155       }
00156     <font class="keywordflow">for</font> (j = i+1; j &lt; temp-&gt;NbColumns ; j++)
00157       <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(temp-&gt;p[i][j]))<font class="keyword"> </font>{
00158         <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(temp);
00159         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(rem);
00160         <font class="keywordflow">return</font> False ;
00161       }
00162   }
00163   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(rem);
00164   <font class="keywordflow">return</font> True ;
00165 } <font class="comment">/* isinHnf */</font>
00166 
00167 <font class="comment">/*</font>
00168 <font class="comment"> * Remove the row 'Rownumber' and place it at the end of the matrix 'X'  </font>
00169 <font class="comment"> */</font> 
<a name="l00170"></a><a class="code" href="Matop_8c.html#a8">00170</a> <font class="keywordtype">void</font> <a class="code" href="Matop_8c.html#a8">PutRowLast</a> (Matrix *X, <font class="keywordtype">int</font> Rownumber)<font class="keyword"> </font>{
00171   
00172   <font class="keywordtype">int</font> i, j ;
00173   Value *vector;
00174  
00175   <font class="keywordflow">if</font> (Rownumber == X-&gt;NbRows-1)
00176     <font class="keywordflow">return</font>;
00177   vector = (Value *) malloc (<font class="keyword">sizeof</font>(Value) * X-&gt;NbColumns); 
00178   
00179   <font class="keywordflow">for</font> (i = 0; i &lt; X-&gt;NbColumns; i++) {
00180     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(vector[i]);
00181     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(vector[i],X-&gt;p[Rownumber][i]);
00182   }    
00183   <font class="keywordflow">for</font> (i = Rownumber; i &lt; X-&gt;NbRows-1; i++)
00184     <font class="keywordflow">for</font> (j = 0; j &lt; X-&gt;NbColumns; j++)
00185       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(X-&gt;p[i][j],X-&gt;p[i+1][j]);
00186   
00187   <font class="keywordflow">for</font> (j = 0; j &lt; X-&gt;NbColumns ; j++) {
00188     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(X-&gt;p[i][j],vector[j]);
00189     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(vector[j]);
00190   }    
00191   free (vector);
00192   <font class="keywordflow">return</font>;
00193 } <font class="comment">/* PutRowLast */</font>
00194 
00195 <font class="comment">/* </font>
00196 <font class="comment"> * Remove the row 'Rownumber' and place it at the begining of the matrix 'X' </font>
00197 <font class="comment"> */</font> 
<a name="l00198"></a><a class="code" href="Matop_8c.html#a9">00198</a> <font class="keywordtype">void</font> <a class="code" href="Matop_8c.html#a9">PutRowFirst</a>(Matrix *X, <font class="keywordtype">int</font> Rownumber)<font class="keyword"> </font>{
00199   
00200   <font class="keywordtype">int</font> i, j ;
00201   Value *vector;
00202 
00203   vector = (Value *) malloc (<font class="keyword">sizeof</font>(Value) * X-&gt;NbColumns); 
00204   
00205   <font class="keywordflow">for</font> (i = 0; i &lt; X-&gt;NbColumns; i++) {
00206     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(vector[i]);
00207     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(vector[i],X-&gt;p[Rownumber][i]);
00208   }  
00209   <font class="keywordflow">for</font> (i = Rownumber; i &gt; 0; i--)
00210     <font class="keywordflow">for</font> (j = 0; j &lt; X-&gt;NbColumns; j++)
00211       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(X-&gt;p[i][j],X-&gt;p[i-1][j]);
00212   
00213   <font class="keywordflow">for</font> (j = 0; j &lt; X-&gt;NbColumns ; j++) {
00214     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(X-&gt;p[i][j],vector[j]);
00215     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(vector[j]);
00216   } 
00217   free(vector);
00218   <font class="keywordflow">return</font>;
00219 } <font class="comment">/* PutRowFirst */</font>
00220 
00221 <font class="comment">/*</font>
00222 <font class="comment"> * Remove the column 'Columnnumber' and place it at the begining of the matrix</font>
00223 <font class="comment"> * 'X'</font>
00224 <font class="comment"> */</font>
<a name="l00225"></a><a class="code" href="Matop_8c.html#a10">00225</a> <font class="keywordtype">void</font> <a class="code" href="Matop_8c.html#a10">PutColumnFirst</a> (Matrix *X, <font class="keywordtype">int</font> Columnnumber)<font class="keyword"> </font>{
00226   
00227   <font class="keywordtype">int</font> i, j ;
00228   Value *vector;
00229 
00230   vector = (Value *)malloc(<font class="keyword">sizeof</font> (Value) * X-&gt;NbRows); 
00231   
00232   <font class="keywordflow">for</font> (i = 0; i &lt; X-&gt;NbRows; i++) {
00233     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(vector[i]);
00234     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(vector[i],X-&gt;p[i][Columnnumber]);
00235   }
00236   
00237   <font class="keywordflow">for</font> (i = 0; i &lt; X-&gt;NbRows; i ++)
00238     <font class="keywordflow">for</font> (j = Columnnumber; j &gt; 0; j --)
00239       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(X-&gt;p[i][j],X-&gt;p[i][j-1]);
00240   
00241   <font class="keywordflow">for</font> (i = 0; i &lt; X-&gt;NbRows ; i ++) {
00242     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(X-&gt;p[i][0],vector[i]);
00243     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(vector[i]);
00244   }    
00245   free (vector);
00246   <font class="keywordflow">return</font> ;
00247 } <font class="comment">/* PutColumnFirst */</font>
00248 
00249 <font class="comment">/*</font>
00250 <font class="comment"> * Remove the column 'Columnnumber' and place it at the end of the matrix 'X'</font>
00251 <font class="comment"> */</font>
<a name="l00252"></a><a class="code" href="Matop_8c.html#a11">00252</a> <font class="keywordtype">void</font> <a class="code" href="Matop_8c.html#a11">PutColumnLast</a> (Matrix *X, <font class="keywordtype">int</font> Columnnumber)<font class="keyword"> </font>{
00253   
00254   <font class="keywordtype">int</font> i, j ;
00255   Value *vector;
00256 
00257   vector = (Value *) malloc (<font class="keyword">sizeof</font> (Value) * X-&gt;NbRows); 
00258   
00259   <font class="keywordflow">for</font> (i = 0; i &lt; X-&gt;NbRows; i++) {
00260     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(vector[i]);
00261     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(vector[i],X-&gt;p[i][Columnnumber]);
00262   }    
00263   
00264   <font class="keywordflow">for</font> (i = 0; i &lt; X-&gt;NbRows; i++)
00265     <font class="keywordflow">for</font> (j = Columnnumber; j &lt; X-&gt;NbColumns-1; j++)
00266       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(X-&gt;p[i][j],X-&gt;p[i][j+1]);
00267   
00268   <font class="keywordflow">for</font> (i = 0; i &lt; X-&gt;NbRows ; i++) {
00269     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(X-&gt;p[i][X-&gt;NbColumns-1],vector[i]);
00270     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(vector[i]);
00271   }  
00272   free (vector);
00273   <font class="keywordflow">return</font> ;
00274 } <font class="comment">/* PutColumnLast */</font>
00275 
00276 <font class="comment">/*</font>
00277 <font class="comment"> * Add a row of zeros at the end of the matrix 'M' and return the new matrix </font>
00278 <font class="comment"> */</font>
<a name="l00279"></a><a class="code" href="Matop_8c.html#a12">00279</a> Matrix *<a class="code" href="Matop_8c.html#a12">AddANullRow</a> (Matrix *M)<font class="keyword"> </font>{
00280   
00281   <font class="keywordtype">int</font> i,j;
00282   Matrix *Result;
00283   
00284   Result = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(M-&gt;NbRows+1,M-&gt;NbColumns);
00285   <font class="keywordflow">for</font> (i = 0;i &lt; M-&gt;NbRows; i++)
00286     <font class="keywordflow">for</font> (j = 0; j &lt; M-&gt;NbColumns ; j++)
00287       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(Result-&gt;p[i][j],M-&gt;p[i][j]);
00288   <font class="keywordflow">for</font> (j = 0; j &lt; M-&gt;NbColumns; j++)
00289     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(Result-&gt;p[i][j],0);  
00290   <font class="keywordflow">return</font> Result;
00291 } <font class="comment">/* AddANullRow */</font>
00292 
00293 <font class="comment">/* </font>
00294 <font class="comment"> * Add a column of zeros at the end of the matrix 'M' and return the new </font>
00295 <font class="comment"> * matrix</font>
00296 <font class="comment"> */</font>   
<a name="l00297"></a><a class="code" href="Matop_8c.html#a13">00297</a> Matrix *<a class="code" href="Matop_8c.html#a13">AddANullColumn</a>(Matrix *M)<font class="keyword"> </font>{
00298   
00299   <font class="keywordtype">int</font> i,j;
00300   Matrix *Result;
00301   
00302   Result = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(M-&gt;NbRows, M-&gt;NbColumns+1);
00303   <font class="keywordflow">for</font> (i = 0;i &lt; M-&gt;NbRows; i++)
00304     <font class="keywordflow">for</font> (j = 0; j &lt; M-&gt;NbColumns ; j++)
00305       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(Result-&gt;p[i][j],M-&gt;p[i][j]);
00306   <font class="keywordflow">for</font> (i = 0; i &lt; M-&gt;NbRows; i++)
00307     <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(Result-&gt;p[i][M-&gt;NbColumns],0);
00308   <font class="keywordflow">return</font> Result;
00309 } <font class="comment">/* AddANullColumn */</font>
00310 
00311 <font class="comment">/*</font>
00312 <font class="comment"> * Remove a row 'Rownumber' from matrix 'M' and return the new matrix.</font>
00313 <font class="comment"> */</font>
<a name="l00314"></a><a class="code" href="Matop_8c.html#a14">00314</a> Matrix *<a class="code" href="Matop_8c.html#a14">RemoveRow</a>(Matrix *M, <font class="keywordtype">int</font> Rownumber)<font class="keyword"> </font>{
00315   
00316   Matrix *temp, *Result;
00317   <font class="keywordtype">int</font> i,j;
00318   
00319   temp = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a> (M);
00320   <a class="code" href="Matop_8c.html#a8">PutRowLast</a>(temp, Rownumber); 
00321   Result = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(temp-&gt;NbRows-1, temp-&gt;NbColumns);
00322   
00323   <font class="keywordflow">for</font> (i = 0; i &lt; Result-&gt;NbRows; i ++)
00324     <font class="keywordflow">for</font> (j = 0; j &lt; Result-&gt;NbColumns; j ++)
00325       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(Result-&gt;p[i][j],temp-&gt;p[i][j]);   
00326   <font class="keywordflow">return</font> Result;
00327 } <font class="comment">/* RemoveRow */</font>
00328 
00329 <font class="comment">/*</font>
00330 <font class="comment"> * Remove a column 'Columnnumber' from matrix 'M' and return the new matrix.</font>
00331 <font class="comment"> */</font>
<a name="l00332"></a><a class="code" href="Matop_8c.html#a15">00332</a> Matrix *<a class="code" href="Matop_8c.html#a15">RemoveColumn</a> (Matrix *M, <font class="keywordtype">int</font> Columnnumber)<font class="keyword"> </font>{
00333   
00334   Matrix *temp, *Result;
00335   <font class="keywordtype">int</font> i,j;
00336   
00337   temp = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(M);
00338   <a class="code" href="Matop_8c.html#a11">PutColumnLast</a>(temp,Columnnumber); 
00339   Result = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a> (temp-&gt;NbRows, temp-&gt;NbColumns-1);
00340   
00341   <font class="keywordflow">for</font> (i = 0; i &lt; Result-&gt;NbRows; i ++)
00342     <font class="keywordflow">for</font> (j = 0; j &lt; Result-&gt;NbColumns; j ++)
00343       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(Result-&gt;p[i][j],temp-&gt;p[i][j]);   
00344   <font class="keywordflow">return</font> Result;
00345 } <font class="comment">/* RemoveColumn */</font>
00346 
00347 <font class="comment">/* </font>
00348 <font class="comment"> * Given a Matrix M of dimesnion n * l and rank l1, find a unimodular matrix</font>
00349 <font class="comment"> * 'Result' such that the Vector Space spanned by M is the subset of the vector</font>
00350 <font class="comment"> * Space spanned by the first l1 Rows of Result. The function returns the rank</font>
00351 <font class="comment"> * l1 and the Matrix Result.  </font>
00352 <font class="comment"> */</font>
<a name="l00353"></a><a class="code" href="Matop_8c.html#a16">00353</a> <font class="keywordtype">int</font> <a class="code" href="Matop_8c.html#a16">findHermiteBasis</a>(Matrix *M, Matrix **Result)<font class="keyword"> </font>{
00354   
00355   <font class="keywordtype">int</font> i, j;
00356   Matrix *C, *curMat, *temp1, *temp2;
00357   Matrix *H, *U;
00358   Vector *V;
00359   <font class="keywordtype">int</font> dim, curDim, curVect,rank;
00360   
00361   <font class="keywordflow">if</font> (M-&gt;NbRows == 0) {
00362     Result[0] = <a class="code" href="Matop_8c.html#a1">Identity</a> (M-&gt;NbColumns);
00363     <font class="keywordflow">return</font> 0;
00364   }
00365   
00366   <font class="keywordflow">if</font> (M-&gt;NbRows &lt;= M-&gt;NbColumns) {
00367     <a class="code" href="NormalForms_8c.html#a16">Hermite</a>(M, &amp;H, &amp;U);
00368     
00369     <font class="keywordflow">for</font> (i = 0; i &lt; H-&gt;NbRows; i++)
00370       <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(H-&gt;p[i][i]))
00371         <font class="keywordflow">break</font>;
00372     
00373     <font class="keywordflow">if</font> (i == H-&gt;NbRows) {
00374       Result[0] = <a class="code" href="Matop_8c.html#a4">Transpose</a>(U);
00375       <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(H);
00376       <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(U);
00377       <font class="keywordflow">return</font>(i);
00378     }
00379     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (H);
00380     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (U);
00381   } 
00382   
00383   <font class="comment">/* Eliminating the Zero Rows  */</font>
00384   
00385   C = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a> (M);
00386   <font class="keywordflow">for</font> (i = 0; i &lt; C-&gt;NbRows; i++) {
00387     <font class="keywordflow">for</font> (j = 0; j &lt; C-&gt;NbColumns; j++)
00388       <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(C-&gt;p[i][j]))
00389         <font class="keywordflow">break</font>;
00390     <font class="keywordflow">if</font> (j == C-&gt;NbColumns) {
00391       Matrix *temp;
00392       temp = <a class="code" href="Matop_8c.html#a14">RemoveRow</a>(C, i); 
00393       <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(C);
00394       C = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(temp);
00395       <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(temp);
00396       i --;
00397     }
00398   }
00399   
00400   <font class="comment">/* Eliminating the Redundant Rows */</font>
00401   
00402   curDim = 1;
00403   curVect = 1;
00404   dim = C-&gt;NbColumns;
00405   
00406   curMat = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(1,C-&gt;NbColumns);
00407   <font class="keywordflow">for</font> (i = 0; i &lt; C-&gt;NbColumns; i ++)
00408     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(curMat-&gt;p[0][i],C-&gt;p[0][i]); 
00409   
00410   <font class="keywordflow">while</font>((curVect &lt; C-&gt;NbRows) &amp;&amp; (curDim &lt; dim)) {
00411     Matrix *temp;
00412     temp = <a class="code" href="Matop_8c.html#a12">AddANullRow</a>(curMat);
00413     <font class="keywordflow">for</font> (i = 0; i &lt; C-&gt;NbColumns; i++)
00414       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(temp-&gt;p[temp-&gt;NbRows-1][i],C-&gt;p[curVect][i]);
00415     
00416     temp1 = <a class="code" href="Matop_8c.html#a12">AddANullRow</a>(temp);
00417     temp2 = <a class="code" href="Matop_8c.html#a13">AddANullColumn</a>(temp1);
00418     rank = <a class="code" href="SolveDio_8c.html#a1">SolveDiophantine</a>(temp2, &amp;U, &amp;V);
00419     <font class="keywordflow">if</font> (rank == temp-&gt;NbRows) {
00420       <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(curMat);
00421       curMat = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(temp);
00422       curDim ++;
00423     }    
00424     curVect ++;    
00425     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (U);
00426     <a class="code" href="vector_8c.html#a6">Vector_Free</a> (V);
00427     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (temp1);
00428     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (temp);
00429     <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (temp2);
00430   }
00431   
00432   <a class="code" href="NormalForms_8c.html#a16">Hermite</a>(curMat, &amp;H, &amp;U);
00433   rank = curMat-&gt;NbRows;
00434   
00435   Result[0] = <a class="code" href="Matop_8c.html#a4">Transpose</a> (U);
00436   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (H);
00437   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (U);
00438   <font class="keywordflow">return</font> (rank);
00439 } <font class="comment">/* findHermiteBasis */</font>
00440 
00441 
00442 
00443 
</pre></div><hr><address><small>Generated on Fri Oct 4 16:14:26 2002 for Polylib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.11.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
