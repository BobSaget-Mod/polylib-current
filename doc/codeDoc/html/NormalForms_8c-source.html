<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>NormalForms.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11.1 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>NormalForms.c</h1><a href="NormalForms_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00002 <font class="preprocessor">#include &lt;polylib/polylib.h&gt;</font>
00003 
00004 <font class="comment">/* nota bene: on stocke les matrices par lignes */</font>
00005 <font class="comment">/* nota bene: matrices are stored in row major order */</font>
00006 
00007 <font class="comment">/*------------------------------------------------------------------------</font>
00008 <font class="comment">        change les signes de la ligne i de la matrice A</font>
00009 <font class="comment">        change the sign of row i of matrix A</font>
00010 <font class="comment">------------------------------------------------------------------------*/</font>
00011 
<a name="l00012"></a><a class="code" href="NormalForms_8c.html#a0">00012</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a0">moins_l</a>(Value *a,<font class="keywordtype">int</font> i,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p)<font class="keyword"> </font>{
00013   
00014   <font class="keywordtype">int</font> k;
00015   Value *c;
00016   
00017   c=a+(i-1)*p;
00018   
00019   <font class="keywordflow">for</font>(k=1; k&lt;=p; k++) {
00020     <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(*c,*c);
00021     c++;
00022   }
00023   <font class="keywordflow">return</font>;
00024 } <font class="comment">/* moins_l */</font>
00025 
00026 <font class="comment">/*------------------------------------------------------------------------</font>
00027 <font class="comment">        change les signes de la colonne i de la matrice A</font>
00028 <font class="comment">        change the sign of column i of matrix A</font>
00029 <font class="comment">------------------------------------------------------------------------*/</font>
00030 
<a name="l00031"></a><a class="code" href="NormalForms_8c.html#a1">00031</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a1">moins_c</a>(Value *a,<font class="keywordtype">int</font> i,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p)<font class="keyword"> </font>{
00032   
00033   <font class="keywordtype">int</font> k;
00034   Value *c;
00035   
00036   c=a+(i-1);
00037   
00038   <font class="keywordflow">for</font>(k=1;k&lt;=<a class="code" href="polyparam_8c.html#a2">n</a>;k++) {
00039     <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(*c,*c);
00040     c=c+p;
00041   }
00042   <font class="keywordflow">return</font>;
00043 } <font class="comment">/* moins_c */</font>
00044 
00045 <font class="comment">/*------------------------------------------------------------------------</font>
00046 <font class="comment">        echange les lignes i et j de la matrice A</font>
00047 <font class="comment">        exchange row i and j of matrix A</font>
00048 <font class="comment">------------------------------------------------------------------------*/</font>
00049 
<a name="l00050"></a><a class="code" href="NormalForms_8c.html#a2">00050</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a2">echange_l</a>(Value *a,<font class="keywordtype">int</font> i,<font class="keywordtype">int</font> j,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p)<font class="keyword"> </font>{       
00051   
00052   <font class="keywordtype">int</font> k;
00053   Value s;
00054   Value *c1,*c2;
00055   
00056   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(s);
00057   c1=a+(i-1)*p;
00058   c2=a+(j-1)*p;
00059   
00060   <font class="keywordflow">for</font>(k=1;k&lt;=p;k++) {
00061     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(s,*c1);
00062     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*c1,*c2);
00063     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*c2,s);
00064     c1++;
00065     c2++;
00066   }
00067   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(s);
00068   <font class="keywordflow">return</font>;
00069 } <font class="comment">/* echange_l */</font> 
00070 
00071 <font class="comment">/*------------------------------------------------------------------------</font>
00072 <font class="comment">        echange les colonnes i et j de la matrice A</font>
00073 <font class="comment">        exchange columns i and j of matrix A</font>
00074 <font class="comment">------------------------------------------------------------------------*/</font>
00075 
<a name="l00076"></a><a class="code" href="NormalForms_8c.html#a3">00076</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a3">echange_c</a>(Value *a,<font class="keywordtype">int</font> i,<font class="keywordtype">int</font> j,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p)<font class="keyword"> </font>{       
00077   
00078   <font class="keywordtype">int</font> k;
00079   Value s;
00080   Value *c1,*c2;
00081 
00082   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(s);
00083   c1=a+(i-1);
00084   c2=a+(j-1);
00085   
00086   <font class="keywordflow">for</font>(k=1;k&lt;=<a class="code" href="polyparam_8c.html#a2">n</a>;k++) {   
00087     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(s,*c1);
00088     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*c1,*c2);
00089     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*c2,s);
00090     c1=c1+p;
00091     c2=c2+p;
00092   }
00093   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(s);
00094   <font class="keywordflow">return</font>;
00095 } <font class="comment">/* echange_c */</font>
00096 
00097 <font class="comment">/*------------------------------------------------------------------------</font>
00098 <font class="comment">        A est une matrice de taille n*p</font>
00099 <font class="comment">        on ajoute a la ligne i, x fois la ligne j</font>
00100 <font class="comment">        A is a matrix of size n*p</font>
00101 <font class="comment">        we add x times the row j to the row i</font>
00102 <font class="comment">------------------------------------------------------------------------*/</font>
00103 
<a name="l00104"></a><a class="code" href="NormalForms_8c.html#a4">00104</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a4">ligne</a>(Value *a,<font class="keywordtype">int</font> i,<font class="keywordtype">int</font> j,Value x,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p)<font class="keyword"> </font>{   
00105  
00106   <font class="keywordtype">int</font> k;
00107   Value *c1,*c2;
00108   Value tmp;
00109 
00110   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
00111   c1=a+(i-1)*p;
00112   c2=a+(j-1)*p;
00113   
00114   <font class="keywordflow">for</font>(k=1;k&lt;=p;k++) {
00115 
00116     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(tmp,x,*c2);
00117     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(*c1,*c1,tmp);
00118     c1++;
00119     c2++;
00120   }
00121   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00122   <font class="keywordflow">return</font>;
00123 } <font class="comment">/* ligne */</font>
00124 
00125 <font class="comment">/*------------------------------------------------------------------------</font>
00126 <font class="comment">        A est une matrice de taille n*p</font>
00127 <font class="comment">        on ajoute a la colonne i, x fois la colonne j</font>
00128 <font class="comment">        A is a matrix of size n*p</font>
00129 <font class="comment">        we add x times the column j to the column i</font>
00130 <font class="comment"></font>
00131 <font class="comment">------------------------------------------------------------------------*/</font>
00132 
<a name="l00133"></a><a class="code" href="NormalForms_8c.html#a5">00133</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a5">colonne</a>(Value *a,<font class="keywordtype">int</font> i,<font class="keywordtype">int</font> j,Value x,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p)<font class="keyword"> </font>{ 
00134   
00135   <font class="keywordtype">int</font> k;
00136   Value *c1,*c2;
00137   Value tmp;
00138 
00139   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
00140   c1=a+(i-1);
00141   c2=a+(j-1);
00142   
00143   <font class="keywordflow">for</font>(k=1;k&lt;=<a class="code" href="polyparam_8c.html#a2">n</a>;k++) {
00144     <a class="code" href="arithmetique_8h.html#a47">value_multiply</a>(tmp,x,*c2);
00145     <a class="code" href="arithmetique_8h.html#a43">value_addto</a>(*c1,*c1,tmp);
00146     c1=c1+p;
00147     c2=c2+p;
00148   }
00149   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00150   <font class="keywordflow">return</font>;
00151 } <font class="comment">/* colonne */</font>
00152         
00153 <font class="comment">/*----------------------------------------------------------------------</font>
00154 <font class="comment">        trouve le numero de colonne du plus petit element non nul de </font>
00155 <font class="comment">        la ligne q, d'indice superieur a q, de la matrice A,  mais</font>
00156 <font class="comment">        renvoie zero si tous les elements sont nuls sauf le qieme.</font>
00157 <font class="comment"></font>
00158 <font class="comment">        find the column number (greater than q) of the smallest non</font>
00159 <font class="comment">        null element of row q . it returns </font>
00160 <font class="comment">        0 if all the last elements of row q are null except the qth</font>
00161 <font class="comment"></font>
00162 <font class="comment">----------------------------------------------------------------------*/</font>
00163 
<a name="l00164"></a><a class="code" href="NormalForms_8c.html#a6">00164</a> <font class="keyword">static</font> <font class="keywordtype">int</font> <a class="code" href="NormalForms_8c.html#a6">petit_l</a>(Value *a,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p,<font class="keywordtype">int</font> q)<font class="keyword"> </font>{
00165   
00166   <font class="keywordtype">int</font> numero=0, k, tousnuls;
00167   Value minus, comp;
00168   Value *c;
00169 
00170   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(minus); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(comp);
00171   c=a+(q-1)*p+(p-1);
00172   tousnuls=1;
00173   <font class="keywordflow">for</font>(k=p;k&gt;q;k--) {
00174     <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(comp,*c);
00175     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(comp))<font class="keyword"> </font>{        
00176       <font class="keywordflow">if</font> (tousnuls==1) {        
00177         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(minus,comp);
00178         numero=k;
00179         tousnuls=0;
00180       }
00181       <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a25">value_ge</a>(minus,comp))<font class="keyword"> </font>{
00182         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(minus,comp);
00183         numero=k;
00184       }
00185     }
00186     c--;
00187   }  
00188   <font class="keywordflow">if</font> (tousnuls==1) {
00189     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(minus); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(comp);
00190     <font class="keywordflow">return</font>(0);
00191   }  
00192   <font class="keywordflow">else</font>  {
00193     <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(comp,*c);
00194     <font class="keywordflow">if</font> ((<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(comp))&amp;&amp;(<a class="code" href="arithmetique_8h.html#a25">value_ge</a>(minus,comp))) {
00195       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(minus); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(comp);
00196       <font class="keywordflow">return</font>(q);
00197     }  
00198     <font class="keywordflow">else</font> {
00199       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(minus); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(comp);
00200       <font class="keywordflow">return</font>(numero);
00201     }  
00202   }
00203 } <font class="comment">/* petit_l */</font> 
00204         
00205 <font class="comment">/*----------------------------------------------------------------------</font>
00206 <font class="comment">        trouve le numero de ligne du plus petit element non nul de </font>
00207 <font class="comment">        la colonne q, d'indice superieur a q, de la matrice A,  mais</font>
00208 <font class="comment">        renvoie zero si tous les elements sont nuls sauf le qieme.</font>
00209 <font class="comment"></font>
00210 <font class="comment">        find the row number (greater than q) of the smallest non</font>
00211 <font class="comment">        null element of column q . it returns </font>
00212 <font class="comment">        0 if all the last elements of column q are null except the qth</font>
00213 <font class="comment"></font>
00214 <font class="comment">----------------------------------------------------------------------*/</font>
00215 
<a name="l00216"></a><a class="code" href="NormalForms_8c.html#a7">00216</a> <font class="keyword">static</font> <font class="keywordtype">int</font> <a class="code" href="NormalForms_8c.html#a7">petit_c</a>(Value *a,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p,<font class="keywordtype">int</font> q)<font class="keyword"> </font>{
00217   
00218   <font class="keywordtype">int</font> numero=0, k, tousnuls;  
00219   Value minus, comp;
00220   Value *c;
00221   
00222   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(minus); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(comp);
00223   c = a+q-1+p*(<a class="code" href="polyparam_8c.html#a2">n</a>-1);
00224   tousnuls=1;
00225   <font class="keywordflow">for</font>(k=<a class="code" href="polyparam_8c.html#a2">n</a>;k&gt;q;k--) {
00226     <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(comp,*c);
00227     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(comp))<font class="keyword"> </font>{        
00228       <font class="keywordflow">if</font> (tousnuls==1) {        
00229         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(minus,comp);
00230         numero=k;
00231         tousnuls=0;
00232       }
00233       <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a25">value_ge</a>(minus,comp))<font class="keyword"> </font>{
00234         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(minus,comp);
00235         numero=k;
00236       }
00237     }
00238     c=c-p;
00239   }
00240   
00241   <font class="keywordflow">if</font> (tousnuls==1) {
00242     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(minus); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(comp);
00243     <font class="keywordflow">return</font>(0);
00244   }  
00245   <font class="keywordflow">else</font> {
00246     <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(comp,*c);
00247     <font class="keywordflow">if</font> ((<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(comp)) &amp;&amp; (<a class="code" href="arithmetique_8h.html#a25">value_ge</a>(minus,comp))) {
00248       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(minus); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(comp);
00249       <font class="keywordflow">return</font>(q);
00250     }  
00251     <font class="keywordflow">else</font> {
00252       <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(minus); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(comp);
00253       <font class="keywordflow">return</font>(numero);
00254     }  
00255   }
00256 } <font class="comment">/* petit_c */</font>
00257         
00258 <font class="comment">/*-----------------------------------------------------------------------</font>
00259 <font class="comment">        A est initialisee a une matrice "identite" de taille n*p</font>
00260 <font class="comment">        A is initialized to an "identity" matrix of size n*p</font>
00261 <font class="comment">-----------------------------------------------------------------------*/</font>
00262 
<a name="l00263"></a><a class="code" href="NormalForms_8c.html#a8">00263</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a8">identite</a>(Value *a,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p)<font class="keyword"> </font>{
00264   
00265   <font class="keywordtype">int</font> i,j;
00266   Value *b;
00267   
00268   b = a;
00269   <font class="keywordflow">for</font>(i=1;i&lt;=<a class="code" href="polyparam_8c.html#a2">n</a>;i++) {
00270     <font class="keywordflow">for</font>(j=1;j&lt;=p;j++) {
00271       <font class="keywordflow">if</font> (i==j) 
00272         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(*b,1);
00273       <font class="keywordflow">else</font> 
00274         <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(*b,0);
00275       b++;
00276     }
00277   }
00278   <font class="keywordflow">return</font>;
00279 } <font class="comment">/* identite */</font>
00280 
00281 <font class="comment">/*-----------------------------------------------------------------------</font>
00282 <font class="comment">  transpose la sous-matrice de A dont les indices sont</font>
00283 <font class="comment">  superieurs ou egaux a q</font>
00284 <font class="comment">  transposition of the sub-matrix of A composed of the elements </font>
00285 <font class="comment">  whose indices are greater or equal to q</font>
00286 <font class="comment">-----------------------------------------------------------------------*/</font>
00287 
<a name="l00288"></a><a class="code" href="NormalForms_8c.html#a9">00288</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a9">transpose</a>(Value *a,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> q)<font class="keyword"> </font>{
00289   
00290   <font class="keywordtype">int</font> i;
00291   Value val;
00292   Value *b,*c;
00293 
00294   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(val);
00295   <font class="keywordflow">if</font> (q&lt;<a class="code" href="polyparam_8c.html#a2">n</a>) {
00296     b=a+(q-1)+(q-1)*<a class="code" href="polyparam_8c.html#a2">n</a>;
00297     c=b;
00298     <font class="keywordflow">for</font>(i=q+1;i&lt;=<a class="code" href="polyparam_8c.html#a2">n</a>;i++) {       
00299       b++;
00300       c=c+<a class="code" href="polyparam_8c.html#a2">n</a>;
00301       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(val,*b);
00302       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*b,*c);
00303       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(*c,val);
00304     }
00305     <a class="code" href="NormalForms_8c.html#a9">transpose</a>(a,<a class="code" href="polyparam_8c.html#a2">n</a>,q+1);
00306   }
00307   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(val);
00308   <font class="keywordflow">return</font>;
00309 } <font class="comment">/* transpose */</font>
00310 
00311 <font class="comment">/*----------------------------------------------------------------------</font>
00312 <font class="comment">        trouve le numero de colonne du premier element non divisible </font>
00313 <font class="comment">        par val dans la sous-matrice d'indices &gt; q mais renvoie 0 sinon</font>
00314 <font class="comment">        </font>
00315 <font class="comment">        find the column number of the first non-divisible by val element</font>
00316 <font class="comment">        in the sub-matrix of a composed of the elements of indices &gt;q.</font>
00317 <font class="comment">        Return 0 is there is no such element</font>
00318 <font class="comment">----------------------------------------------------------------------*/</font>
00319 
<a name="l00320"></a><a class="code" href="NormalForms_8c.html#a10">00320</a> <font class="keyword">static</font> <font class="keywordtype">int</font> <a class="code" href="NormalForms_8c.html#a10">encore</a>(Value *a,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p,<font class="keywordtype">int</font> q,Value val)<font class="keyword"> </font>{
00321   
00322   <font class="keywordtype">int</font> k,l;
00323   Value comp, tmp;
00324   Value *c;
00325 
00326   <font class="keywordflow">if</font> ((q&gt;=<a class="code" href="polyparam_8c.html#a2">n</a>)||(q&gt;=p)) <font class="keywordflow">return</font>(0);
00327   
00328   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(comp); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp); 
00329   c=a+q*p+q;
00330   k=q+1;
00331   l=q+1;
00332   <font class="keywordflow">while</font> (k&lt;=<a class="code" href="polyparam_8c.html#a2">n</a>) {
00333     <a class="code" href="arithmetique_8h.html#a55">value_absolute</a>(comp,*c);
00334     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a67">value_zero_p</a>(val))<font class="keyword"> </font>{
00335       <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(comp))<font class="keyword"> </font>{ 
00336         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(comp);
00337         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00338         <font class="keywordflow">return</font>(l);
00339       } 
00340     }
00341     <font class="keywordflow">else</font> {
00342       <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(tmp,comp,val);
00343       <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(tmp))<font class="keyword"> </font>{
00344         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(comp);
00345         <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00346         <font class="keywordflow">return</font>(l);
00347       }
00348     }  
00349     <font class="keywordflow">if</font> (l==p) {
00350       k=k+1;
00351       l=q+1;
00352       c=c+q+1;
00353     }
00354     <font class="keywordflow">else</font> {
00355       l++;
00356       c++;
00357     }
00358   }
00359   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(comp);
00360   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00361   <font class="keywordflow">return</font>(0);
00362 } <font class="comment">/* encore */</font>
00363 
00364 <font class="comment">/*----------------------------------------------------------------------</font>
00365 <font class="comment">        transforme la matrice A (de taille n*p), a partir de la position </font>
00366 <font class="comment">        q*q en sa forme de smith, les matrices b et c subissant les memes </font>
00367 <font class="comment">        transformations respectivement sur les lignes et colonnes</font>
00368 <font class="comment"></font>
00369 <font class="comment">        transform the matrix A (size n*p), from position (q,q) into </font>
00370 <font class="comment">        its smith normal form. the same transformations are applied to </font>
00371 <font class="comment">        matrices b and c, respectively on rows and on columns</font>
00372 <font class="comment">----------------------------------------------------------------------*/</font>
00373 
<a name="l00374"></a><a class="code" href="NormalForms_8c.html#a11">00374</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a11">smith</a>(Value *a,Value *b,Value *c,Value *b_inverse,Value *c_inverse,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p,<font class="keywordtype">int</font> q)<font class="keyword"> </font>{
00375   
00376   <font class="keywordtype">int</font> i,k,fini;
00377   Value x, pivot, tmp, x_inv;
00378   Value *f;
00379   
00380   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(pivot); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp); 
00381   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(x); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(x_inv);
00382   
00383   <font class="keywordflow">if</font> ((q&lt;=<a class="code" href="polyparam_8c.html#a2">n</a>)&amp;&amp;(q&lt;=p)) {
00384     fini = 1;
00385     
00386     <font class="keywordflow">while</font> (fini!=0) {
00387       i=<a class="code" href="NormalForms_8c.html#a7">petit_c</a>(a,<a class="code" href="polyparam_8c.html#a2">n</a>,p,q);
00388       <font class="keywordflow">while</font> (i!=0) {
00389         <font class="keywordflow">if</font> (i!=q) {
00390           <a class="code" href="NormalForms_8c.html#a2">echange_l</a>(a,i,q,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00391           <a class="code" href="NormalForms_8c.html#a2">echange_l</a>(b,i,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00392           <a class="code" href="NormalForms_8c.html#a3">echange_c</a>(b_inverse,i,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00393         }       
00394         f=a+(q-1)+(q-1)*p;
00395         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(pivot,*f);
00396         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(pivot))<font class="keyword"> </font>{
00397           <a class="code" href="NormalForms_8c.html#a0">moins_l</a>(a,q,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00398           <a class="code" href="NormalForms_8c.html#a0">moins_l</a>(b,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00399           <a class="code" href="NormalForms_8c.html#a1">moins_c</a>(b_inverse,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00400           <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(pivot,pivot);
00401         }       
00402         <font class="keywordflow">for</font>(k=q+1;k&lt;=<a class="code" href="polyparam_8c.html#a2">n</a>;k++) {   
00403           f=f+p;
00404           <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(*f))<font class="keyword"> </font>{
00405             <a class="code" href="arithmetique_8h.html#a51">value_division</a>(x,*f,pivot);
00406             <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(tmp,*f,pivot);
00407             <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(tmp)) 
00408               <a class="code" href="arithmetique_8h.html#a50">value_decrement</a>(x,x);
00409             <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(x_inv,x);
00410             <a class="code" href="NormalForms_8c.html#a4">ligne</a>(a,k,q,x_inv,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00411             <a class="code" href="NormalForms_8c.html#a4">ligne</a>(b,k,q,x_inv,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00412             <a class="code" href="NormalForms_8c.html#a5">colonne</a>(b_inverse,q,k,x,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);       
00413           }             
00414         }       
00415         i=<a class="code" href="NormalForms_8c.html#a7">petit_c</a>(a,<a class="code" href="polyparam_8c.html#a2">n</a>,p,q);
00416       }       
00417       fini=0;
00418       i=<a class="code" href="NormalForms_8c.html#a6">petit_l</a>(a,<a class="code" href="polyparam_8c.html#a2">n</a>,p,q);
00419       <font class="keywordflow">while</font> (i!=0) {
00420         <font class="keywordflow">if</font> (i!=q) {
00421           <a class="code" href="NormalForms_8c.html#a3">echange_c</a>(a,i,q,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00422           <a class="code" href="NormalForms_8c.html#a3">echange_c</a>(c,i,q,p,p);
00423           <a class="code" href="NormalForms_8c.html#a2">echange_l</a>(c_inverse,i,q,p,p);
00424           fini=1;
00425         }       
00426         f=a+(q-1)+(q-1)*p;
00427         <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(pivot,*f);
00428         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(pivot))<font class="keyword"> </font>{
00429           <a class="code" href="NormalForms_8c.html#a1">moins_c</a>(a,q,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00430           <a class="code" href="NormalForms_8c.html#a1">moins_c</a>(c,q,p,p);
00431           <a class="code" href="NormalForms_8c.html#a0">moins_l</a>(c_inverse,q,p,p);
00432           <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(pivot,pivot);
00433         }       
00434         <font class="keywordflow">for</font>(k=q+1;k&lt;=p;k++) {   
00435           f++;
00436           <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(*f))<font class="keyword"> </font>{
00437             <a class="code" href="arithmetique_8h.html#a51">value_division</a>(x,*f,pivot);
00438             <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(tmp,*f,pivot);
00439             <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(tmp)) 
00440               <a class="code" href="arithmetique_8h.html#a50">value_decrement</a>(x,x);
00441             <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(x_inv,x);
00442             <a class="code" href="NormalForms_8c.html#a5">colonne</a>(a,k,q,x_inv,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00443             <a class="code" href="NormalForms_8c.html#a5">colonne</a>(c,k,q,x_inv,p,p);   
00444             <a class="code" href="NormalForms_8c.html#a4">ligne</a>(c_inverse,q,k,x,p,p);
00445           }             
00446         }       
00447         i=<a class="code" href="NormalForms_8c.html#a6">petit_l</a>(a,<a class="code" href="polyparam_8c.html#a2">n</a>,p,q);
00448       } 
00449     }
00450     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(pivot,*(a+(q-1)+(q-1)*p));
00451     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(pivot))<font class="keyword"> </font>{
00452       <a class="code" href="NormalForms_8c.html#a0">moins_l</a>(a,q,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00453       <a class="code" href="NormalForms_8c.html#a0">moins_l</a>(b,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00454       <a class="code" href="NormalForms_8c.html#a1">moins_c</a>(b_inverse,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00455       <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(pivot,pivot);
00456     }
00457     
00458     i=<a class="code" href="NormalForms_8c.html#a10">encore</a>(a,<a class="code" href="polyparam_8c.html#a2">n</a>,p,q,pivot);
00459     <font class="keywordflow">if</font> (i!=0) {
00460       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(x,1);
00461       <a class="code" href="arithmetique_8h.html#a12">value_set_si</a>(x_inv,-1);
00462       <a class="code" href="NormalForms_8c.html#a5">colonne</a>(a,q,i,x,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00463       <a class="code" href="NormalForms_8c.html#a5">colonne</a>(c,q,i,x,p,p);
00464       <a class="code" href="NormalForms_8c.html#a4">ligne</a>(c_inverse,i,q,x_inv,p,p);
00465       <a class="code" href="NormalForms_8c.html#a11">smith</a>(a,b,c,b_inverse,c_inverse,<a class="code" href="polyparam_8c.html#a2">n</a>,p,q);
00466     }   
00467     <font class="keywordflow">else</font> <a class="code" href="NormalForms_8c.html#a11">smith</a>(a,b,c,b_inverse,c_inverse,<a class="code" href="polyparam_8c.html#a2">n</a>,p,q+1);
00468   }
00469   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(pivot); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00470   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(x); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(x_inv);
00471   
00472   <font class="keywordflow">return</font>;
00473 } <font class="comment">/* smith */</font> 
00474 
00475 <font class="comment">/*----------------------------------------------------------------------</font>
00476 <font class="comment">        decompose la matrice A en le produit d'une matrice B</font>
00477 <font class="comment">        unimodulaire et d'une matrice triangulaire superieure</font>
00478 <font class="comment">        D est l'inverse de B</font>
00479 <font class="comment">        Decompose the matrix A in the product of a matrix B unimodular</font>
00480 <font class="comment">        and a matrix upper triangular, D is the inverse of B</font>
00481 <font class="comment">----------------------------------------------------------------------*/</font>
00482 
<a name="l00483"></a><a class="code" href="NormalForms_8c.html#a12">00483</a> <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a12">hermite</a>(Value *a,Value *b,Value *d,<font class="keywordtype">int</font> <a class="code" href="polyparam_8c.html#a2">n</a>,<font class="keywordtype">int</font> p,<font class="keywordtype">int</font> q)<font class="keyword"> </font>{
00484   
00485   <font class="keywordtype">int</font> i,k;
00486   Value x, pivot, x_inv, tmp;
00487   Value *c1;
00488 
00489   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(pivot);  <a class="code" href="arithmetique_8h.html#a10">value_init</a>(tmp);
00490   <a class="code" href="arithmetique_8h.html#a10">value_init</a>(x); <a class="code" href="arithmetique_8h.html#a10">value_init</a>(x_inv);
00491 
00492   <font class="keywordflow">if</font> ((q&lt;=p)&amp;&amp;(q&lt;=<a class="code" href="polyparam_8c.html#a2">n</a>)) {
00493     i=<a class="code" href="NormalForms_8c.html#a7">petit_c</a>(a,<a class="code" href="polyparam_8c.html#a2">n</a>,p,q);    
00494     <font class="keywordflow">while</font> (i!=0) {
00495       <font class="keywordflow">if</font> (i!=q) {
00496         <a class="code" href="NormalForms_8c.html#a2">echange_l</a>(a,i,q,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00497         <a class="code" href="NormalForms_8c.html#a3">echange_c</a>(b,i,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00498         <a class="code" href="NormalForms_8c.html#a2">echange_l</a>(d,i,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00499       }
00500       
00501       c1=a+(q-1)+(q-1)*p;
00502       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(pivot,*c1);
00503       <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(pivot))<font class="keyword"> </font>{
00504         <a class="code" href="NormalForms_8c.html#a0">moins_l</a>(a,q,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00505         <a class="code" href="NormalForms_8c.html#a0">moins_l</a>(d,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00506         <a class="code" href="NormalForms_8c.html#a1">moins_c</a>(b,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00507         <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(pivot,pivot);
00508       }      
00509       <font class="keywordflow">for</font>(k=q+1;k&lt;=<a class="code" href="polyparam_8c.html#a2">n</a>;k++) {     
00510         c1=c1+p;
00511         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(*c1))<font class="keyword"> </font>{
00512           <a class="code" href="arithmetique_8h.html#a51">value_division</a>(x,*c1,pivot);
00513           <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(tmp,*c1,pivot);
00514           <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(tmp)) 
00515             <a class="code" href="arithmetique_8h.html#a50">value_decrement</a>(x,x);
00516           <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(x_inv,x);
00517           <a class="code" href="NormalForms_8c.html#a4">ligne</a>(a,k,q,x_inv,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00518           <a class="code" href="NormalForms_8c.html#a5">colonne</a>(b,q,k,x,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>); 
00519           <a class="code" href="NormalForms_8c.html#a4">ligne</a>(d,k,q,x_inv,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00520         }               
00521       }      
00522       i=<a class="code" href="NormalForms_8c.html#a7">petit_c</a>(a,<a class="code" href="polyparam_8c.html#a2">n</a>,p,q);       
00523     }    
00524     c1=a+(q-1);
00525     <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(pivot,*(c1+(q-1)*p));
00526     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(pivot))<font class="keyword"> </font>{
00527       <a class="code" href="NormalForms_8c.html#a0">moins_l</a>(a,q,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00528       <a class="code" href="NormalForms_8c.html#a0">moins_l</a>(d,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00529       <a class="code" href="NormalForms_8c.html#a1">moins_c</a>(b,q,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00530       <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(pivot,pivot);
00531     }    
00532     <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(pivot))<font class="keyword"> </font>{
00533       <font class="keywordflow">for</font>(k=1;k&lt;q;k++) {
00534         <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a68">value_notzero_p</a>(*c1))<font class="keyword"> </font>{
00535           <a class="code" href="arithmetique_8h.html#a51">value_division</a>(x,*c1,pivot);
00536           <a class="code" href="arithmetique_8h.html#a52">value_modulus</a>(tmp,*c1,pivot);
00537           <font class="keywordflow">if</font> (<a class="code" href="arithmetique_8h.html#a64">value_neg_p</a>(tmp)) 
00538             <a class="code" href="arithmetique_8h.html#a50">value_decrement</a>(x,x);
00539           <a class="code" href="arithmetique_8h.html#a54">value_oppose</a>(x_inv,x);
00540           <a class="code" href="NormalForms_8c.html#a4">ligne</a>(a,k,q,x_inv,<a class="code" href="polyparam_8c.html#a2">n</a>,p);
00541           <a class="code" href="NormalForms_8c.html#a5">colonne</a>(b,q,k,x,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>); 
00542           <a class="code" href="NormalForms_8c.html#a4">ligne</a>(d,k,q,x_inv,<a class="code" href="polyparam_8c.html#a2">n</a>,<a class="code" href="polyparam_8c.html#a2">n</a>);
00543         }
00544         c1=c1+p;                
00545       }
00546     }    
00547     <a class="code" href="NormalForms_8c.html#a12">hermite</a>(a,b,d,<a class="code" href="polyparam_8c.html#a2">n</a>,p,q+1);
00548   }     
00549   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(pivot); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(tmp);
00550   <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(x); <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(x_inv);
00551   <font class="keywordflow">return</font>;
00552 } <font class="comment">/* hermite */</font>
00553         
00554 <font class="comment">/*----------------------------------------------------------------------</font>
00555 <font class="comment">  B est une g_base de dimension n dont les p premiers vecteurs</font>
00556 <font class="comment">  colonnes sont colineaires aux vecteurs colonnes de A</font>
00557 <font class="comment">  C est l'invers de B</font>
00558 <font class="comment">  </font>
00559 <font class="comment">  B is an integral (g_base ?) of dimension n whose p first columns</font>
00560 <font class="comment">  vectors are proportionnal to the column vectors of A. C is the</font>
00561 <font class="comment">  inverse of B.</font>
00562 <font class="comment">  ----------------------------------------------------------------------*/</font>
00563 <font class="comment"></font>
00564 <font class="comment">/** Convert PolmattoDarmat :</font>
00565 <font class="comment">***  This function converts the matrix of a Polylib to a int * as necessary</font>
00566 <font class="comment">***    for the functions in Darte's implementation.</font>
00567 <font class="comment">***</font>
00568 <font class="comment">***  Input  : A Polylib Matrix ( a pointer to it );</font>
00569 <font class="comment">***  Output : An int * with the matrix copied into it</font>
00570 <font class="comment">**/</font>
<a name="l00571"></a><a class="code" href="NormalForms_8c.html#a13">00571</a> <font class="keyword">static</font> Value *<a class="code" href="NormalForms_8c.html#a13">ConvertPolMattoDarMat</a>(Matrix *A )<font class="keyword"> </font>{
00572   
00573   <font class="keywordtype">int</font> i,j;
00574   Value *result;
00575   
00576   result = (Value *)malloc(<font class="keyword">sizeof</font>(Value) * A-&gt;NbRows * A-&gt;NbColumns);
00577   <font class="keywordflow">for</font>(i=0;i&lt;A-&gt;NbRows * A-&gt;NbColumns;i++)
00578     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(result[i]);
00579 
00580   <font class="keywordflow">for</font> (i = 0; i &lt; A-&gt;NbRows; i++)
00581     <font class="keywordflow">for</font> (j = 0 ;  j &lt; A-&gt;NbColumns; j++)
00582       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(result[i*A-&gt;NbColumns + j],A-&gt;p[i][j]);
00583   <font class="keywordflow">return</font> result;
00584 } <font class="comment">/* ConvertPolMattoDarMat */</font>
00585 <font class="comment"></font>
00586 <font class="comment">/** Convert DarmattoPolmat</font>
00587 <font class="comment">***   This function converts the matrix from Darte representation to a matrix</font>
00588 <font class="comment">***    in PolyLib.</font>
00589 <font class="comment">***</font>
00590 <font class="comment">***   Input  : The matrix (a pointer to it),  number of Rows, number of columns</font>
00591 <font class="comment">***   Output : The matrix of the PolyLib </font>
00592 <font class="comment">***</font>
00593 <font class="comment">**/</font>
00594 
<a name="l00595"></a><a class="code" href="NormalForms_8c.html#a14">00595</a> <font class="keyword">static</font> Matrix *<a class="code" href="NormalForms_8c.html#a14">ConvertDarMattoPolMat</a> (Value *A, <font class="keywordtype">int</font> NbRows, <font class="keywordtype">int</font> NbCols)<font class="keyword"> </font>{
00596   
00597   <font class="keywordtype">int</font> i,j;
00598   Matrix *result;
00599   
00600   result = <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(NbRows, NbCols);
00601   
00602   <font class="keywordflow">for</font> (i = 0; i &lt; NbRows; i ++)
00603     <font class="keywordflow">for</font> (j = 0; j &lt; NbCols; j ++)
00604       <a class="code" href="arithmetique_8h.html#a11">value_assign</a>(result-&gt;p[i][j],A[i*NbCols + j]);  
00605   <font class="keywordflow">return</font> result;
00606 } <font class="comment">/* ConvertDarMattoPolMat */</font>
00607 <font class="comment"></font>
00608 <font class="comment">/**</font>
00609 <font class="comment">*** Smith : This function takes a Matrix A of dim n * l as its input </font>
00610 <font class="comment">***         and returns the three matrices U, V and Product such that</font>
00611 <font class="comment">***         Product = U * A * V, where U is an unimodular matrix of dimension</font>
00612 <font class="comment">***         n * n and V is an unimodular matrix of dimension l * l.</font>
00613 <font class="comment">***         Product is a diagonal matrix of dimension n * l.</font>
00614 <font class="comment">***     </font>
00615 <font class="comment">***         We use Alan Darte's implementation of Smith for computing</font>
00616 <font class="comment">***         the Smith Normal Form </font>
00617 <font class="comment">**/</font>
00618  
<a name="l00619"></a><a class="code" href="NormalForms_8c.html#a15">00619</a> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a15">Smith</a> (Matrix *A, Matrix **U, Matrix **V, Matrix **Product)<font class="keyword"> </font>{
00620   
00621   <font class="keywordtype">int</font> i;
00622   Value *a, *u, *v, *u_inv, *v_inv;
00623   Matrix *temp;
00624   
00625   u = (Value *) malloc(<font class="keyword">sizeof</font>(Value) * (A-&gt;NbRows) * (A-&gt;NbRows));
00626   v = (Value *) malloc(<font class="keyword">sizeof</font>(Value) * A-&gt;NbColumns * A-&gt;NbColumns);  
00627   u_inv = (Value *) malloc(<font class="keyword">sizeof</font>(Value) * A-&gt;NbRows * A-&gt;NbRows);
00628   v_inv = (Value *) malloc(<font class="keyword">sizeof</font>(Value) * A-&gt;NbColumns * A-&gt;NbColumns);
00629 
00630   <font class="keywordflow">for</font> (i=0;i &lt; (A-&gt;NbRows * A-&gt;NbRows);i++)
00631     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(u[i]);
00632   <font class="keywordflow">for</font> (i=0;i &lt; (A-&gt;NbColumns * A-&gt;NbColumns);i++)
00633     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(v[i]);
00634   <font class="keywordflow">for</font> (i=0;i &lt; (A-&gt;NbRows * A-&gt;NbRows);i++)
00635     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(u_inv[i]);
00636   <font class="keywordflow">for</font> (i=0;i &lt; (A-&gt;NbColumns * A-&gt;NbColumns);i++)
00637     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(v_inv[i]);
00638   
00639   <a class="code" href="NormalForms_8c.html#a8">identite</a>(u,A-&gt;NbRows,A-&gt;NbRows);
00640   <a class="code" href="NormalForms_8c.html#a8">identite</a>(u_inv,A-&gt;NbRows,A-&gt;NbRows);
00641   <a class="code" href="NormalForms_8c.html#a8">identite</a>(v, A-&gt;NbColumns,A-&gt;NbColumns);
00642   <a class="code" href="NormalForms_8c.html#a8">identite</a>(v_inv,A-&gt;NbColumns,A-&gt;NbColumns);
00643   
00644   a = <a class="code" href="NormalForms_8c.html#a13">ConvertPolMattoDarMat</a>(A);  
00645   <a class="code" href="NormalForms_8c.html#a11">smith</a>(a,u,v,u_inv,v_inv,A-&gt;NbRows,A-&gt;NbColumns,1);  
00646   *Product = <a class="code" href="NormalForms_8c.html#a14">ConvertDarMattoPolMat</a>(a,A-&gt;NbRows,A-&gt;NbColumns);
00647   temp = <a class="code" href="NormalForms_8c.html#a14">ConvertDarMattoPolMat</a>(u,A-&gt;NbRows, A-&gt;NbRows);
00648   *U= <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(temp-&gt;NbRows, temp-&gt;NbColumns);
00649   <a class="code" href="matrix_8c.html#a13">Matrix_Inverse</a>(temp, *U);
00650   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(temp);
00651   
00652   temp = <a class="code" href="NormalForms_8c.html#a14">ConvertDarMattoPolMat</a>(v,A-&gt;NbColumns, A-&gt;NbColumns);
00653   *V= <a class="code" href="matrix_8c.html#a0">Matrix_Alloc</a>(temp-&gt;NbRows, temp-&gt;NbColumns);
00654   <a class="code" href="matrix_8c.html#a13">Matrix_Inverse</a>(temp, *V);
00655   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(temp);
00656 
00657   <font class="keywordflow">for</font> (i=0;i &lt; (A-&gt;NbRows * A-&gt;NbRows);i++)
00658     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(u[i]);
00659   <font class="keywordflow">for</font> (i=0;i &lt; (A-&gt;NbColumns * A-&gt;NbColumns);i++)
00660     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(v[i]);
00661   <font class="keywordflow">for</font> (i=0;i &lt; (A-&gt;NbRows * A-&gt;NbRows);i++)
00662     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(u_inv[i]);
00663   <font class="keywordflow">for</font> (i=0;i &lt; (A-&gt;NbColumns * A-&gt;NbColumns);i++)
00664     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(v_inv[i]);    
00665   free (a);
00666   free (u); free (v);
00667   free (u_inv); free (v_inv);  
00668   <font class="keywordflow">return</font>;
00669 } <font class="comment">/* Smith */</font>
00670 <font class="comment"></font>
00671 <font class="comment">/** Hermite :</font>
00672 <font class="comment">***   This function takes a Matrix as its input and finds its HNF </font>
00673 <font class="comment">***    ( Left form )</font>
00674 <font class="comment">***</font>
00675 <font class="comment">***   Input  : A Matrix A (The Matrix A is not necessarily a Polylib matrix.</font>
00676 <font class="comment">***             It is just a matrix as far as Hermite is concerned. It</font>
00677 <font class="comment">***             does not even check if the matrix is a Polylib matrix or not) </font>
00678 <font class="comment">***   Output : The Hnf matrix H and the Unimodular matrix U such that</font>
00679 <font class="comment">***               A = H * U.</font>
00680 <font class="comment">***</font>
00681 <font class="comment">***   We use Alan Darte's implementation of Hermite to compute the HNF.</font>
00682 <font class="comment">***   Alan Darte's implementation computes the Upper Triangular HNF.</font>
00683 <font class="comment">***   So We work on the fact that if A = H * U then </font>
00684 <font class="comment">***       A (transpose) = U(transpose) * H (transpose)</font>
00685 <font class="comment">***       There are a set of interface functions written in Interface.c</font>
00686 <font class="comment">***        which convert a matrix from Polylib representationt to that of</font>
00687 <font class="comment">***        Alan Darte's and vice versa.</font>
00688 <font class="comment">***     </font>
00689 <font class="comment">***   This Function Does the Following</font>
00690 <font class="comment">***    Step 1 : Given the matrix A it finds its Transpose.</font>
00691 <font class="comment">***    Step 2 : Finds the HNF (Right Form) using Alan Darte's Algorithm.</font>
00692 <font class="comment">***    Step 3 : The H1 and U1 obtained in Step2 are both Transposed to get</font>
00693 <font class="comment">***              the actual H and U such that A = HU.</font>
00694 <font class="comment">**/</font>
<a name="l00695"></a><a class="code" href="NormalForms_8c.html#a16">00695</a> <font class="keywordtype">void</font> <a class="code" href="NormalForms_8c.html#a16">Hermite</a> (Matrix *A, Matrix **H, Matrix **U)<font class="keyword"> </font>{
00696   
00697   <font class="keywordtype">int</font> i;
00698   Matrix *<a class="code" href="NormalForms_8c.html#a9">transpose</a>, *tempH, *tempU ;
00699   Value *darte_matA, *darte_identite, *darte_id_inv;
00700   
00701   <a class="code" href="NormalForms_8c.html#a9">transpose</a> = <a class="code" href="Matop_8c.html#a4">Transpose</a>(A);
00702   darte_matA = <a class="code" href="NormalForms_8c.html#a13">ConvertPolMattoDarMat</a>(<a class="code" href="NormalForms_8c.html#a9">transpose</a>);
00703   
00704   darte_identite = (Value *)malloc(<font class="keyword">sizeof</font>(Value) * A-&gt;NbColumns* A-&gt;NbColumns);
00705   darte_id_inv = (Value *) malloc(<font class="keyword">sizeof</font>(Value) * A-&gt;NbColumns*A-&gt;NbColumns);
00706   <font class="keywordflow">for</font> (i=0; i&lt; A-&gt;NbColumns * A-&gt;NbColumns; i++)
00707     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(darte_identite[i]);
00708   <font class="keywordflow">for</font> (i=0; i&lt; A-&gt;NbColumns * A-&gt;NbColumns; i++)
00709     <a class="code" href="arithmetique_8h.html#a10">value_init</a>(darte_id_inv[i]);
00710   
00711   <a class="code" href="NormalForms_8c.html#a8">identite</a>(darte_identite, transpose-&gt;NbRows, transpose-&gt;NbRows);
00712   <a class="code" href="NormalForms_8c.html#a8">identite</a>(darte_id_inv, transpose-&gt;NbRows, transpose-&gt;NbRows);  
00713   <a class="code" href="NormalForms_8c.html#a12">hermite</a>(darte_matA, darte_identite, darte_id_inv,A-&gt;NbColumns,A-&gt;NbRows, 1); 
00714   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (<a class="code" href="NormalForms_8c.html#a9">transpose</a>);
00715   <a class="code" href="NormalForms_8c.html#a9">transpose</a> = <a class="code" href="NormalForms_8c.html#a14">ConvertDarMattoPolMat</a>(darte_matA, A-&gt;NbColumns, A-&gt;NbRows);
00716   tempU = <a class="code" href="NormalForms_8c.html#a14">ConvertDarMattoPolMat</a>(darte_identite, A-&gt;NbColumns, A-&gt;NbColumns);
00717   
00718   <font class="comment">/* Finding H Transpose */</font>
00719   tempH = <a class="code" href="Matop_8c.html#a4">Transpose</a>(<a class="code" href="NormalForms_8c.html#a9">transpose</a>);  
00720   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a>(<a class="code" href="NormalForms_8c.html#a9">transpose</a>);
00721   
00722   <font class="comment">/* Finding U Transpose */</font>
00723   <a class="code" href="NormalForms_8c.html#a9">transpose</a> = <a class="code" href="Matop_8c.html#a4">Transpose</a>(tempU);
00724   
00725   H[0] = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(tempH);
00726   U[0] = <a class="code" href="Matop_8c.html#a5">Matrix_Copy</a>(<a class="code" href="NormalForms_8c.html#a9">transpose</a>);
00727     
00728   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (tempH);
00729   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (<a class="code" href="NormalForms_8c.html#a9">transpose</a>);
00730   <a class="code" href="matrix_8c.html#a1">Matrix_Free</a> (tempU);
00731   
00732   <font class="keywordflow">for</font> (i=0; i&lt; A-&gt;NbColumns * A-&gt;NbColumns; i++)
00733     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(darte_identite[i]);
00734   <font class="keywordflow">for</font> (i=0; i&lt; A-&gt;NbColumns * A-&gt;NbColumns; i++)
00735     <a class="code" href="arithmetique_8h.html#a14">value_clear</a>(darte_id_inv[i]);
00736   free (darte_matA);
00737   free (darte_identite);
00738   free (darte_id_inv);
00739   <font class="keywordflow">return</font>;
00740 } <font class="comment">/* Hermite */</font>
00741 
00742 
</pre></div><hr><address><small>Generated on Fri Oct 4 16:14:26 2002 for Polylib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.11.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
